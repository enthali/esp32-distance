{"created": "2025-11-12T12:22:49.490844", "current_version": "", "project": "ESP32 Distance Sensor", "versions": {"": {"created": "2025-11-12T12:22:49.490829", "creator": {"program": "sphinx_needs", "version": "6.1.0"}, "needs": {"API_COMP_CERT_HANDLER": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Brief Description**\n\nCertificate management for ESP32 HTTPS server. Provides access to embedded SSL certificates generated during the build process, supporting long-term IoT deployments.\n\nKey features:\n\n* Embedded server and CA certificates\n* 25-year validity for IoT deployments\n* Build-time certificate generation\n\n**Architecture:**\n\n- Certificates generated at build time and embedded in firmware\n- Accessed via type-safe API for HTTPS server initialization", "created_at": "", "docname": "21_api/api_cert_handler", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "main/components/cert_handler/cert_handler.h", "id": "API_COMP_CERT_HANDLER", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_SYS_SEC_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Certificate Handler API", "sections": ["Certificate Handler API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "Certificate Handler", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_CONFIG_MANAGER": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "JSON Schema-driven configuration manager that stores individual\nconfiguration values in NVS using keys defined by `config_schema.json`.\nThe component exposes type-safe getters/setters for string, int32,\nint16 and boolean values and provides bulk JSON import/export helpers\nused by the web UI.\n\nKey features:\n\n* JSON Schema as single source of truth (embedded at build time)\n* Direct key-based NVS storage for minimal RAM usage\n* Type-safe API for string, integer and boolean parameters\n* Bulk JSON read/write operations for UI integration\n\n**Architecture:**\n\nThin wrapper around ESP-IDF NVS with no runtime validation. Validation\nis expected to be performed by the browser UI using the embedded JSON\nschema. Factory defaults are generated at build-time and written by an\nauto-generated helper.", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "main/components/config_manager/config_manager.h", "id": "API_COMP_CONFIG_MANAGER", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_CFG_JSON_1", "REQ_CFG_JSON_4", "REQ_CFG_JSON_6", "REQ_CFG_JSON_7", "REQ_CFG_JSON_8", "REQ_CFG_JSON_9", "REQ_CFG_JSON_11", "REQ_CFG_JSON_12", "REQ_CFG_JSON_13"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Config Manager API", "sections": ["Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "Config Manager", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_DISPLAY_LOGIC": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Brief Description**\n\nBusiness logic component that converts distance measurements into LED strip visualizations. Provides clean separation between hardware abstraction (components) and application logic.\n\nKey features:\n\n* Distance Range Mapping: Configurable range mapped linearly to configured LED count\n* LED Spacing: Approximately (max_distance - min_distance) / led_count cm per LED\n* Visual Feedback: Normal range (green/blue), error indicators (red), sensor timeout/error patterns\n* Real-time safe, FreeRTOS task-based architecture\n* Integration with config_manager, distance_sensor, and led_controller components\n\n**Architecture:**\n\n- Priority 3 FreeRTOS task for LED visualization (between sensor priority 6 and test priority 2)\n- Blocking reads from distance sensor queue (waits for new measurements)\n- Update rate matches distance sensor measurement rate\n- Real-time safe with proper task priorities\n- Input: distance_sensor_get_latest() API (blocking)\n- Output: led_controller APIs (led_set_pixel, led_clear_all, led_show)\n- Error handling: Visual indicators for all sensor error states", "created_at": "", "docname": "21_api/api_display_logic", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "main/components/display_logic/display_logic.h", "id": "API_COMP_DISPLAY_LOGIC", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_DSP_1", "REQ_DSP_2", "REQ_DSP_3", "REQ_DSP_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Display Logic API", "sections": ["Display Logic API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "Display Logic", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_DISTANCE_SENSOR": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Brief Description**\n\nHC-SR04 ultrasonic distance sensor driver with dual-queue, interrupt-driven architecture for real-time, race-condition-safe measurement processing. Provides blocking and non-blocking APIs, queue overflow statistics, and health monitoring.\n\nKey features:\n\n* Dual-queue architecture: ISR \u2192 Task (raw), Task \u2192 API (processed)\n* Real-time, race-condition-safe, no floating-point in ISR\n* Temperature compensation, range validation, EMA filtering\n* Blocking and non-blocking measurement APIs\n* Queue overflow statistics and health monitoring\n\n**Architecture:**\n\n- ISR captures timestamps only, sends to raw queue (IRAM_ATTR, real-time safe)\n- Sensor task processes measurements, applies filtering, sends to processed queue\n- API blocks until new data is available, no shared variables\n- Queue overflow handling and statistics\n- Health monitoring for diagnostics", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "main/components/distance_sensor/distance_sensor.h", "id": "API_COMP_DISTANCE_SENSOR", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_SNS_1", "REQ_SNS_2", "REQ_SNS_3", "REQ_SNS_4", "REQ_SNS_5", "REQ_SNS_6", "REQ_SNS_7", "REQ_SNS_8", "REQ_SNS_9", "REQ_SNS_10"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Distance Sensor API", "sections": ["Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "Distance Sensor", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_LED_CONTROLLER": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Brief Description**\n\nHardware abstraction layer for WS2812 addressable LED strips using ESP32 RMT peripheral. Provides low-level control with RAM buffer management for efficient updates, individual pixel control, and color utilities.\n\nKey features:\n\n* Individual pixel control (set/get/clear)\n* RAM buffer maintains current LED state\n* Manual update trigger for performance optimization\n* Configurable LED count and GPIO pin\n* Color utility functions\n\n**Architecture:**\n\n- RMT peripheral abstraction for WS2812 timing\n- RAM buffer for current LED state\n- Manual update (led_show) for performance\n- Configurable LED count and GPIO pin\n- Color utility functions for RGB and brightness", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "main/components/led_controller/led_controller.h", "id": "API_COMP_LED_CONTROLLER", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_LED_1", "REQ_LED_2", "REQ_LED_3", "REQ_LED_4", "REQ_LED_5", "REQ_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "LED Controller API", "sections": ["LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "LED Controller", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_NETIF_TUNNEL": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Brief Description**\n\nUART-based IP tunnel network interface for QEMU simulator. Provides a lwIP network interface that tunnels IP packets over UART1, enabling full TCP/IP stack functionality in QEMU without network device emulation.\n\nKey features:\n\n* QEMU UART network bridge for ESP32 emulation\n* lwIP network interface over UART1\n* Simple length-prefixed framing protocol\n* Conditional compilation for QEMU only\n\n**Architecture:**\n\n- ESP32 (QEMU): lwIP stack -> netif -> UART1 -> TCP socket\n- Host: TCP socket -> TUN device -> Linux network stack", "created_at": "", "docname": "21_api/api_netif_uart_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "main/components/netif_uart_tunnel/netif_uart_tunnel_sim.h", "id": "API_COMP_NETIF_TUNNEL", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_NETIF_TUNNEL_1", "REQ_NETIF_TUNNEL_2", "REQ_NETIF_TUNNEL_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Network Tunnel API", "sections": ["Network Tunnel API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "Network Tunnel", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_STARTUP_TESTS": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Brief Description**\n\nTest functions for running light effects on the LED strip, used for startup visual feedback and hardware validation.\n\nKey features:\n\n* Sequential running light effect for boot validation\n* Multiple cycles and rainbow effect for advanced testing\n* Synchronous, blocking execution (no separate task)\n* Uses led_controller API for all LED operations\n\n**Architecture:**\n\n- Called after LED controller initialization in main()\n- Effects run synchronously, blocking until complete\n- No separate task/thread required; runs in main context\n- All LED operations use led_controller API", "created_at": "", "docname": "21_api/api_startup_tests", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "main/components/startup_tests/led_running_test.h", "id": "API_COMP_STARTUP_TESTS", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_STARTUP_1", "REQ_STARTUP_2", "REQ_STARTUP_3", "REQ_LED_1", "REQ_LED_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Startup Tests API", "sections": ["Startup Tests API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "Startup Tests", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_WEB_SERVER": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "HTTP server for WiFi captive portal and configuration interface.\n\nKey features:\n\n* Multi-page responsive web interface with navbar navigation\n* Static file serving from embedded flash assets (HTML, CSS, JS)\n* WiFi configuration API endpoints (scan, connect, status, reset)\n* Integration with DNS server module for captive portal functionality\n* CORS-secured API endpoints with proper MIME type handling\n\n**Architecture:**\nImplements HTTP server and DNS server for captive portal (AP mode). Serves static web assets from flash. Provides REST API endpoints for configuration, WiFi setup, and LED state. Integrates with config_manager and wifi_manager. Designed for modular, component-based ESP-IDF architecture.", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "main/components/web_server/web_server.h", "id": "API_COMP_WEB_SERVER", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_SYS_WEB_1", "REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_3", "REQ_WEB_CONF_1", "REQ_WEB_SCHEMA_1", "REQ_WEB_4", "REQ_WEB_5", "REQ_WEB_LED_1", "REQ_SYS_NET_1", "REQ_SYS_CFG_1", "REQ_SYS_ARCH_1", "SPEC_WEB_SERVER", "SPEC_CONFIG_WEBPAGE"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Web Server API", "sections": ["Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "Web Server", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_COMP_WIFI_MGR": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Smart WiFi management with captive portal and credential persistence.\n\nKey features:\n\n* Intelligent WiFi connection logic (AP/STA fallback)\n* Captive portal for WiFi setup\n* Credential storage in NVS\n* Integration with web_server and config_manager\n\n**Architecture:**\nManages WiFi connection state machine (AP/STA/Disconnected). Provides captive portal for WiFi setup. Stores credentials in NVS and handles fallback logic. Integrates with web_server and config_manager. Designed for modular, component-based ESP-IDF architecture.", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "main/components/web_server/wifi_manager.h", "id": "API_COMP_WIFI_MGR", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 4, "links": ["REQ_SYS_NET_1", "REQ_SYS_WEB_1", "REQ_WEB_3", "REQ_WEB_5", "REQ_SYS_CFG_1", "REQ_SYS_ARCH_1", "SPEC_WEB_SERVER"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "WiFi Manager API", "sections": ["WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "WiFi Manager", "type": "apicomponent", "type_name": "API Component", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CERT_HANDLER_GET_CA_CERT": {"acceptance_criteria": "", "api_signature": "esp_err_t cert_handler_get_ca_cert(const char** cert_data, size_t* cert_len)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CERT_HANDLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get embedded CA certificate data (PEM format) generated during build.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t cert_handler_get_ca_cert(const char** cert_data, size_t* cert_len);\n\n**Parameters:**\n\n* ``cert_data`` - Pointer to CA certificate data (null-terminated)\n* ``cert_len`` - Length of CA certificate data including null terminator\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - Parameters are NULL", "created_at": "", "docname": "21_api/api_cert_handler", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CERT_HANDLER_GET_CA_CERT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 114, "links": ["REQ_SYS_SEC_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "cert_data, cert_len", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error codes otherwise", "section_name": "Certificate Access Functions", "sections": ["Certificate Access Functions", "Certificate Handler API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "cert_handler_get_ca_cert", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CERT_HANDLER_GET_INFO": {"acceptance_criteria": "", "api_signature": "esp_err_t cert_handler_get_info(char* info_buffer, size_t buffer_size)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CERT_HANDLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get certificate information for logging. Provides certificate metadata for diagnostics. Does not expose sensitive private key information.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t cert_handler_get_info(char* info_buffer, size_t buffer_size);\n\n**Parameters:**\n\n* ``info_buffer`` - Buffer to store certificate information\n* ``buffer_size`` - Size of the information buffer\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_SIZE`` - Buffer too small", "created_at": "", "docname": "21_api/api_cert_handler", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CERT_HANDLER_GET_INFO", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 141, "links": ["REQ_SYS_SEC_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "info_buffer, buffer_size", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error codes otherwise", "section_name": "Certificate Access Functions", "sections": ["Certificate Access Functions", "Certificate Handler API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "cert_handler_get_info", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CERT_HANDLER_GET_SERVER_CERT": {"acceptance_criteria": "", "api_signature": "esp_err_t cert_handler_get_server_cert(const char** cert_data, size_t* cert_len)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CERT_HANDLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get embedded server certificate data (PEM format) generated during build.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t cert_handler_get_server_cert(const char** cert_data, size_t* cert_len);\n\n**Parameters:**\n\n* ``cert_data`` - Pointer to certificate data (null-terminated)\n* ``cert_len`` - Length of certificate data including null terminator\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - Parameters are NULL", "created_at": "", "docname": "21_api/api_cert_handler", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CERT_HANDLER_GET_SERVER_CERT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 60, "links": ["REQ_SYS_SEC_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "cert_data, cert_len", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error codes otherwise", "section_name": "Certificate Access Functions", "sections": ["Certificate Access Functions", "Certificate Handler API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "cert_handler_get_server_cert", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CERT_HANDLER_GET_SERVER_KEY": {"acceptance_criteria": "", "api_signature": "esp_err_t cert_handler_get_server_key(const char** key_data, size_t* key_len)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CERT_HANDLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get embedded server private key data (PEM format) generated during build.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t cert_handler_get_server_key(const char** key_data, size_t* key_len);\n\n**Parameters:**\n\n* ``key_data`` - Pointer to private key data (null-terminated)\n* ``key_len`` - Length of private key data including null terminator\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - Parameters are NULL", "created_at": "", "docname": "21_api/api_cert_handler", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CERT_HANDLER_GET_SERVER_KEY", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 87, "links": ["REQ_SYS_SEC_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "key_data, key_len", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error codes otherwise", "section_name": "Certificate Access Functions", "sections": ["Certificate Access Functions", "Certificate Handler API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "cert_handler_get_server_key", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CERT_HANDLER_INIT": {"acceptance_criteria": "", "api_signature": "esp_err_t cert_handler_init(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CERT_HANDLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Initialize certificate management. Verifies that all required certificates are available and properly embedded in the firmware. Should be called during system initialization before starting the HTTPS server.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t cert_handler_init(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - All certificates are available\n* ``ESP_ERR_NOT_FOUND`` - Any certificates are missing\n\n.. note::\n   Call before HTTPS server startup.", "created_at": "", "docname": "21_api/api_cert_handler", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CERT_HANDLER_INIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 28, "links": ["REQ_SYS_SEC_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK if all certificates are available, error codes otherwise", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Certificate Handler API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "cert_handler_init", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_COMMIT": {"acceptance_criteria": "", "api_signature": "esp_err_t config_commit(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Commit pending NVS writes to flash. Useful after multiple _no_commit\nupdates to batch flash writes.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_commit(void)\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_NVS_*`` - Commit failure\n\n.. note::\n   Use to reduce flash wear when performing multiple updates.", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_COMMIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 93, "links": [], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_commit", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_FACTORY_RESET": {"acceptance_criteria": "", "api_signature": "esp_err_t config_factory_reset(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Reset all configuration to factory defaults by erasing the NVS\nnamespace and writing generated defaults.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_factory_reset(void)\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_NVS_*`` - NVS operation failure\n\n.. note::\n   Uses auto-generated factory write helper (see config_write_factory_defaults()).", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_FACTORY_RESET", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 63, "links": ["REQ_CFG_JSON_9"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_factory_reset", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_GET_ALL_AS_JSON": {"acceptance_criteria": "", "api_signature": "esp_err_t config_get_all_as_json(char **config_json)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Build and return allocated JSON array string representing all\nconfiguration values. Caller must free the returned string.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_get_all_as_json(char **config_json)\n\n**Parameters:**\n\n* ``config_json`` - Output pointer to allocated JSON string (caller frees)\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_NO_MEM`` - Allocation failure\n* ``ESP_ERR_INVALID_ARG`` - ``config_json`` is NULL", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_GET_ALL_AS_JSON", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 505, "links": ["REQ_CFG_JSON_12"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Bulk JSON Configuration API", "sections": ["Bulk JSON Configuration API", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_get_all_as_json", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_GET_BOOL": {"acceptance_criteria": "", "api_signature": "esp_err_t config_get_bool(const char* key, bool* value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Read a boolean value (stored as uint8) from NVS.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_get_bool(const char* key, bool* value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - Pointer to store result\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` or ``value`` is NULL\n* ``ESP_ERR_NVS_NOT_FOUND`` - Key not found", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_GET_BOOL", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 390, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Boolean Parameter Access", "sections": ["Boolean Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_get_bool", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_GET_INT16": {"acceptance_criteria": "", "api_signature": "esp_err_t config_get_int16(const char* key, int16_t* value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Read a 16-bit signed integer from NVS.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_get_int16(const char* key, int16_t* value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - Pointer to store retrieved value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` or ``value`` is NULL\n* ``ESP_ERR_NVS_NOT_FOUND`` - Key not found", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_GET_INT16", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 303, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Integer Parameter Access", "sections": ["Integer Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_get_int16", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_GET_INT32": {"acceptance_criteria": "", "api_signature": "esp_err_t config_get_int32(const char* key, int32_t* value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Read a 32-bit signed integer from NVS.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_get_int32(const char* key, int32_t* value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - Pointer to store retrieved value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` or ``value`` is NULL\n* ``ESP_ERR_NVS_NOT_FOUND`` - Key not found", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_GET_INT32", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 247, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Integer Parameter Access", "sections": ["Integer Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_get_int32", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_GET_SCHEMA_JSON": {"acceptance_criteria": "", "api_signature": "esp_err_t config_get_schema_json(char **schema_json)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Return pointer to embedded JSON schema string. The returned pointer is\nowned by the binary and must not be freed by the caller.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_get_schema_json(char **schema_json)\n\n**Parameters:**\n\n* ``schema_json`` - Output pointer to embedded schema string\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_NOT_FOUND`` - Schema not embedded\n* ``ESP_ERR_INVALID_ARG`` - ``schema_json`` is NULL", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_GET_SCHEMA_JSON", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 477, "links": ["REQ_CFG_JSON_12"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Bulk JSON Configuration API", "sections": ["Bulk JSON Configuration API", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_get_schema_json", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_GET_STRING": {"acceptance_criteria": "", "api_signature": "esp_err_t config_get_string(const char* key, char* buffer, size_t buf_len)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Read a null-terminated string value from NVS into a provided buffer.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_get_string(const char* key, char* buffer, size_t buf_len)\n\n**Parameters:**\n\n* ``key`` - NVS key name (must match schema field key)\n* ``buffer`` - Destination buffer to receive string (including null)\n* ``buf_len`` - Size of ``buffer`` in bytes\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` or ``buffer`` is NULL\n* ``ESP_ERR_NVS_NOT_FOUND`` - Key not found in NVS\n* ``ESP_ERR_NVS_INVALID_LENGTH`` - Provided buffer too small\n\n.. note::\n   No runtime validation performed; the UI should enforce schema constraints.", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_GET_STRING", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 155, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "String Parameter Access", "sections": ["String Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_get_string", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_INIT": {"acceptance_criteria": "", "api_signature": "esp_err_t config_init(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Initialize configuration manager by opening the NVS namespace \"config\".\nIf the namespace is uninitialized, factory defaults are written.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_init(void)\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Initialization successful\n* ``ESP_ERR_NVS_*`` - NVS initialization or operation failure\n\n.. note::\n   Must be called once during system startup. Implements REQ_CFG_JSON_12.", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_INIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 33, "links": ["REQ_CFG_JSON_12"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_init", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_ALL_FROM_JSON": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_all_from_json(const char *config_json)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Parse structured JSON array and update configuration atomically. Uses\n_no_commit setters internally and performs a single commit. Unknown keys\nare ignored.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_all_from_json(const char *config_json)\n\n**Parameters:**\n\n* ``config_json`` - JSON array string with key-type-value objects\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - Validation failure or malformed JSON\n* ``ESP_ERR_NO_MEM`` - Memory allocation failure\n* ``ESP_ERR_NVS_*`` - NVS operation failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_ALL_FROM_JSON", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 533, "links": ["REQ_CFG_JSON_13"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Bulk JSON Configuration API", "sections": ["Bulk JSON Configuration API", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_all_from_json", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_BOOL": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_bool(const char* key, bool value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Write a boolean value to NVS and commit immediately.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_bool(const char* key, bool value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - New boolean value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` is NULL\n* ``ESP_ERR_NVS_*`` - NVS write failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_BOOL", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 446, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Boolean Parameter Access", "sections": ["Boolean Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_bool", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_BOOL_NO_COMMIT": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_bool_no_commit(const char* key, bool value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Write a boolean value to NVS without committing; use ``config_commit()``\nto persist batched updates.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_bool_no_commit(const char* key, bool value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - New boolean value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` is NULL\n* ``ESP_ERR_NVS_*`` - NVS write failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_BOOL_NO_COMMIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 418, "links": [], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Boolean Parameter Access", "sections": ["Boolean Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_bool_no_commit", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_INT16": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_int16(const char* key, int16_t value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Write a 16-bit signed integer to NVS and commit immediately.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_int16(const char* key, int16_t value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - New parameter value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` is NULL\n* ``ESP_ERR_NVS_*`` - NVS write failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_INT16", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 331, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Integer Parameter Access", "sections": ["Integer Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_int16", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_INT16_NO_COMMIT": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_int16_no_commit(const char* key, int16_t value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Write an int16 value to NVS without committing; use ``config_commit()`` to\npersist batched updates.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_int16_no_commit(const char* key, int16_t value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - New parameter value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` is NULL\n* ``ESP_ERR_NVS_*`` - NVS write failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_INT16_NO_COMMIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 359, "links": [], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Integer Parameter Access", "sections": ["Integer Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_int16_no_commit", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_INT32": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_int32(const char* key, int32_t value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Write a 32-bit signed integer to NVS and commit immediately.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_int32(const char* key, int32_t value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - New parameter value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` is NULL\n* ``ESP_ERR_NVS_*`` - NVS write failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_INT32", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 275, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Integer Parameter Access", "sections": ["Integer Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_int32", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_STRING": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_string(const char* key, const char* value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Write a null-terminated string value to NVS and commit immediately.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_string(const char* key, const char* value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - Null-terminated string value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` or ``value`` is NULL\n* ``ESP_ERR_NVS_*`` - NVS write failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_STRING", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 188, "links": ["REQ_CFG_JSON_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "String Parameter Access", "sections": ["String Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_string", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_SET_STRING_NO_COMMIT": {"acceptance_criteria": "", "api_signature": "esp_err_t config_set_string_no_commit(const char* key, const char* value)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Write a string to NVS without committing. Call ``config_commit()`` to\npersist batched updates.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t config_set_string_no_commit(const char* key, const char* value)\n\n**Parameters:**\n\n* ``key`` - NVS key name\n* ``value`` - Null-terminated string value\n\n**Returns:**\n\n* ``ESP_OK`` - Success\n* ``ESP_ERR_INVALID_ARG`` - ``key`` or ``value`` is NULL\n* ``ESP_ERR_NVS_*`` - NVS write failure", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_SET_STRING_NO_COMMIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 216, "links": [], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "Summary for metadata", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "String Parameter Access", "sections": ["String Parameter Access", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_set_string_no_commit", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_CONFIG_WRITE_FACTORY_DEFAULTS": {"acceptance_criteria": "", "api_signature": "void config_write_factory_defaults(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_CONFIG_MANAGER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Auto-generated helper that writes factory default values to NVS. It is\ngenerated at build-time from `config_schema.json` and should not be\ncalled directly by applications; use ``config_factory_reset()`` instead.\n\n**Signature:**\n\n.. code-block:: c\n\n   void config_write_factory_defaults(void)\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* None\n\n.. note::\n   Generated during build - reference only.", "created_at": "", "docname": "21_api/api_config_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_CONFIG_WRITE_FACTORY_DEFAULTS", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 122, "links": ["REQ_CFG_JSON_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Summary for metadata", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Config Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "config_write_factory_defaults", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISPLAY_LOGIC_START": {"acceptance_criteria": "", "api_signature": "esp_err_t display_logic_start(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISPLAY_LOGIC", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Start the display logic system. Obtains configuration from config_manager, initializes hardware, and starts the display task. No separate init/start lifecycle needed.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t display_logic_start(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Display logic task started successfully\n* ``ESP_ERR_INVALID_STATE`` - Task already running, or required components not initialized\n* ``ESP_FAIL`` - Failed to create display logic task\n* ``ESP_ERR_*`` - Other error cases from underlying components\n\n.. note::\n   - Single entry point - handles initialization and task startup\n   - Task runs on core 1 with 4KB stack at priority 3\n   - Task blocks on distance_sensor_get_latest() until new data arrives\n   - Configuration obtained from config_manager API\n   - Thread-safe: Task-based, no global state exposed\n   - See requirements: REQ_DSP_1, REQ_DSP_2, REQ_DSP_3, REQ_DSP_4", "created_at": "", "docname": "21_api/api_display_logic", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISPLAY_LOGIC_START", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 35, "links": ["REQ_DSP_1", "REQ_DSP_2", "REQ_DSP_3", "REQ_DSP_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_* on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Display Logic API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "display_logic_start", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_GET_LATEST": {"acceptance_criteria": "", "api_signature": "esp_err_t distance_sensor_get_latest(distance_measurement_t *measurement)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get the latest distance measurement (blocking until new data is available).\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t distance_sensor_get_latest(distance_measurement_t *measurement);\n\n**Parameters:**\n\n* ``measurement`` - Pointer to store the measurement result\n\n**Returns:**\n\n* ``ESP_OK`` - Measurement available\n* ``ESP_ERR_INVALID_ARG`` - Null pointer\n\n.. note::\n   - See requirements: REQ_SNS_8, REQ_SNS_9\n   - Blocking, race-condition-safe", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_GET_LATEST", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 127, "links": ["REQ_SNS_8", "REQ_SNS_9"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "measurement", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_INVALID_ARG", "section_name": "Data Access Functions", "sections": ["Data Access Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_get_latest", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_GET_QUEUE_OVERFLOWS": {"acceptance_criteria": "", "api_signature": "uint32_t distance_sensor_get_queue_overflows(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get the number of queue overflows (discarded measurements).\n\n**Signature:**\n\n.. code-block:: c\n\n   uint32_t distance_sensor_get_queue_overflows(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``uint32_t`` - Number of discarded measurements\n\n.. note::\n   - See requirements: REQ_SNS_6, REQ_SNS_10\n   - Diagnostics/statistics", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_GET_QUEUE_OVERFLOWS", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 190, "links": ["REQ_SNS_6", "REQ_SNS_10"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Number of measurements discarded due to queue overflow", "section_name": "Statistics & Monitoring Functions", "sections": ["Statistics & Monitoring Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_get_queue_overflows", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_HAS_NEW_MEASUREMENT": {"acceptance_criteria": "", "api_signature": "bool distance_sensor_has_new_measurement(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Check if a new measurement is available (non-blocking).\n\n**Signature:**\n\n.. code-block:: c\n\n   bool distance_sensor_has_new_measurement(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``true`` - New measurement available\n* ``false`` - No new measurement\n\n.. note::\n   - See requirements: REQ_SNS_8\n   - Non-blocking API", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_HAS_NEW_MEASUREMENT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 157, "links": ["REQ_SNS_8"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "true if new measurement available, false otherwise", "section_name": "Data Access Functions", "sections": ["Data Access Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_has_new_measurement", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_INIT": {"acceptance_criteria": "", "api_signature": "esp_err_t distance_sensor_init(gpio_num_t trigger_pin, gpio_num_t echo_pin)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Initialize the distance sensor, configure GPIO, ISR, and queues. Loads configuration from config_manager.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t distance_sensor_init(gpio_num_t trigger_pin, gpio_num_t echo_pin);\n\n**Parameters:**\n\n* ``trigger_pin`` - GPIO pin for HC-SR04 trigger signal\n* ``echo_pin`` - GPIO pin for HC-SR04 echo signal\n\n**Returns:**\n\n* ``ESP_OK`` - Initialization successful\n* ``ESP_ERR_INVALID_STATE`` - Config manager not initialized\n* ``ESP_ERR_INVALID_ARG`` - Invalid pin arguments\n* ``ESP_ERR_*`` - Other configuration or hardware errors\n\n.. note::\n   - See requirements: REQ_SNS_1, REQ_SNS_5, REQ_SNS_6, REQ_SNS_9\n   - Dual-queue, race-condition-safe, config_manager integration", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_INIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 33, "links": ["REQ_SNS_1", "REQ_SNS_5", "REQ_SNS_6", "REQ_SNS_9"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "trigger_pin, echo_pin", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_INVALID_STATE, ESP_ERR_INVALID_ARG, ESP_ERR_*", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_init", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_IS_RUNNING": {"acceptance_criteria": "", "api_signature": "bool distance_sensor_is_running(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Check if the sensor task is running.\n\n**Signature:**\n\n.. code-block:: c\n\n   bool distance_sensor_is_running(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``true`` - Sensor task running\n* ``false`` - Not running\n\n.. note::\n   - See requirements: REQ_SNS_8\n   - API blocking/read semantics", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_IS_RUNNING", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 248, "links": ["REQ_SNS_8"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "true if sensor task is running, false otherwise", "section_name": "Statistics & Monitoring Functions", "sections": ["Statistics & Monitoring Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_is_running", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_MONITOR": {"acceptance_criteria": "", "api_signature": "esp_err_t distance_sensor_monitor(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Perform lightweight sensor health monitoring (queue overflow, health status).\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t distance_sensor_monitor(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Monitoring successful\n\n.. note::\n   - See requirements: REQ_SNS_7, REQ_SNS_10\n   - Health monitoring, diagnostics", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_MONITOR", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 219, "links": ["REQ_SNS_7", "REQ_SNS_10"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success", "section_name": "Statistics & Monitoring Functions", "sections": ["Statistics & Monitoring Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_monitor", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_START": {"acceptance_criteria": "", "api_signature": "esp_err_t distance_sensor_start(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Start distance measurements, create measurement task, trigger sensors, process results.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t distance_sensor_start(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Task started successfully\n\n.. note::\n   - See requirements: REQ_SNS_2, REQ_SNS_3, REQ_SNS_4, REQ_SNS_8\n   - Dual-queue, real-time, blocking API", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_START", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 66, "links": ["REQ_SNS_2", "REQ_SNS_3", "REQ_SNS_4", "REQ_SNS_8"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_start", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_DISTANCE_SENSOR_STOP": {"acceptance_criteria": "", "api_signature": "esp_err_t distance_sensor_stop(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Stop distance measurements and measurement task.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t distance_sensor_stop(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Task stopped successfully\n\n.. note::\n   - See requirements: REQ_SNS_8\n   - API blocking/read semantics", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_DISTANCE_SENSOR_STOP", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 95, "links": ["REQ_SNS_8"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_stop", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_CLEAR_ALL": {"acceptance_criteria": "", "api_signature": "esp_err_t led_clear_all(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Clear all LED pixels (set all to off/black) in RAM buffer.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_clear_all(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - All pixels cleared\n* ``ESP_ERR_*`` - Failure\n\n.. note::\n   - See requirements: REQ_LED_2\n   - Call led_show() to update physical LEDs", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_CLEAR_ALL", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 189, "links": ["REQ_LED_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_*", "section_name": "Pixel Control Functions", "sections": ["Pixel Control Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_clear_all", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_CLEAR_PIXEL": {"acceptance_criteria": "", "api_signature": "esp_err_t led_clear_pixel(uint16_t index)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Clear a specific LED pixel (set to off/black).\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_clear_pixel(uint16_t index);\n\n**Parameters:**\n\n* ``index`` - LED index (0 to led_count-1)\n\n**Returns:**\n\n* ``ESP_OK`` - Pixel cleared successfully\n* ``ESP_ERR_INVALID_ARG`` - Index out of range\n\n.. note::\n   - See requirements: REQ_LED_2\n   - Equivalent to led_set_pixel(index, LED_COLOR_OFF)", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_CLEAR_PIXEL", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 130, "links": ["REQ_LED_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "index", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_INVALID_ARG", "section_name": "Pixel Control Functions", "sections": ["Pixel Control Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_clear_pixel", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_COLOR_BRIGHTNESS": {"acceptance_criteria": "", "api_signature": "led_color_t led_color_brightness(led_color_t color, uint8_t brightness)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Apply brightness scaling to a color.\n\n**Signature:**\n\n.. code-block:: c\n\n   led_color_t led_color_brightness(led_color_t color, uint8_t brightness);\n\n**Parameters:**\n\n* ``color`` - Original color\n* ``brightness`` - Brightness factor (0=off, 255=full)\n\n**Returns:**\n\n* ``led_color_t`` - Color with brightness applied\n\n.. note::\n   - See requirements: REQ_LED_4\n   - Uses integer math, no floating point", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_COLOR_BRIGHTNESS", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 283, "links": ["REQ_LED_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "color, brightness", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Color with applied brightness scaling", "section_name": "Color Utility Functions", "sections": ["Color Utility Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_color_brightness", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_COLOR_RGB": {"acceptance_criteria": "", "api_signature": "led_color_t led_color_rgb(uint8_t r, uint8_t g, uint8_t b)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Create RGB color from individual components.\n\n**Signature:**\n\n.. code-block:: c\n\n   led_color_t led_color_rgb(uint8_t r, uint8_t g, uint8_t b);\n\n**Parameters:**\n\n* ``r`` - Red component (0-255)\n* ``g`` - Green component (0-255)\n* ``b`` - Blue component (0-255)\n\n**Returns:**\n\n* ``led_color_t`` - RGB color structure\n\n.. note::\n   - See requirements: REQ_LED_4\n   - Use for custom colors", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_COLOR_RGB", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 252, "links": ["REQ_LED_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "r, g, b", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "RGB color structure", "section_name": "Color Utility Functions", "sections": ["Color Utility Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_color_rgb", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_DEINIT": {"acceptance_criteria": "", "api_signature": "esp_err_t led_controller_deinit(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Deinitialize the LED controller, free memory, deinit RMT, and reset GPIO.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_controller_deinit(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Deinitialization successful\n* ``ESP_ERR_*`` - Failure\n\n.. note::\n   - See requirements: REQ_LED_1\n   - Frees all resources, resets hardware", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_DEINIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 66, "links": ["REQ_LED_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_*", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_controller_deinit", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_GET_ALL_COLORS": {"acceptance_criteria": "", "api_signature": "uint16_t led_get_all_colors(led_color_t* output_buffer, uint16_t max_count)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get snapshot of all LED colors (thread-safe, matches last led_show).\n\n**Signature:**\n\n.. code-block:: c\n\n   uint16_t led_get_all_colors(led_color_t* output_buffer, uint16_t max_count);\n\n**Parameters:**\n\n* ``output_buffer`` - Buffer to receive LED colors (must be >= led_count)\n* ``max_count`` - Maximum number of LEDs to copy\n\n**Returns:**\n\n* ``uint16_t`` - Number of LEDs copied, or 0 on error\n\n.. note::\n   - See requirements: REQ_LED_5\n   - Thread-safe, matches physical LED state", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_GET_ALL_COLORS", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 375, "links": ["REQ_LED_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "output_buffer, max_count", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Number of LEDs copied, or 0 on error", "section_name": "Configuration/Status Functions", "sections": ["Configuration/Status Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_get_all_colors", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_GET_COUNT": {"acceptance_criteria": "", "api_signature": "uint16_t led_get_count(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get configured LED count.\n\n**Signature:**\n\n.. code-block:: c\n\n   uint16_t led_get_count(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``uint16_t`` - Number of LEDs, or 0 if not initialized\n\n.. note::\n   - See requirements: REQ_LED_3, REQ_CFG_1\n   - Returns value from configuration", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_GET_COUNT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 316, "links": ["REQ_LED_3", "REQ_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Number of LEDs, or 0 if not initialized", "section_name": "Configuration/Status Functions", "sections": ["Configuration/Status Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_get_count", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_GET_PIXEL": {"acceptance_criteria": "", "api_signature": "led_color_t led_get_pixel(uint16_t index)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get current color of a specific LED pixel from RAM buffer.\n\n**Signature:**\n\n.. code-block:: c\n\n   led_color_t led_get_pixel(uint16_t index);\n\n**Parameters:**\n\n* ``index`` - LED index (0 to led_count-1)\n\n**Returns:**\n\n* ``led_color_t`` - Current color, or LED_COLOR_OFF if out of range\n\n.. note::\n   - See requirements: REQ_LED_2, REQ_LED_5\n   - Reads from RAM buffer, not physical LED", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_GET_PIXEL", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 160, "links": ["REQ_LED_2", "REQ_LED_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "index", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Current LED color, or LED_COLOR_OFF if index out of range", "section_name": "Pixel Control Functions", "sections": ["Pixel Control Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_get_pixel", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_INIT": {"acceptance_criteria": "", "api_signature": "esp_err_t led_controller_init(gpio_num_t data_pin)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Initialize the LED controller, configure GPIO and RMT, allocate RAM buffer, and load configuration.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_controller_init(gpio_num_t data_pin);\n\n**Parameters:**\n\n* ``data_pin`` - GPIO pin for WS2812 data line\n\n**Returns:**\n\n* ``ESP_OK`` - Initialization successful\n* ``ESP_ERR_INVALID_STATE`` - Config manager not initialized\n* ``ESP_ERR_INVALID_ARG`` - Invalid pin argument\n* ``ESP_ERR_*`` - Other configuration or hardware errors\n\n.. note::\n   - See requirements: REQ_LED_1, REQ_LED_3, REQ_CFG_1\n   - Allocates memory for LED buffer (3 bytes per LED)\n   - Only one instance supported, uses RMT channel 0", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_INIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 33, "links": ["REQ_LED_1", "REQ_LED_3", "REQ_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "data_pin", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_INVALID_STATE, ESP_ERR_INVALID_ARG, ESP_ERR_*", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_controller_init", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_IS_INITIALIZED": {"acceptance_criteria": "", "api_signature": "bool led_is_initialized(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Check if LED controller is initialized.\n\n**Signature:**\n\n.. code-block:: c\n\n   bool led_is_initialized(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``true`` - Initialized\n* ``false`` - Not initialized\n\n.. note::\n   - See requirements: REQ_LED_1\n   - Use before calling other API functions", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_IS_INITIALIZED", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 345, "links": ["REQ_LED_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "true if initialized, false otherwise", "section_name": "Configuration/Status Functions", "sections": ["Configuration/Status Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_is_initialized", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_SET_PIXEL": {"acceptance_criteria": "", "api_signature": "esp_err_t led_set_pixel(uint16_t index, led_color_t color)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Set color of a specific LED pixel in RAM buffer.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_set_pixel(uint16_t index, led_color_t color);\n\n**Parameters:**\n\n* ``index`` - LED index (0 to led_count-1)\n* ``color`` - RGB color to set\n\n**Returns:**\n\n* ``ESP_OK`` - Pixel set successfully\n* ``ESP_ERR_INVALID_ARG`` - Index out of range\n\n.. note::\n   - See requirements: REQ_LED_2, REQ_LED_3\n   - Call led_show() to update physical LEDs", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_SET_PIXEL", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 99, "links": ["REQ_LED_2", "REQ_LED_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "index, color", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_INVALID_ARG", "section_name": "Pixel Control Functions", "sections": ["Pixel Control Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_set_pixel", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_LED_CONTROLLER_SHOW": {"acceptance_criteria": "", "api_signature": "esp_err_t led_show(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Update physical LED strip with current RAM buffer.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_show(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Update successful\n* ``ESP_ERR_*`` - Failure\n\n.. note::\n   - See requirements: REQ_LED_2, REQ_LED_4\n   - Blocks until transmission complete (~1-2ms for 40 LEDs)", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_LED_CONTROLLER_SHOW", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 219, "links": ["REQ_LED_2", "REQ_LED_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_*", "section_name": "Pixel Control Functions", "sections": ["Pixel Control Functions", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_show", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_NETIF_TUNNEL_DEINIT": {"acceptance_criteria": "", "api_signature": "esp_err_t netif_uart_tunnel_deinit(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_NETIF_TUNNEL", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Deinitialize UART tunnel network interface. Stops the receive task and cleans up resources. Active network connections will be closed by lwIP stack.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t netif_uart_tunnel_deinit(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Deinitialization successful\n* ``ESP_ERR_INVALID_STATE`` - Interface was not initialized\n* ``ESP_FAIL`` - Cleanup failed\n\n.. note::\n   Thread-safe. Idempotent after first call. All active TCP/UDP connections will be terminated.", "created_at": "", "docname": "21_api/api_netif_uart_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_NETIF_TUNNEL_DEINIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 89, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error codes on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Network Tunnel API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "netif_uart_tunnel_deinit", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_NETIF_TUNNEL_GET_HANDLE": {"acceptance_criteria": "", "api_signature": "esp_netif_t* netif_uart_tunnel_get_handle(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_NETIF_TUNNEL", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get the esp_netif handle for the UART tunnel interface. Useful for registering event handlers or querying interface status.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_netif_t* netif_uart_tunnel_get_handle(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``esp_netif_t*`` - Handle if interface is initialized\n* ``NULL`` - If not initialized\n\n.. note::\n   Thread-safe. Handle remains valid until deinit is called.", "created_at": "", "docname": "21_api/api_netif_uart_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_NETIF_TUNNEL_GET_HANDLE", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 119, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "esp_netif handle or NULL", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Network Tunnel API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "netif_uart_tunnel_get_handle", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_NETIF_TUNNEL_INIT": {"acceptance_criteria": "", "api_signature": "esp_err_t netif_uart_tunnel_init(const netif_uart_tunnel_config_t *config)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_NETIF_TUNNEL", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Initialize UART tunnel network interface. Creates and configures a lwIP network interface that tunnels IP packets over UART1. Starts a background task to handle packet reception from UART.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t netif_uart_tunnel_init(const netif_uart_tunnel_config_t *config);\n\n**Parameters:**\n\n* ``config`` - Network configuration (IP, netmask, gateway)\n\n**Returns:**\n\n* ``ESP_OK`` - Initialization successful\n* ``ESP_ERR_INVALID_ARG`` - Config is NULL or contains invalid values\n* ``ESP_ERR_NO_MEM`` - Memory allocation failed\n* ``ESP_FAIL`` - UART or lwIP initialization failed\n\n.. note::\n   Thread-safe. Only call once; subsequent calls return ESP_ERR_INVALID_STATE.", "created_at": "", "docname": "21_api/api_netif_uart_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_NETIF_TUNNEL_INIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 58, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "config - network configuration", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error codes on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Network Tunnel API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "netif_uart_tunnel_init", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_STARTUP_TESTS_MULTIPLE_CYCLES": {"acceptance_criteria": "", "api_signature": "esp_err_t led_running_test_multiple_cycles(led_color_t color, uint32_t delay_ms, uint8_t cycles)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_STARTUP_TESTS", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Run multiple cycles of running light effect.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_running_test_multiple_cycles(led_color_t color, uint32_t delay_ms, uint8_t cycles);\n\n**Parameters:**\n\n* ``color`` - Color of the running LED\n* ``delay_ms`` - Delay between LED movements in milliseconds\n* ``cycles`` - Number of complete cycles to run\n\n**Returns:**\n\n* ``ESP_OK`` - Test completed successfully\n\n.. note::\n   - See requirements: REQ_STARTUP_2, REQ_LED_2\n   - Synchronous, blocking execution", "created_at": "", "docname": "21_api/api_startup_tests", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_STARTUP_TESTS_MULTIPLE_CYCLES", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 61, "links": ["REQ_STARTUP_2", "REQ_LED_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "color, delay_ms, cycles", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success", "section_name": "Test Functions", "sections": ["Test Functions", "Startup Tests API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_running_test_multiple_cycles", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_STARTUP_TESTS_RAINBOW": {"acceptance_criteria": "", "api_signature": "esp_err_t led_running_test_rainbow(uint32_t delay_ms, uint8_t cycles)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_STARTUP_TESTS", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Run rainbow running light effect (color changes as it moves).\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_running_test_rainbow(uint32_t delay_ms, uint8_t cycles);\n\n**Parameters:**\n\n* ``delay_ms`` - Delay between LED movements in milliseconds\n* ``cycles`` - Number of complete cycles to run\n\n**Returns:**\n\n* ``ESP_OK`` - Test completed successfully\n\n.. note::\n   - See requirements: REQ_STARTUP_3, REQ_LED_2\n   - Synchronous, blocking execution", "created_at": "", "docname": "21_api/api_startup_tests", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_STARTUP_TESTS_RAINBOW", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 92, "links": ["REQ_STARTUP_3", "REQ_LED_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "delay_ms, cycles", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success", "section_name": "Test Functions", "sections": ["Test Functions", "Startup Tests API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_running_test_rainbow", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_STARTUP_TESTS_SINGLE_CYCLE": {"acceptance_criteria": "", "api_signature": "esp_err_t led_running_test_single_cycle(led_color_t color, uint32_t delay_ms)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_STARTUP_TESTS", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Run a single cycle of running light effect (one LED moves across the strip).\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t led_running_test_single_cycle(led_color_t color, uint32_t delay_ms);\n\n**Parameters:**\n\n* ``color`` - Color of the running LED\n* ``delay_ms`` - Delay between LED movements in milliseconds\n\n**Returns:**\n\n* ``ESP_OK`` - Test completed successfully\n\n.. note::\n   - See requirements: REQ_STARTUP_2, REQ_LED_2\n   - Synchronous, blocking execution", "created_at": "", "docname": "21_api/api_startup_tests", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_STARTUP_TESTS_SINGLE_CYCLE", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 31, "links": ["REQ_STARTUP_2", "REQ_LED_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "color, delay_ms", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success", "section_name": "Test Functions", "sections": ["Test Functions", "Startup Tests API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_running_test_single_cycle", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WEB_GET_PORT": {"acceptance_criteria": "", "api_signature": "uint16_t web_server_get_port(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WEB_SERVER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get the current HTTP server port number.\n\n**Signature:**\n\n.. code-block:: c\n\n   uint16_t web_server_get_port(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``uint16_t`` - Server port number (typically 80)", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WEB_GET_PORT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 143, "links": ["REQ_WEB_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "Server port number", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "web_server_get_port", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WEB_INIT": {"acceptance_criteria": "", "api_signature": "esp_err_t web_server_init(const web_server_config_t *config)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WEB_SERVER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Initialize web server with embedded static assets.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t web_server_init(const web_server_config_t *config);\n\n**Parameters:**\n\n* ``config`` - Server configuration (NULL for default settings)\n\n**Returns:**\n\n* ``ESP_OK`` - Initialization successful\n* ``ESP_ERR_NO_MEM`` - Out of memory\n* ``ESP_ERR_INVALID_ARG`` - Invalid configuration\n* ``ESP_FAIL`` - Other errors\n\n.. note::\n   Sets up all URI handlers for static files and API endpoints.", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "API_FUNC_WEB_INIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 26, "links": ["REQ_SYS_WEB_1", "REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_3", "REQ_WEB_CONF_1", "REQ_WEB_4", "REQ_WEB_5", "SPEC_WEB_SERVER"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "config (server configuration or NULL)", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "web_server_init", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WEB_IS_RUNNING": {"acceptance_criteria": "", "api_signature": "bool web_server_is_running(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WEB_SERVER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Check if web server is currently running.\n\n**Signature:**\n\n.. code-block:: c\n\n   bool web_server_is_running(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``true`` - HTTP server is active\n* ``false`` - HTTP server is not running", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WEB_IS_RUNNING", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 117, "links": ["REQ_WEB_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "true if HTTP server is active, false otherwise", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "web_server_is_running", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WEB_START": {"acceptance_criteria": "", "api_signature": "esp_err_t web_server_start(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WEB_SERVER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Start web server and DNS server for captive portal.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t web_server_start(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Server started successfully\n* ``ESP_ERR_INVALID_STATE`` - Server already running\n* ``ESP_FAIL`` - Other errors\n\n.. note::\n   Starts DNS server for captive portal in AP mode.", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "API_FUNC_WEB_START", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 57, "links": ["REQ_WEB_3", "REQ_SYS_NET_1", "SPEC_WEB_SERVER"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "web_server_start", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WEB_STATIC_FILE": {"acceptance_criteria": "", "api_signature": "esp_err_t static_file_handler(httpd_req_t *req)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WEB_SERVER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "HTTP handler for serving embedded static files.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t static_file_handler(httpd_req_t *req);\n\n**Parameters:**\n\n* ``req`` - HTTP request object\n\n**Returns:**\n\n* ``ESP_OK`` - File served successfully\n* ``ESP_FAIL`` - File not found or other errors\n\n.. note::\n   Serves HTML, CSS, and JS files from embedded flash. Sets MIME types and cache headers.", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "API_FUNC_WEB_STATIC_FILE", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 171, "links": ["REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_4", "REQ_WEB_SCHEMA_1", "SPEC_CONFIG_WEBPAGE"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "req (HTTP request object)", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_FAIL on file not found or other errors", "section_name": "Static File Handler", "sections": ["Static File Handler", "Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "static_file_handler", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WEB_STOP": {"acceptance_criteria": "", "api_signature": "esp_err_t web_server_stop(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WEB_SERVER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Stop web server and DNS server.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t web_server_stop(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Server stopped successfully\n* ``ESP_ERR_INVALID_STATE`` - Server not running\n* ``ESP_FAIL`` - Other errors\n\n.. note::\n   Safe to call multiple times or when servers are not running.", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "API_FUNC_WEB_STOP", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 87, "links": ["REQ_WEB_5", "SPEC_WEB_SERVER"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "web_server_stop", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_CLEAR_CRED": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_clear_credentials(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Clear stored WiFi credentials.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_clear_credentials(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Credentials cleared and switched to AP mode\n* ``ESP_FAIL`` - Other errors", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_CLEAR_CRED", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 166, "links": ["REQ_WEB_3", "REQ_SYS_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Configuration/Status Functions", "sections": ["Configuration/Status Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_clear_credentials", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_GET_IP": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_get_ip_address(char *ip_str, size_t max_len)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get current IP address as string.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_get_ip_address(char *ip_str, size_t max_len);\n\n**Parameters:**\n\n* ``ip_str`` - Buffer to store IP address string (min 16 bytes)\n* ``max_len`` - Maximum length of ip_str buffer\n\n**Returns:**\n\n* ``ESP_OK`` - IP address copied to buffer\n* ``ESP_ERR_INVALID_STATE`` - No IP assigned\n* ``ESP_FAIL`` - Other errors", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_GET_IP", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 192, "links": ["REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "ip_str (buffer), max_len (buffer length)", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_INVALID_STATE if no IP assigned", "section_name": "Configuration/Status Functions", "sections": ["Configuration/Status Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_get_ip_address", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_GET_STATUS": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_get_status(wifi_status_t *status)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Get current WiFi status.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_get_status(wifi_status_t *status);\n\n**Parameters:**\n\n* ``status`` - Pointer to status structure to fill\n\n**Returns:**\n\n* ``ESP_OK`` - Status filled successfully\n* ``ESP_ERR_INVALID_ARG`` - status is NULL\n* ``ESP_FAIL`` - Other errors", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_GET_STATUS", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 112, "links": ["REQ_SYS_NET_1", "REQ_WEB_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "status (pointer to status structure)", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, ESP_ERR_INVALID_ARG if status is NULL", "section_name": "Configuration/Status Functions", "sections": ["Configuration/Status Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_get_status", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_INIT": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_init(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Initialize WiFi manager with smart boot logic.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_init(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Initialization successful\n* ``ESP_ERR_NO_MEM`` - Out of memory\n* ``ESP_ERR_FAIL`` - Other errors\n\n.. note::\n   Automatically tries stored credentials, falls back to AP mode if needed.", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "API_FUNC_WIFI_INIT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 25, "links": ["REQ_SYS_NET_1", "REQ_WEB_3", "SPEC_WEB_SERVER"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_init", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_MONITOR": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_monitor(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Perform lightweight WiFi health monitoring.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_monitor(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Monitoring performed successfully\n* ``ESP_FAIL`` - Other errors\n\n.. note::\n   Should be called periodically from main.c (at least once every 30 seconds).", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_MONITOR", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 249, "links": ["REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success", "section_name": "Utility Functions", "sections": ["Utility Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_monitor", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_SET_CRED": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_set_credentials(const wifi_credentials_t *credentials)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Save WiFi credentials and attempt connection.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_set_credentials(const wifi_credentials_t *credentials);\n\n**Parameters:**\n\n* ``credentials`` - WiFi credentials to save and connect to\n\n**Returns:**\n\n* ``ESP_OK`` - Credentials saved and connection attempted\n* ``ESP_ERR_INVALID_ARG`` - Invalid credentials\n* ``ESP_FAIL`` - Other errors", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_SET_CRED", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 139, "links": ["REQ_WEB_3", "REQ_SYS_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "credentials (WiFi credentials to save and connect to)", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Configuration/Status Functions", "sections": ["Configuration/Status Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_set_credentials", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_START": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_start(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Start WiFi manager (called after init).\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_start(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Started successfully\n* ``ESP_ERR_INVALID_STATE`` - Already started\n* ``ESP_FAIL`` - Other errors", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_START", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 55, "links": ["REQ_SYS_NET_1", "REQ_WEB_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_start", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_STOP": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_stop(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Stop WiFi manager.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_stop(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Stopped successfully\n* ``ESP_ERR_INVALID_STATE`` - Not running\n* ``ESP_FAIL`` - Other errors", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_STOP", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 82, "links": ["REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Lifecycle Functions", "sections": ["Lifecycle Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_stop", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_FUNC_WIFI_SWITCH_AP": {"acceptance_criteria": "", "api_signature": "esp_err_t wifi_manager_switch_to_ap(void)", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Force switch to AP mode.\n\n**Signature:**\n\n.. code-block:: c\n\n   esp_err_t wifi_manager_switch_to_ap(void);\n\n**Parameters:**\n\n* None\n\n**Returns:**\n\n* ``ESP_OK`` - Switched to AP mode\n* ``ESP_FAIL`` - Other errors", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_FUNC_WIFI_SWITCH_AP", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 223, "links": ["REQ_WEB_3", "REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "None", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "ESP_OK on success, error code on failure", "section_name": "Utility Functions", "sections": ["Utility Functions", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_switch_to_ap", "type": "apifunction", "type_name": "API Function", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_DISTANCE_SENSOR_ERROR": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Error codes for distance sensor measurements.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef enum {\n       DISTANCE_SENSOR_OK = 0,\n       DISTANCE_SENSOR_TIMEOUT,\n       DISTANCE_SENSOR_OUT_OF_RANGE,\n       DISTANCE_SENSOR_NO_ECHO,\n       DISTANCE_SENSOR_INVALID_READING\n   } distance_sensor_error_t;\n\n**Values:**\n\n* ``DISTANCE_SENSOR_OK`` - Measurement successful\n* ``DISTANCE_SENSOR_TIMEOUT`` - Echo not received in time\n* ``DISTANCE_SENSOR_OUT_OF_RANGE`` - Measurement out of valid range\n* ``DISTANCE_SENSOR_NO_ECHO`` - No echo detected\n* ``DISTANCE_SENSOR_INVALID_READING`` - Invalid or corrupted reading", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_DISTANCE_SENSOR_ERROR", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 281, "links": ["REQ_SNS_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_sensor_error_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_DISTANCE_SENSOR_MEASUREMENT": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Processed distance measurement.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef struct {\n       uint16_t distance_mm;\n       uint64_t timestamp_us;\n       distance_sensor_error_t status;\n   } distance_measurement_t;\n\n**Fields:**\n\n* ``distance_mm`` - Calculated distance in millimeters (0-65535mm)\n* ``timestamp_us`` - Measurement timestamp (microseconds)\n* ``status`` - Measurement status (see distance_sensor_error_t)", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_DISTANCE_SENSOR_MEASUREMENT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 333, "links": ["REQ_SNS_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_measurement_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_DISTANCE_SENSOR_RAW_MEASUREMENT": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_DISTANCE_SENSOR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Raw measurement data from ISR (timestamps only).\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef struct {\n       uint64_t echo_start_us;\n       uint64_t echo_end_us;\n       distance_sensor_error_t status;\n   } distance_raw_measurement_t;\n\n**Fields:**\n\n* ``echo_start_us`` - Echo start timestamp (microseconds)\n* ``echo_end_us`` - Echo end timestamp (microseconds)\n* ``status`` - Measurement status (see distance_sensor_error_t)", "created_at": "", "docname": "21_api/api_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_DISTANCE_SENSOR_RAW_MEASUREMENT", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 309, "links": ["REQ_SNS_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "Distance Sensor API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "distance_raw_measurement_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_LED_COLOR": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_LED_CONTROLLER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "RGB color structure for LED pixel color.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef struct {\n       uint8_t red;\n       uint8_t green;\n       uint8_t blue;\n   } led_color_t;\n\n**Fields:**\n\n* ``red`` - Red component (0-255)\n* ``green`` - Green component (0-255)\n* ``blue`` - Blue component (0-255)", "created_at": "", "docname": "21_api/api_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_LED_COLOR", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 408, "links": ["REQ_LED_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "LED Controller API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "led_color_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_NETIF_TUNNEL_CONFIG": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_NETIF_TUNNEL", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Configuration for UART tunnel network interface.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef struct {\n       const char* hostname;\n       uint8_t ip_addr[4];\n       uint8_t netmask[4];\n       uint8_t gateway[4];\n   } netif_uart_tunnel_config_t;\n\n**Fields:**\n\n* ``hostname`` - Hostname for the interface\n* ``ip_addr`` - Static IP address (e.g., {192,168,100,2})\n* ``netmask`` - Netmask (e.g., {255,255,255,0})\n* ``gateway`` - Gateway IP (e.g., {192,168,100,1})", "created_at": "", "docname": "21_api/api_netif_uart_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_NETIF_TUNNEL_CONFIG", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 29, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Structure", "sections": ["Configuration Structure", "Network Tunnel API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "netif_uart_tunnel_config_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_WEB_CONFIG": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WEB_SERVER", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "Web server configuration structure.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef struct {\n       uint16_t port;\n       size_t max_open_sockets;\n   } web_server_config_t;\n\n**Fields:**\n\n* ``port`` - HTTP server port (default: 80)\n* ``max_open_sockets`` - Maximum concurrent connections (default: 7)", "created_at": "", "docname": "21_api/api_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_WEB_CONFIG", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 203, "links": ["REQ_WEB_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "Web Server API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "web_server_config_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_WIFI_CRED": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "WiFi credentials structure.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef struct {\n       char ssid[32];\n       char password[64];\n   } wifi_credentials_t;\n\n**Fields:**\n\n* ``ssid`` - WiFi SSID (max 31 chars + null terminator)\n* ``password`` - WiFi password (max 63 chars + null terminator)", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_WIFI_CRED", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 309, "links": ["REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_credentials_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_WIFI_MODE": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "WiFi manager modes.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef enum {\n       WIFI_MODE_DISCONNECTED = 0,\n       WIFI_MODE_STA_CONNECTING,\n       WIFI_MODE_STA_CONNECTED,\n       WIFI_MODE_AP_ACTIVE,\n       WIFI_MODE_SWITCHING\n   } wifi_manager_mode_t;\n\n**Values:**\n\n* ``WIFI_MODE_DISCONNECTED`` - Not connected to any network\n* ``WIFI_MODE_STA_CONNECTING`` - Attempting to connect to STA\n* ``WIFI_MODE_STA_CONNECTED`` - Connected to STA network\n* ``WIFI_MODE_AP_ACTIVE`` - AP mode active with captive portal\n* ``WIFI_MODE_SWITCHING`` - Transitioning between modes", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_WIFI_MODE", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 281, "links": ["REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_manager_mode_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "API_STRUCT_WIFI_STATUS": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "API_COMP_WIFI_MGR", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "WiFi status information.\n\n**Definition:**\n\n.. code-block:: c\n\n   typedef struct {\n       wifi_manager_mode_t mode;\n       char connected_ssid[32];\n       int8_t rssi;\n       uint8_t retry_count;\n       bool has_credentials;\n   } wifi_status_t;\n\n**Fields:**\n\n* ``mode`` - Current WiFi mode\n* ``connected_ssid`` - Currently connected SSID (if any)\n* ``rssi`` - Signal strength (dBm)\n* ``retry_count`` - Current retry attempt\n* ``has_credentials`` - Whether stored credentials exist", "created_at": "", "docname": "21_api/api_wifi_manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "API_STRUCT_WIFI_STATUS", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 331, "links": ["REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Types", "sections": ["Data Types", "WiFi Manager API"], "service": "", "signature": null, "specific": "", "status": "implemented", "style": null, "tags": [], "template": null, "title": "wifi_status_t", "type": "apistruct", "type_name": "API Data Structure", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe configuration manager SHALL define all configuration parameters in a single JSON schema file (config_schema.json) that serves as the authoritative source of truth for parameter definitions, default values, and UI metadata.\n\n**Rationale:**\nSingle source of truth prevents duplication across C code, web forms, and documentation. Schema-driven approach enables code generation for factory defaults and dynamic UI generation.\n\n**Acceptance Criteria:**\n\n- AC-1: JSON schema file SHALL define all user-configurable parameters\n- AC-2: Schema SHALL include parameter type, label, default value, and validation constraints\n- AC-3: Parameters organized in groups for UI section structure\n- AC-4: Schema SHALL be embeddable in flash for browser access\n- AC-5: Schema format SHALL be human-readable and maintainable", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 18, "links": ["REQ_SYS_CFG_1"], "links_back": ["REQ_CFG_JSON_2", "REQ_CFG_JSON_3", "REQ_CFG_JSON_4", "REQ_CFG_JSON_6", "REQ_CFG_JSON_10", "REQ_CFG_JSON_13", "REQ_CFG_JSON_15", "REQ_DSP_2", "SPEC_CFG_JSON_ARCH_1", "SPEC_CFG_JSON_SOURCE_1", "SPEC_CFG_JSON_SCHEMA_1", "SPEC_CFG_JSON_CODEGEN_1", "SPEC_CFG_JSON_EXTEND_1", "SPEC_DSP_ARCH_2", "API_COMP_CONFIG_MANAGER"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Schema Definition", "sections": ["Configuration Schema Definition", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "schema", "architecture"], "template": null, "title": "JSON Schema as Configuration Source of Truth", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_10": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe configuration system SHOULD provide integration points for web-based configuration interfaces.\n\n**Rationale:**\nWeb servers need access to configuration schema and runtime values to provide user interfaces. Config Manager provides the data layer; Web Server provides the HTTP/UI layer.\n\n**Acceptance Criteria:**\n\n- AC-1: Configuration schema file (config_schema.json) SHALL be embeddable in web server\n- AC-2: C API functions (config_get_*, config_set_*) SHALL be callable from web request handlers\n- AC-3: Schema format SHALL support web form generation use cases\n- AC-4: API SHALL return error codes suitable for HTTP status mapping\n\n**Note:**\nDetailed web interface requirements (HTML forms, REST API endpoints, validation) are specified in Web Server Requirements (:need:`REQ_WEB_CONF_1`). This requirement ensures Config Manager provides necessary integration points without knowing HTTP details.", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_10", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 220, "links": ["REQ_SYS_WEB_1", "REQ_CFG_JSON_1", "REQ_CFG_JSON_7"], "links_back": ["SPEC_CFG_JSON_UI_1", "SPEC_WEB_INTEGRATION_CFG_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Web Interface Integration", "sections": ["Web Interface Integration", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "integration"], "template": null, "title": "Web Interface Integration Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_11": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe configuration system SHALL gracefully handle NVS errors and continue operating with default values.\n\n**Rationale:**\nNVS corruption or wear should not prevent system operation.\n\n**Acceptance Criteria:**\n\n- AC-1: NVS read failures SHALL log error and use schema default value\n- AC-2: NVS write failures SHALL log error but not crash application\n- AC-3: System SHALL boot successfully even if NVS namespace is corrupted\n- AC-4: Web interface SHALL indicate NVS error status to user", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_11", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 247, "links": ["REQ_CFG_JSON_6", "REQ_SYS_REL_1"], "links_back": ["REQ_CFG_JSON_12", "SPEC_CFG_JSON_UI_1", "API_COMP_CONFIG_MANAGER"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Error Handling", "sections": ["Error Handling", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "error-handling", "reliability"], "template": null, "title": "NVS Error Graceful Handling", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_12": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nOn first boot, config_init() SHALL initialize NVS with factory defaults from schema if NVS \"config\" namespace is empty or uninitialized.\n\n**Rationale:**\nNew devices need sensible defaults on first boot.\n\n**Acceptance Criteria:**\n\n- AC-1: config_init() SHALL check if NVS \"config\" namespace exists\n- AC-2: If empty, config_init() SHALL call config_factory_reset() to write defaults\n- AC-3: On subsequent boots, config_init() SHALL load values from NVS\n- AC-4: Process SHALL be atomic (no partial updates)", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_12", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 268, "links": ["REQ_CFG_JSON_6", "REQ_CFG_JSON_11"], "links_back": ["SPEC_CFG_JSON_BULK_1", "SPEC_CFG_WEB_ARCH_1", "API_COMP_CONFIG_MANAGER", "API_FUNC_CONFIG_INIT", "API_FUNC_CONFIG_GET_SCHEMA_JSON", "API_FUNC_CONFIG_GET_ALL_AS_JSON"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Error Handling", "sections": ["Error Handling", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "boot"], "template": null, "title": "Configuration Initialization on Boot", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_13": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nAdding new configuration parameters SHALL require modification of only config_schema.json, with C code and web UI auto-updating.\n\n**Rationale:**\nLow friction for extending configuration reduces development time.\n\n**Acceptance Criteria:**\n\n- AC-1: New field added to config_schema.json SHALL appear in web form on next page reload\n- AC-2: Developer SHALL call config_get_xxx(\"key\") in C code matching schema key\n- AC-3: Factory defaults auto-generated from schema (no manual C code needed)\n- AC-4: Documentation SHALL provide step-by-step guide for adding fields", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_13", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 292, "links": ["REQ_CFG_JSON_1"], "links_back": ["SPEC_CFG_JSON_BULK_1", "SPEC_CFG_JSON_EXTEND_1", "SPEC_CFG_WEB_ARCH_1", "API_COMP_CONFIG_MANAGER", "API_FUNC_CONFIG_SET_ALL_FROM_JSON"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Development Guide", "sections": ["Development Guide", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "extensibility", "developer-experience"], "template": null, "title": "Simple Process to Add Configuration Fields", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_14": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe build system SHOULD provide optional pre-build validation script that detects type mismatches between schema and C code.\n\n**Rationale:**\nCatches developer errors early without requiring code generation. Optional to keep build simple.\n\n**Acceptance Criteria:**\n\n- AC-1: Validator script SHALL parse config_schema.json\n- AC-2: Script SHALL search C source files for config_get_xxx(\"key\") calls\n- AC-3: Script SHALL verify function type matches schema type\n- AC-4: Script SHALL output errors for mismatches\n- AC-5: Integration into build pipeline SHALL be optional (can be skipped)", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_14", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 313, "links": ["REQ_CFG_JSON_7"], "links_back": ["SPEC_CFG_JSON_TYPESAFETY_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Development Guide", "sections": ["Development Guide", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "validation", "developer-experience"], "template": null, "title": "Type Safety via Optional Static Validation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_15": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe configuration system MAY support schema versioning and automatic migration of configuration data across firmware updates.\n\n**Rationale:**\nAs firmware evolves, configuration structure may change (new fields, renamed keys, changed types). Schema versioning enables detection and migration of old configurations. However, embedded devices are typically \"programmed out\" thoroughly before production deployment, minimizing schema changes after deployment.\n\n**Acceptance Criteria (if implemented):**\n\n- AC-1: config_schema.json includes \"schema_version\" field\n- AC-2: config_init() detects NVS schema version mismatch\n- AC-3: Migration functions upgrade old config to new schema\n- AC-4: Migration preserves user settings where possible\n- AC-5: Failed migration triggers factory reset with user warning\n\n**Note:** This requirement is marked \"open\" as schema changes are rare in production embedded systems. Hardware constraints typically stabilize configuration structure early in development. For most deployments, factory reset on major firmware updates is acceptable alternative to complex migration logic.", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_15", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 338, "links": ["REQ_CFG_JSON_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Future Enhancements", "sections": ["Future Enhancements", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["config", "versioning", "migration", "future"], "template": null, "title": "Configuration Schema Versioning and Migration", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe configuration schema SHALL support logical grouping of parameters into sections for organization in the web interface.\n\n**Rationale:**\nLogical organization improves usability for configuration with many parameters.\n\n**Acceptance Criteria:**\n\n- AC-1: Each group SHALL have id, label, and description\n- AC-2: Fields SHALL reference group by id\n- AC-3: UI SHALL display fields grouped and ordered as specified in schema\n- AC-4: Each group SHALL be collapsible/expandable (optional UI feature)", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 40, "links": ["REQ_CFG_JSON_1"], "links_back": ["SPEC_CFG_JSON_SCHEMA_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Schema Definition", "sections": ["Configuration Schema Definition", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "ui", "schema"], "template": null, "title": "Parameter Grouping for UI Organization", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe configuration system SHALL support basic parameter types: string, password, integer, boolean, and hidden.\n\n**Rationale:**\nCovers typical IoT configuration needs while remaining simple. Separate types enable appropriate UI widgets and validation.\n\n**Acceptance Criteria:**\n\n- AC-1: String type SHALL support min/max length and regex pattern validation\n- AC-2: Password type SHALL be string type with hidden display in UI\n- AC-3: Integer type SHALL support min/max range and step constraints\n- AC-4: Boolean type SHALL map to checkbox in UI\n- AC-5: Hidden type SHALL not appear in web form (internal config)", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 61, "links": ["REQ_CFG_JSON_1"], "links_back": ["SPEC_CFG_JSON_SCHEMA_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Schema Definition", "sections": ["Configuration Schema Definition", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "types"], "template": null, "title": "Parameter Type System", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_4": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe build system SHALL automatically generate C code to initialize factory default configuration from the JSON schema during build time.\n\n**Rationale:**\nEliminates manual default value maintenance in C code. Generated code is compiled into firmware, ensuring defaults match schema without runtime JSON parsing.\n\n**Acceptance Criteria:**\n\n- AC-1: Python script SHALL parse config_schema.json during build\n- AC-2: Script SHALL generate config_factory_generated.c with config_write_factory_defaults() function\n- AC-3: Generated function SHALL call config_set_xxx() for each schema field with default value\n- AC-4: Build SHALL fail if schema is invalid JSON\n- AC-5: Generated code SHALL be included in firmware compilation", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 86, "links": ["REQ_CFG_JSON_1", "REQ_SYS_CFG_1"], "links_back": ["REQ_CFG_JSON_5", "REQ_CFG_JSON_9", "SPEC_CFG_JSON_CODEGEN_1", "API_COMP_CONFIG_MANAGER", "API_FUNC_CONFIG_WRITE_FACTORY_DEFAULTS"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Generation and Defaults", "sections": ["Configuration Generation and Defaults", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "build", "code-generation"], "template": null, "title": "Build-Time Factory Defaults Generation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_5": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe ESP32 application code SHALL NOT parse JSON at runtime. JSON parsing SHALL occur only at build time (code generation) or in browser (UI).\n\n**Rationale:**\nEliminates runtime overhead and memory overhead of JSON parser on resource-constrained ESP32. Simplifies C code and improves performance.\n\n**Acceptance Criteria:**\n\n- AC-1: C code SHALL NOT include JSON parser library\n- AC-2: NVS access SHALL use direct key-value API (no JSON deserialization)\n- AC-3: Factory reset SHALL call pre-generated config_write_factory_defaults() function\n- AC-4: Runtime memory usage SHALL not include JSON parser structures", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 108, "links": ["REQ_CFG_JSON_4"], "links_back": ["SPEC_CFG_JSON_CODEGEN_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Generation and Defaults", "sections": ["Configuration Generation and Defaults", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "performance", "memory"], "template": null, "title": "No Runtime JSON Parsing in C Code", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_6": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nConfiguration parameters SHALL be stored in NVS using the schema \"key\" field directly as the NVS key.\n\n**Rationale:**\nDirect key usage simplifies storage format and eliminates need for separate UUID system. Keys are human-readable for debugging.\n\n**Acceptance Criteria:**\n\n- AC-1: Each schema field key SHALL be valid NVS key (\u226415 characters)\n- AC-2: NVS storage SHALL use \"config\" namespace for isolation\n- AC-3: Parameter values SHALL be stored individually (not as single blob)\n- AC-4: NVS key SHALL directly match schema field key", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_6", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 132, "links": ["REQ_CFG_JSON_1", "REQ_SYS_CFG_1"], "links_back": ["REQ_CFG_JSON_7", "REQ_CFG_JSON_8", "REQ_CFG_JSON_11", "REQ_CFG_JSON_12", "SPEC_CFG_JSON_ARCH_1", "SPEC_CFG_JSON_STORAGE_1", "SPEC_CFG_JSON_API_1", "API_COMP_CONFIG_MANAGER"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "NVS Storage and Access", "sections": ["NVS Storage and Access", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "storage", "nvs"], "template": null, "title": "Key-Based NVS Storage", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_7": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe configuration manager SHALL provide type-specific getter and setter functions for configuration access.\n\n**Rationale:**\nType-specific functions enforce compile-time type checking via function signature. Different functions for different types prevent accidental type mismatches at call site.\n\n**Acceptance Criteria:**\n\n- AC-1: Getters SHALL be: config_get_string(), config_get_int32(), config_get_int16(), config_get_bool()\n- AC-2: Setters SHALL be: config_set_string(), config_set_int32(), config_set_int16(), config_set_bool()\n- AC-3: All functions SHALL take key as string parameter (matches schema key)\n- AC-4: Functions SHALL return ESP_OK or error code (ESP_ERR_INVALID_ARG, ESP_ERR_NVS_*)\n- AC-5: Caller SHALL use matching function for parameter type in schema", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_7", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 153, "links": ["REQ_CFG_JSON_6"], "links_back": ["REQ_CFG_JSON_10", "REQ_CFG_JSON_14", "REQ_WEB_2", "SPEC_CFG_JSON_API_1", "SPEC_CFG_JSON_TYPESAFETY_1", "API_COMP_CONFIG_MANAGER", "API_FUNC_CONFIG_GET_STRING", "API_FUNC_CONFIG_SET_STRING", "API_FUNC_CONFIG_GET_INT32", "API_FUNC_CONFIG_SET_INT32", "API_FUNC_CONFIG_GET_INT16", "API_FUNC_CONFIG_SET_INT16", "API_FUNC_CONFIG_GET_BOOL", "API_FUNC_CONFIG_SET_BOOL"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "NVS Storage and Access", "sections": ["NVS Storage and Access", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "api", "type-safety"], "template": null, "title": "Type-Safe Configuration API", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_8": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nConfiguration changes SHALL be immediately persisted to NVS on each config_set_xxx() call.\n\n**Rationale:**\nEnsures configuration survives power loss and system resets.\n\n**Acceptance Criteria:**\n\n- AC-1: config_set_xxx() SHALL write to NVS before returning\n- AC-2: Write failures SHALL be logged but not crash system\n- AC-3: Configuration SHALL be reloaded from NVS on next system boot\n- AC-4: NVS corruption SHALL be handled gracefully with defaults", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_8", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 175, "links": ["REQ_CFG_JSON_6"], "links_back": ["SPEC_CFG_JSON_STORAGE_1", "API_COMP_CONFIG_MANAGER"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "NVS Storage and Access", "sections": ["NVS Storage and Access", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "storage", "nvs"], "template": null, "title": "Persistent Configuration Storage", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_JSON_9": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL provide config_factory_reset() function to reset all configuration to schema-defined defaults.\n\n**Rationale:**\nUsers need ability to recover from misconfiguration without firmware rebuild.\n\n**Acceptance Criteria:**\n\n- AC-1: Factory reset SHALL erase all values in \"config\" NVS namespace\n- AC-2: Factory reset SHALL call config_write_factory_defaults() to restore defaults\n- AC-3: Factory reset SHALL return success/error status\n- AC-4: Factory reset errors SHALL be logged", "created_at": "", "docname": "11_requirements/req_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_CFG_JSON_9", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 196, "links": ["REQ_CFG_JSON_4", "REQ_SYS_CFG_1"], "links_back": ["SPEC_CFG_JSON_CODEGEN_1", "API_COMP_CONFIG_MANAGER", "API_FUNC_CONFIG_FACTORY_RESET"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "NVS Storage and Access", "sections": ["NVS Storage and Access", "JSON-Based Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["config", "reset"], "template": null, "title": "Factory Reset Capability", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_DSP_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The display system SHALL utilize WS2812 addressable LED strip hardware through\nthe LED controller component API as an integrated, reactive component. LED count and brightness\nare configurable via configuration management system.\n\n**Rationale:** Establishes the hardware foundation for the visual display system, enabling\nflexible LED strip configurations for different deployment scenarios. The system operates\nreactively, automatically responding to distance measurements rather than external commands.\nDisplay system uses LED controller API for all hardware access, maintaining clear separation\nof concerns.\n\n**Acceptance Criteria:**\n\n- AC-1: Display system uses LED controller component API for all LED hardware access\n- AC-2: LED count and brightness are configurable via configuration management system\n- AC-3: System validates LED count is within reasonable range (1-100 LEDs)\n- AC-4: LED controller component handles all GPIO pin configuration and timing\n- AC-5: Display system depends on LED controller initialization completing successfully\n- AC-6: System operates continuously, updating display in real-time as measurements arrive", "created_at": "", "docname": "11_requirements/req_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_DSP_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 20, "links": ["REQ_LED_1", "REQ_SYS_1"], "links_back": ["REQ_DSP_3", "SPEC_DSP_OVERVIEW_1", "API_COMP_DISPLAY_LOGIC", "API_FUNC_DISPLAY_LOGIC_START"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Overview Requirements", "sections": ["System Overview Requirements", "Display System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "hardware", "integration"], "template": null, "title": "Hardware Platform", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_DSP_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The display system SHALL obtain all operational parameters from the\nconfiguration management system.\n\n**Rationale:** Ensures centralized configuration management and eliminates hardcoded values,\nenabling runtime reconfiguration and consistent system behavior. Parameter validation is\nhandled by the configuration manager. Configuration changes trigger system reset, allowing\nstatic memory allocation at startup with no runtime reallocation - preventing memory\nfragmentation and performance degradation in the embedded environment.\n\n**Acceptance Criteria:**\n\n- AC-1: All display parameters are obtained from configuration manager\n- AC-2: System reads configuration at initialization\n\n**Configuration Parameters:**\n\n- ``led_count``: Number of LEDs in the strip\n- ``led_brightness``: LED brightness level\n- ``dist_min_mm``: Minimum distance threshold (millimeters)\n- ``dist_max_mm``: Maximum distance threshold (millimeters)", "created_at": "", "docname": "11_requirements/req_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_DSP_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 46, "links": ["REQ_CFG_JSON_1", "REQ_SYS_CFG_1"], "links_back": ["REQ_DSP_4", "REQ_DSP_5", "SPEC_DSP_ARCH_2", "API_COMP_DISPLAY_LOGIC", "API_FUNC_DISPLAY_LOGIC_START"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Overview Requirements", "sections": ["System Overview Requirements", "Display System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "configuration", "integration"], "template": null, "title": "Configuration Integration", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_DSP_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The display system SHALL illuminate a single LED in green that represents the current\nmeasured distance with real-time updates. The display system consumes processed distance\nmeasurements from the distance sensor component without additional filtering or smoothing.\n\n**Rationale:** Provides clear, unambiguous visual feedback where users can immediately\nunderstand the current distance measurement through LED position. The distance sensor component\nowns all measurement processing, filtering, and smoothing (REQ_SNS_11); the display system is\nresponsible solely for visual representation of processed measurements, maintaining clear\nseparation of concerns.\n\n**Acceptance Criteria:**\n\n- AC-1: Only one LED is illuminated at any given time\n- AC-2: LED position corresponds to processed distance measurement value from sensor component\n- AC-3: Display updates immediately when new processed measurements arrive from sensor queue\n- AC-4: Display system SHALL NOT apply additional smoothing or filtering to distance measurements\n- AC-5: Display system uses distance measurements directly from sensor component's processed measurement queue", "created_at": "", "docname": "11_requirements/req_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_DSP_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 77, "links": ["REQ_SNS_11", "REQ_DSP_1"], "links_back": ["REQ_DSP_4", "SPEC_DSP_ARCH_1", "SPEC_DSP_ALGO_1", "SPEC_DSP_API_1", "API_COMP_DISPLAY_LOGIC", "API_FUNC_DISPLAY_LOGIC_START"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "User Experience Requirements", "sections": ["User Experience Requirements", "Display System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "ux", "visualization"], "template": null, "title": "Core Visualization Concept", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_DSP_4": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The display system SHALL illuminate the first LED (LED 0) in red when the\nmeasured distance is below the configured minimum distance threshold.\n\n**Rationale:** Red is universally recognized as a warning color. Illuminating the first LED\nin red when too close provides immediate, unmistakable indication of dangerous proximity.\n\n**Acceptance Criteria:**\n\n- AC-1: LED 0 is illuminated red when distance < dist_min_mm\n- AC-2: No green position indicator is shown (measurement invalid)\n- AC-3: Display persists until measurement returns to valid range", "created_at": "", "docname": "11_requirements/req_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_DSP_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 102, "links": ["REQ_DSP_2", "REQ_DSP_3"], "links_back": ["REQ_DSP_5", "SPEC_DSP_ALGO_1", "API_COMP_DISPLAY_LOGIC", "API_FUNC_DISPLAY_LOGIC_START"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "User Experience Requirements", "sections": ["User Experience Requirements", "Display System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "ux", "safety"], "template": null, "title": "Below Minimum Distance Warning", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_DSP_5": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** the display SHALL iluminate the last LED (LED led_count-1) in red when the\nmeasured distance exceeds the configured maximum distance threshold, indicating out-of-range condition.\n\n**Rationale:** Red is universally recognized as an error/warning color. Illuminating the last\nLED in red when too far provides clear indication that the measurement is invalid and out of range.\n\n**Acceptance Criteria:**\n\n- AC-1: last LED (LED led_count-1) is illuminated red when distance > dist_max_mm\n- AC-2: No green position indicator is shown (measurement invalid)\n- AC-3: Display persists until measurement returns to valid range", "created_at": "", "docname": "11_requirements/req_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_DSP_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 121, "links": ["REQ_DSP_2", "REQ_DSP_4"], "links_back": ["SPEC_DSP_ALGO_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "User Experience Requirements", "sections": ["User Experience Requirements", "Display System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "ux", "error-handling"], "template": null, "title": "Out of Range Display", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_LED_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL support WS2812 addressable LED strips for visual distance\ndisplay, providing hardware compatibility and initialization.\n\n**Rationale:** WS2812 LEDs are the chosen hardware for distance visualization; system must\ninterface with this specific LED technology.\n\n**Acceptance Criteria:**\n\n- AC-1: System SHALL initialize WS2812 LED strips connected to configurable GPIO pin\n- AC-2: System SHALL support WS2812 timing and protocol requirements\n- AC-3: LEDs SHALL respond to control signals and display colors\n- AC-4: Initialization SHALL handle hardware configuration parameters\n\n**Verification:** Connect WS2812 strip, verify LEDs respond to basic commands and display\nexpected colors.", "created_at": "", "docname": "11_requirements/req_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_LED_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 19, "links": ["REQ_SYS_1"], "links_back": ["REQ_DSP_1", "REQ_LED_2", "REQ_LED_3", "REQ_STARTUP_1", "SPEC_LED_ARCH_1", "SPEC_LED_TIMING_1", "API_COMP_LED_CONTROLLER", "API_FUNC_LED_CONTROLLER_INIT", "API_FUNC_LED_CONTROLLER_DEINIT", "API_FUNC_LED_CONTROLLER_IS_INITIALIZED", "API_COMP_STARTUP_TESTS"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "LED Controller Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "hardware", "ws2812"], "template": null, "title": "WS2812 LED Strip Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_LED_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide the ability to set the color of individual LED\npixels within the strip for precise distance visualization.\n\n**Rationale:** Distance display requires lighting specific LEDs at calculated positions;\nindividual control is essential for the application.\n\n**Acceptance Criteria:**\n\n- AC-1: System SHALL set specific LED colors by index position\n- AC-2: Color control SHALL support RGB color space with 8-bit resolution per channel\n- AC-3: Individual LED changes SHALL NOT affect other LEDs\n- AC-4: System SHALL provide clear all LEDs functionality\n\n**Verification:** Set individual LEDs to different colors, verify only targeted LEDs change,\ntest clear all functionality.", "created_at": "", "docname": "11_requirements/req_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_LED_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 42, "links": ["REQ_LED_1"], "links_back": ["REQ_LED_4", "REQ_LED_5", "REQ_STARTUP_2", "SPEC_LED_ARCH_2", "SPEC_LED_API_1", "SPEC_LED_API_2", "SPEC_LED_ERR_1", "API_COMP_LED_CONTROLLER", "API_FUNC_LED_CONTROLLER_SET_PIXEL", "API_FUNC_LED_CONTROLLER_CLEAR_PIXEL", "API_FUNC_LED_CONTROLLER_GET_PIXEL", "API_FUNC_LED_CONTROLLER_CLEAR_ALL", "API_FUNC_LED_CONTROLLER_SHOW", "API_COMP_STARTUP_TESTS", "API_FUNC_STARTUP_TESTS_SINGLE_CYCLE", "API_FUNC_STARTUP_TESTS_MULTIPLE_CYCLES", "API_FUNC_STARTUP_TESTS_RAINBOW"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "LED Controller Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "control", "api"], "template": null, "title": "Individual Pixel Control", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_LED_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL support configurable LED strip lengths to accommodate\ndifferent hardware deployments and installation requirements. LED count is a user-configurable\nparameter managed by the configuration system (REQ_CFG_1).\n\n**Rationale:** Different installations may use varying LED strip lengths; system must be\nflexible for deployment scenarios. LED count is a user-facing parameter that affects system\nbehavior and visual representation, therefore it belongs in centralized configuration management.\n\n**Acceptance Criteria:**\n\n- AC-1: LED count SHALL be obtained from centralized configuration system (REQ_CFG_1)\n- AC-2: LED controller SHALL receive LED count during initialization via configuration structure\n- AC-3: System SHALL support LED counts from 1 to at least 100 LEDs\n- AC-4: Configuration system SHALL validate LED count parameters (validation owned by REQ_CFG_6)\n- AC-5: All LED positions within configured count SHALL be controllable\n\n**Verification:** Test with different LED counts, verify all configured LEDs are controllable\nand out-of-range access is prevented.", "created_at": "", "docname": "11_requirements/req_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": true, "has_forbidden_dead_links": true, "header_file": "", "id": "REQ_LED_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 65, "links": ["REQ_LED_1", "REQ_CFG_1"], "links_back": ["SPEC_LED_ARCH_2", "SPEC_LED_MEM_1", "SPEC_LED_ERR_1", "API_COMP_LED_CONTROLLER", "API_FUNC_LED_CONTROLLER_INIT", "API_FUNC_LED_CONTROLLER_SET_PIXEL", "API_FUNC_LED_CONTROLLER_GET_COUNT"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "LED Controller Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "configuration", "flexibility"], "template": null, "title": "Configurable LED Count", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_LED_4": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL display specified RGB colors accurately on WS2812 LEDs for\nreliable visual feedback to users.\n\n**Rationale:** Color accuracy is essential for distance visualization effectiveness; users\nmust be able to distinguish between different states (normal/error conditions).\n\n**Acceptance Criteria:**\n\n- AC-1: Primary colors (red, green, blue) SHALL display distinctly and accurately\n- AC-2: White color SHALL appear as true white without color bias\n- AC-3: Black/off state SHALL turn LEDs completely off\n- AC-4: Color transitions SHALL be immediate when hardware is updated\n\n**Verification:** Display primary colors and verify visual accuracy, test white balance and\noff state, measure color transition timing.", "created_at": "", "docname": "11_requirements/req_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_LED_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 91, "links": ["REQ_LED_2"], "links_back": ["SPEC_LED_API_2", "SPEC_LED_DATA_1", "API_COMP_LED_CONTROLLER", "API_FUNC_LED_CONTROLLER_SHOW", "API_FUNC_LED_CONTROLLER_COLOR_RGB", "API_FUNC_LED_CONTROLLER_COLOR_BRIGHTNESS", "API_STRUCT_LED_COLOR"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "LED Controller Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "quality", "color-accuracy"], "template": null, "title": "Accurate Color Display", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_LED_5": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a thread-safe API to read the current state of all\nLED colors for monitoring and visualization purposes (e.g., web interface LED display).\n\n**Rationale:** External components (web server, monitoring tasks) need to read LED state for\nreal-time visualization without interfering with LED control operations. Thread-safe access\nis critical in multi-task RTOS environment.\n\n**Acceptance Criteria:**\n\n- AC-1: System SHALL provide ``led_get_all_colors()`` function to retrieve snapshot of all LED colors\n- AC-2: Function SHALL return stable snapshot matching last physical LED update (after ``led_show()``)\n- AC-3: Function SHALL be thread-safe using mutex protection\n- AC-4: Function SHALL support partial reads limited by buffer size\n- AC-5: Function SHALL return actual number of LEDs copied or 0 on error\n- AC-6: Caller SHALL provide pre-allocated buffer of sufficient size\n\n**Verification:** Call from multiple tasks concurrently, verify no race conditions, confirm\nreturned colors match physical LED state, test with various buffer sizes.", "created_at": "", "docname": "11_requirements/req_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_LED_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 114, "links": ["REQ_LED_2", "REQ_WEB_1"], "links_back": ["REQ_WEB_LED_1", "SPEC_LED_API_3", "API_COMP_LED_CONTROLLER", "API_FUNC_LED_CONTROLLER_GET_PIXEL", "API_FUNC_LED_CONTROLLER_GET_ALL_COLORS"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "important", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "LED Controller Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "api", "monitoring", "web-interface"], "template": null, "title": "LED State Read API", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a custom network interface driver that bridges ESP32's UART to the host network stack when running in QEMU emulation.\n\n**Rationale:** QEMU does not natively support ESP32 WiFi emulation. A UART tunnel enables network connectivity for testing web server and WiFi-dependent features.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL register as lwIP network interface\n- AC-2: Driver SHALL use UART1 for packet transport to/from QEMU\n- AC-3: Driver SHALL be conditionally compiled only for QEMU target\n- AC-4: Driver SHALL not interfere with real hardware WiFi driver", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 18, "links": ["REQ_SYS_SIM_1"], "links_back": ["REQ_NETIF_TUNNEL_2", "REQ_NETIF_TUNNEL_3", "REQ_NETIF_TUNNEL_4", "REQ_NETIF_TUNNEL_5", "REQ_NETIF_TUNNEL_NF_1", "API_COMP_NETIF_TUNNEL", "API_STRUCT_NETIF_TUNNEL_CONFIG", "API_FUNC_NETIF_TUNNEL_INIT", "API_FUNC_NETIF_TUNNEL_DEINIT", "API_FUNC_NETIF_TUNNEL_GET_HANDLE"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "network", "qemu", "uart"], "template": null, "title": "QEMU UART Network Bridge", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel driver SHALL encapsulate Ethernet frames for transmission over UART with appropriate framing and error detection.\n\n**Rationale:** UART is a byte-stream transport; Ethernet frame boundaries must be preserved.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL frame packets with length prefix or delimiter\n- AC-2: Driver SHALL detect and discard corrupted packets\n- AC-3: Framing SHALL support MTU-sized packets (1500 bytes)\n- AC-4: Framing overhead SHALL be minimal (<10 bytes per packet)", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 37, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": ["REQ_NETIF_TUNNEL_NF_2", "API_COMP_NETIF_TUNNEL"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "protocol"], "template": null, "title": "Packet Encapsulation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The project SHALL provide a Python script that bridges QEMU's UART to the host's TAP network interface.\n\n**Rationale:** QEMU UART output must be forwarded to host network stack for external connectivity.\n\n**Acceptance Criteria:**\n\n- AC-1: Script SHALL create TAP interface on host OS\n- AC-2: Script SHALL forward packets bidirectionally between UART and TAP\n- AC-3: Script SHALL handle QEMU's character device socket protocol\n- AC-4: Script SHALL be executable on Linux and macOS\n- AC-5: Script SHALL provide logging for debugging", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 56, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": ["REQ_NETIF_TUNNEL_DOC_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "tooling", "host"], "template": null, "title": "Host-Side Bridge Script", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_4": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel network interface SHALL support DHCP client operation to obtain IP address from host network.\n\n**Rationale:** Automatic IP configuration simplifies emulation setup and mirrors real WiFi behavior.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL support lwIP DHCP client\n- AC-2: DHCP discovery packets SHALL be forwarded via UART tunnel\n- AC-3: Driver SHALL obtain valid IP address from host DHCP server\n- AC-4: IP configuration SHALL be logged to console", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 76, "links": ["REQ_NETIF_TUNNEL_1", "REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "network", "dhcp"], "template": null, "title": "DHCP Client Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_5": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel driver SHALL be conditionally compiled only when building for QEMU target, with zero overhead on real hardware builds.\n\n**Rationale:** Real hardware uses WiFi driver; tunnel driver is emulation-specific.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL be wrapped in `#ifdef CONFIG_IDF_TARGET_ESP32_QEMU`\n- AC-2: Driver SHALL NOT be linked in hardware builds\n- AC-3: Application code SHALL detect emulation mode at runtime\n- AC-4: Build system SHALL provide clear documentation for enabling QEMU mode", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 95, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": ["API_COMP_NETIF_TUNNEL"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "build"], "template": null, "title": "Conditional Compilation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_DOC_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The project SHALL provide clear documentation for setting up and using QEMU emulation with network tunnel.\n\n**Rationale:** Developers need step-by-step instructions to use emulation features.\n\n**Acceptance Criteria:**\n\n- AC-1: Documentation SHALL include QEMU build/installation instructions\n- AC-2: Documentation SHALL explain TAP interface setup on Linux/macOS\n- AC-3: Documentation SHALL provide example commands for running emulation\n- AC-4: Documentation SHALL describe limitations compared to real hardware", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_DOC_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 156, "links": ["REQ_NETIF_TUNNEL_3", "REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Documentation Requirements", "sections": ["Documentation Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "documentation"], "template": null, "title": "Emulation Setup Documentation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_NF_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The UART tunnel SHOULD support sufficient throughput for web interface testing (minimum 100 KB/s).\n\n**Rationale:** Web page loads and AJAX updates require reasonable bandwidth.\n\n**Acceptance Criteria:**\n\n- AC-1: Tunnel SHALL sustain at least 100 KB/s bidirectional throughput\n- AC-2: Web page loads SHALL complete within 5 seconds over tunnel\n- AC-3: UART baud rate SHALL be configurable (default 921600)", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_NF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 117, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Performance Requirements", "sections": ["Performance Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "performance"], "template": null, "title": "Tunnel Throughput", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_NF_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel driver SHOULD handle UART packet loss gracefully without crashing.\n\n**Rationale:** QEMU's UART emulation may occasionally drop bytes under high load.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL detect framing errors and discard partial packets\n- AC-2: TCP connections SHALL recover from occasional packet loss\n- AC-3: Driver SHALL log packet loss statistics for debugging", "created_at": "", "docname": "11_requirements/req_netif_tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_NETIF_TUNNEL_NF_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 135, "links": ["REQ_NETIF_TUNNEL_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Performance Requirements", "sections": ["Performance Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "reliability"], "template": null, "title": "Packet Loss Handling", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The distance sensor component SHALL provide initialization via\n``distance_sensor_init(const distance_sensor_config_t *config)`` that configures GPIO pins,\ninstalls ISR service, creates internal queues, and establishes default configuration when\nno config is provided.\n\n**Rationale:** Deterministic startup sequence is required for reliable sensor operation and\nsystem integration.\n\n**Acceptance Criteria:**\n\n- AC-1: ``distance_sensor_init(NULL)`` SHALL return ``ESP_OK`` and use default configuration values\n- AC-2: Trigger pin SHALL be configured as GPIO output with no pull-up/pull-down\n- AC-3: Echo pin SHALL be configured as GPIO input with ``GPIO_INTR_ANYEDGE`` interrupt\n- AC-4: GPIO ISR service SHALL be installed successfully\n- AC-5: Raw measurement queue (size 2) and processed measurement queue (size 5) SHALL be created\n- AC-6: Function SHALL return appropriate ``esp_err_t`` codes for error conditions\n\n**Verification:** Code review of GPIO configuration and integration test validating successful\ninitialization with NULL and custom configurations.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 18, "links": ["REQ_SYS_1"], "links_back": ["REQ_SNS_2", "REQ_SNS_3", "REQ_SNS_6", "REQ_SNS_9", "SPEC_SNS_ARCH_2", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_INIT"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "initialization", "gpio"], "template": null, "title": "Component Initialization", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_10": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The sensor component SHALL operate at configurable measurement intervals with\ndeterministic timing characteristics and appropriate timeout handling.\n\n**Rationale:** Predictable measurement timing enables system coordination and proper sensor\noperation.\n\n**Acceptance Criteria:**\n\n- AC-1: Default measurement interval SHALL be 100ms (10Hz rate)\n- AC-2: Measurement interval SHALL be configurable via ``measurement_interval_ms``\n- AC-3: Default echo timeout SHALL be 30ms to accommodate maximum range\n- AC-4: Echo timeout SHALL be configurable via ``timeout_ms``\n- AC-5: Task SHALL yield CPU between measurements using ``vTaskDelay``\n- AC-6: Measurement timing SHALL have \u00b15ms accuracy at 100ms interval\n\n**Verification:** Timing analysis with oscilloscope or logic analyzer measuring actual intervals\nand jitter.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_10", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 242, "links": ["REQ_SNS_2", "REQ_SNS_4"], "links_back": ["SPEC_SNS_TASK_1", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_GET_QUEUE_OVERFLOWS", "API_FUNC_DISTANCE_SENSOR_MONITOR"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "important", "query": "", "rationale": "", "returns": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "performance", "timing"], "template": null, "title": "Timing and Performance", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_11": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Distance calculations SHALL use integer arithmetic with temperature compensation\nto achieve accurate measurements across operational temperature range.\n\n**Rationale:** Measurement accuracy is critical for application functionality; temperature affects\nsound speed significantly.\n\n**Acceptance Criteria:**\n\n- AC-1: Speed of sound calculation SHALL use formula: 331.3 + 0.606 * temperature (m/s)\n- AC-2: Temperature input SHALL be ``temperature_c_x10`` format (200 = 20.0\u00b0C)\n- AC-3: Integer arithmetic SHALL use scaling factor 1,000,000 for precision\n- AC-4: Distance accuracy SHALL be \u00b12mm for distances 20mm-400cm at 20\u00b0C\n- AC-5: EMA smoothing factor SHALL be configurable 0-1000 (1000 = no smoothing)\n- AC-6: First measurement SHALL initialize EMA filter without smoothing\n\n**Verification:** Calibration tests with known distances at various temperatures and EMA filter\nvalidation.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_11", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 267, "links": ["REQ_SNS_4"], "links_back": ["REQ_DSP_3", "SPEC_SNS_ALGO_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "accuracy", "calibration"], "template": null, "title": "Accuracy and Calibration", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_12": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL handle missing echo signals by generating timeout measurements\nwith appropriate status codes when no echo is received within the configured timeout period.\n\n**Rationale:** Missing echoes occur due to signal absorption or reflection angles; system must\ncontinue operation.\n\n**Acceptance Criteria:**\n\n- AC-1: Timeout condition SHALL be detected when no echo received within ``timeout_ms``\n- AC-2: Timeout measurement SHALL have status ``DISTANCE_SENSOR_TIMEOUT``\n- AC-3: Timeout measurement SHALL have distance value 0\n- AC-4: Timeout measurement SHALL include valid timestamp\n- AC-5: System SHALL continue normal operation after timeout\n- AC-6: Timeout events SHALL be logged at warning level\n\n**Verification:** Test with echo pin disconnected or sensor obstruction causing timeouts.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_12", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 295, "links": ["REQ_SNS_3", "REQ_SNS_4"], "links_back": ["SPEC_SNS_ERR_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Error Handling Requirements", "sections": ["Error Handling Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "error-handling", "timeout"], "template": null, "title": "Timeout Error Handling", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_13": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL validate measurement range and flag out-of-range values without\napplying smoothing to preserve error information.\n\n**Rationale:** Out-of-range measurements indicate sensor issues or environmental conditions\nrequiring user attention.\n\n**Acceptance Criteria:**\n\n- AC-1: Measurements < 20mm SHALL be marked ``DISTANCE_SENSOR_OUT_OF_RANGE``\n- AC-2: Measurements > 4000mm SHALL be marked ``DISTANCE_SENSOR_OUT_OF_RANGE``\n- AC-3: Out-of-range measurements SHALL NOT update EMA filter state\n- AC-4: Out-of-range measurements SHALL preserve raw distance value\n- AC-5: Range validation SHALL occur before smoothing filter\n- AC-6: Out-of-range events SHALL be logged at warning level\n\n**Verification:** Unit tests with synthetic timestamps producing out-of-range distances and\nvalidation of status codes.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_13", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 319, "links": ["REQ_SNS_4"], "links_back": ["SPEC_SNS_ERR_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Error Handling Requirements", "sections": ["Error Handling Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "error-handling", "validation"], "template": null, "title": "Range Validation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_14": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL implement drop-oldest policy for processed queue overflow with\nstatistics tracking to handle consumer backpressure without blocking sensor operation.\n\n**Rationale:** Slow consumers should not disrupt sensor measurement timing; overflow indicates\nsystem load issues.\n\n**Acceptance Criteria:**\n\n- AC-1: Processed queue full condition SHALL trigger drop-oldest behavior\n- AC-2: Oldest measurement SHALL be removed before adding new measurement\n- AC-3: Queue overflow counter SHALL increment on each overflow event\n- AC-4: Overflow events SHALL be logged with cumulative count\n- AC-5: Sensor task SHALL never block on processed queue operations\n- AC-6: Raw queue overflow SHALL be prevented by proper task priority\n\n**Verification:** Load testing with slow consumer to force overflows and validate drop-oldest\nbehavior and statistics.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_14", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 344, "links": ["REQ_SNS_4", "REQ_SNS_7"], "links_back": ["SPEC_SNS_ERR_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "important", "query": "", "rationale": "", "returns": "", "section_name": "Error Handling Requirements", "sections": ["Error Handling Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "error-handling", "queue"], "template": null, "title": "Queue Overflow Management", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The sensor task SHALL generate a 10\u00b5s trigger pulse on the configured trigger\nGPIO pin for each measurement cycle to initiate HC-SR04 ultrasonic measurement.\n\n**Rationale:** HC-SR04 datasheet specifies 10\u00b5s trigger pulse requirement for reliable operation.\n\n**Acceptance Criteria:**\n\n- AC-1: Trigger pulse duration SHALL be 10\u00b5s \u00b11\u00b5s\n- AC-2: Trigger pulse SHALL transition from LOW to HIGH to LOW\n- AC-3: Pulse generation SHALL occur at the configured measurement interval\n- AC-4: Pulse generation SHALL use ``esp_rom_delay_us()`` for precise timing\n\n**Verification:** Logic analyzer capture of trigger pin or instrumented test measuring pulse\nwidth and timing accuracy.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 45, "links": ["REQ_SNS_1"], "links_back": ["REQ_SNS_3", "REQ_SNS_10", "SPEC_SNS_ARCH_2", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_START"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "trigger", "timing"], "template": null, "title": "Trigger Pulse Generation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The GPIO ISR SHALL capture rising and falling edge timestamps using\n``esp_timer_get_time()`` with microsecond precision and queue raw timestamp data to the\nsensor task without blocking operations.\n\n**Rationale:** Accurate distance calculation requires precise echo timing; ISR must remain\nminimal for real-time system stability.\n\n**Acceptance Criteria:**\n\n- AC-1: ISR SHALL be marked ``IRAM_ATTR`` for deterministic execution\n- AC-2: Rising edge SHALL capture start timestamp to volatile variable\n- AC-3: Falling edge SHALL capture end timestamp and queue ``distance_raw_measurement_t`` via ``xQueueSendFromISR``\n- AC-4: ISR SHALL NOT perform floating-point operations, heap allocation, or blocking calls\n- AC-5: ISR SHALL use ``portYIELD_FROM_ISR`` when higher priority task awakened\n- AC-6: Raw timestamp data SHALL be queued successfully or measurement marked invalid\n\n**Verification:** Code review for ISR constraints and timing analysis showing ISR execution\ntime < 10\u00b5s.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 67, "links": ["REQ_SNS_1", "REQ_SNS_2"], "links_back": ["REQ_SNS_4", "REQ_SNS_8", "REQ_SNS_12", "SPEC_SNS_ARCH_1", "SPEC_SNS_ISR_1", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_START", "API_STRUCT_DISTANCE_SENSOR_RAW_MEASUREMENT"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "isr", "timing", "real-time"], "template": null, "title": "Real-Time Timestamp Capture", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_4": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The sensor task SHALL calculate distance in millimeters using integer\narithmetic with temperature compensation, validate measurement range (20mm-4000mm), apply\nexponential moving average smoothing for valid measurements, and enqueue processed results.\n\n**Rationale:** Separation of concerns keeps ISR minimal while providing filtered, validated\nmeasurements to consumers.\n\n**Acceptance Criteria:**\n\n- AC-1: Distance calculation SHALL use integer arithmetic with temperature compensation\n- AC-2: Measurements below 20mm or above 4000mm SHALL be marked ``DISTANCE_SENSOR_OUT_OF_RANGE``\n- AC-3: Valid measurements SHALL be processed through EMA filter based on ``smoothing_factor``\n- AC-4: Out-of-range measurements SHALL NOT update EMA filter state\n- AC-5: Processed measurements SHALL include ``distance_mm``, ``timestamp_us``, and ``status`` fields\n- AC-6: Processed measurements SHALL be queued to processed measurement queue\n\n**Verification:** Unit tests with synthetic timestamps validating distance calculations, range\nvalidation, and EMA filter behavior.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 93, "links": ["REQ_SNS_3"], "links_back": ["REQ_SNS_5", "REQ_SNS_7", "REQ_SNS_10", "REQ_SNS_11", "REQ_SNS_12", "REQ_SNS_13", "REQ_SNS_14", "SPEC_SNS_ARCH_1", "SPEC_SNS_TASK_1", "SPEC_SNS_ALGO_2", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_START", "API_STRUCT_DISTANCE_SENSOR_ERROR", "API_STRUCT_DISTANCE_SENSOR_MEASUREMENT"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "processing", "filtering"], "template": null, "title": "Measurement Processing", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_5": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The component SHALL provide ``distance_sensor_get_latest(distance_measurement_t *measurement)``\nthat blocks until the next processed measurement is available, guaranteeing fresh data to consumers.\n\n**Rationale:** Simplified consumer API that eliminates polling overhead and ensures data freshness.\n\n**Acceptance Criteria:**\n\n- AC-1: Function SHALL block with ``portMAX_DELAY`` until processed measurement available\n- AC-2: Function SHALL return ``ESP_OK`` when measurement successfully retrieved\n- AC-3: Function SHALL return ``ESP_ERR_INVALID_ARG`` when measurement pointer is NULL\n- AC-4: Function SHALL copy complete measurement structure to caller's buffer\n- AC-5: Function SHALL be thread-safe for multiple consumers\n\n**Verification:** Integration test with consumer task blocking on API and validating received\nmeasurements.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 119, "links": ["REQ_SNS_4"], "links_back": ["SPEC_SNS_API_1", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_INIT"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "api", "synchronization"], "template": null, "title": "Blocking API Access", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_6": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The component SHALL provide ``distance_sensor_start()`` and ``distance_sensor_stop()``\nfunctions to control sensor task creation and deletion with proper state management.\n\n**Rationale:** Controlled startup and graceful shutdown enable system power management and error\nrecovery.\n\n**Acceptance Criteria:**\n\n- AC-1: ``distance_sensor_start()`` SHALL create sensor task pinned to core 1 with priority 5\n- AC-2: Task SHALL have stack size of 4096 bytes and name \"distance_sensor\"\n- AC-3: ``distance_sensor_stop()`` SHALL delete sensor task and set handle to NULL\n- AC-4: Functions SHALL return appropriate error codes for invalid state transitions\n- AC-5: ``distance_sensor_is_running()`` SHALL reflect actual task state\n\n**Verification:** Unit tests validating task creation, deletion, and state management across\nstart/stop cycles.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_6", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 142, "links": ["REQ_SNS_1"], "links_back": ["SPEC_SNS_TASK_1", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_INIT", "API_FUNC_DISTANCE_SENSOR_GET_QUEUE_OVERFLOWS"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "lifecycle", "freertos"], "template": null, "title": "Task Lifecycle Management", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_7": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The component SHALL provide monitoring capabilities including queue overflow\nmetrics and health status reporting for operational visibility.\n\n**Rationale:** System operators need visibility into sensor health and potential overload conditions.\n\n**Acceptance Criteria:**\n\n- AC-1: ``distance_sensor_get_queue_overflows()`` SHALL return monotonically increasing counter\n- AC-2: ``distance_sensor_monitor()`` SHALL log new overflow events with counts\n- AC-3: ``distance_sensor_has_new_measurement()`` SHALL return queue status without blocking\n- AC-4: Monitoring functions SHALL be callable regardless of task state\n- AC-5: Overflow counter SHALL increment only when processed queue full and oldest dropped\n\n**Verification:** Stress test forcing queue overflows and validating counter behavior and logging\noutput.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_7", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 166, "links": ["REQ_SNS_4"], "links_back": ["REQ_SNS_14", "SPEC_SNS_API_1", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_MONITOR"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "important", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "monitoring", "diagnostics"], "template": null, "title": "Health Monitoring", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_8": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The GPIO ISR SHALL execute within microsecond timeframes and comply with\nreal-time system constraints by avoiding floating-point operations, heap allocations, and\nblocking calls.\n\n**Rationale:** ESP32 real-time stability requires deterministic ISR behavior to prevent system\njitter and timing violations.\n\n**Acceptance Criteria:**\n\n- AC-1: ISR execution time SHALL be < 10\u00b5s in worst case\n- AC-2: ISR SHALL be marked ``IRAM_ATTR`` and reside in instruction RAM\n- AC-3: ISR SHALL NOT use floating-point arithmetic\n- AC-4: ISR SHALL NOT call ``malloc``, ``free``, or heap allocation functions\n- AC-5: ISR SHALL NOT call blocking FreeRTOS functions except ``xQueueSendFromISR``\n- AC-6: ISR stack usage SHALL be < 512 bytes\n\n**Verification:** Static analysis for forbidden operations and timing measurement under maximum\nload conditions.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_8", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 192, "links": ["REQ_SNS_3"], "links_back": ["SPEC_SNS_ARCH_1", "SPEC_SNS_ISR_1", "API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_START", "API_FUNC_DISTANCE_SENSOR_STOP", "API_FUNC_DISTANCE_SENSOR_GET_LATEST", "API_FUNC_DISTANCE_SENSOR_HAS_NEW_MEASUREMENT", "API_FUNC_DISTANCE_SENSOR_IS_RUNNING"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "critical", "query": "", "rationale": "", "returns": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "performance", "real-time", "isr"], "template": null, "title": "Real-Time ISR Constraints", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SNS_9": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The distance sensor component SHALL operate within fixed memory limits using\nsmall queue sizes and bounded stack allocation to fit ESP32 memory constraints.\n\n**Rationale:** ESP32 has limited RAM; component must be memory-efficient while maintaining\nfunctionality.\n\n**Acceptance Criteria:**\n\n- AC-1: Raw measurement queue size SHALL be exactly 2 elements\n- AC-2: Processed measurement queue size SHALL be exactly 5 elements\n- AC-3: Sensor task stack size SHALL be 4096 bytes\n- AC-4: Component SHALL use no dynamic memory allocation after initialization\n- AC-5: Static memory usage SHALL be < 1KB for variables and state\n- AC-6: Queue element sizes SHALL be minimal for required data\n\n**Verification:** Memory usage analysis and heap monitoring during component operation.", "created_at": "", "docname": "11_requirements/req_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SNS_9", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 218, "links": ["REQ_SNS_1"], "links_back": ["API_COMP_DISTANCE_SENSOR", "API_FUNC_DISTANCE_SENSOR_INIT", "API_FUNC_DISTANCE_SENSOR_GET_LATEST"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "important", "query": "", "rationale": "", "returns": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Distance Sensor Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "memory", "resource"], "template": null, "title": "Memory Resource Limits", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_STARTUP_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL initialize the LED controller during startup before\nperforming the visual test sequence.\n\n**Rationale:** LED hardware must be ready before the startup sequence can execute.\n\n**Acceptance Criteria:**\n\n- AC-1: LED controller SHALL be initialized successfully during startup\n- AC-2: System SHALL proceed to visual sequence only after successful LED initialization\n\n**Verification:** Verify LED controller initializes without errors during system startup.", "created_at": "", "docname": "11_requirements/req_startup_test", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_STARTUP_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 19, "links": ["REQ_LED_1", "REQ_SYS_1"], "links_back": ["REQ_STARTUP_2", "SPEC_STARTUP_1", "API_COMP_STARTUP_TESTS"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Startup Test Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["startup", "initialization", "led"], "template": null, "title": "LED Controller Initialization", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_STARTUP_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL display a visual boot sequence by lighting LEDs in\nsequential order from first to last, providing clear indication that the system is\ninitializing and all LEDs are functional.\n\n**Rationale:** Gives users immediate visual feedback that the device is booting properly and\ndemonstrates that all LEDs in the strip are working correctly.\n\n**Acceptance Criteria:**\n\n- AC-1: LEDs SHALL light sequentially from position 0 to position (led_count-1)\n- AC-2: Each LED SHALL display a distinct color during the sequence (e.g., blue or white)\n- AC-3: Test SHALL complete within reasonable time limits (example: 40 LEDs @ 50ms each = 2.0 second maximum)\n- AC-4: Each LED SHALL turn off before the next LED activates (single moving light pattern)\n- AC-5: Normal distance measurement SHALL begin after sequence completes\n\n**Verification:** Observe startup sequence, verify all LEDs activate in order with appropriate\ntiming and visual clarity.", "created_at": "", "docname": "11_requirements/req_startup_test", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_STARTUP_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 38, "links": ["REQ_STARTUP_1", "REQ_LED_2"], "links_back": ["REQ_STARTUP_3", "SPEC_STARTUP_2", "API_COMP_STARTUP_TESTS", "API_FUNC_STARTUP_TESTS_SINGLE_CYCLE", "API_FUNC_STARTUP_TESTS_MULTIPLE_CYCLES"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Startup Test Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["startup", "ux", "validation"], "template": null, "title": "Visual Boot Sequence", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_STARTUP_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The startup test sequence SHALL complete within reasonable time limits to\navoid significantly delaying normal system operation.\n\n**Rationale:** Users expect reasonable boot times; startup test should provide value without\nexcessive delay.\n\n**Acceptance Criteria:**\n\n- AC-1: Complete startup sequence SHALL finish within 5 seconds for 60 LEDs\n- AC-2: LED activation timing SHALL be configurable (default 50ms per LED)\n- AC-3: Total startup delay SHALL not exceed 10 seconds regardless of LED count\n\n**Verification:** Measure startup sequence timing with different LED counts, verify\nperformance meets timing requirements.", "created_at": "", "docname": "11_requirements/req_startup_test", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_STARTUP_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 66, "links": ["REQ_STARTUP_2"], "links_back": ["SPEC_STARTUP_3", "API_COMP_STARTUP_TESTS", "API_FUNC_STARTUP_TESTS_RAINBOW"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "important", "query": "", "rationale": "", "returns": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Startup Test Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["startup", "performance", "timing"], "template": null, "title": "Timing Performance", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL provide a parking assistance solution for garage parking by measuring the distance to the vehicle and providing visual feedback to help the driver park at the optimal position.\n\n**Use Case:**\nA driver pulls into their garage and needs to park at the correct distance from the back wall - not too close (risk of hitting the wall) and not too far (wasting garage space or blocking the garage door). The system continuously measures the distance and displays visual feedback (e.g., via LED indicators or display) to guide the driver to the perfect parking spot.\n\n**Rationale:**\nMany home garages have limited space, and parking too close or too far can be problematic. An automated distance measurement system removes guesswork and enables consistent, safe parking.\n\n**Acceptance Criteria:**\n\n* AC-1: System measures distance from sensor to vehicle continuously\n* AC-2: Visual feedback guides driver during parking approach\n* AC-3: Target parking distance is user-configurable\n* AC-4: System operates reliably in typical garage environments (temperature, lighting)\n* AC-5: Device can be mounted at back wall and positioned to detect approaching vehicle", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 10, "links": [], "links_back": ["REQ_DSP_1", "REQ_SNS_1", "REQ_LED_1", "REQ_STARTUP_1", "SPEC_DSP_ALGO_3"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["system", "parking", "garage"], "template": null, "title": "Garage Parking Assistance System", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_ARCH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL implement modular component-based architecture following ESP-IDF conventions.\n\n**Rationale:**\nEnables maintainability, testability, and reusability.\n\n**Acceptance Criteria:**\n\n* AC-1: Components provide well-defined APIs\n* AC-2: Components are independently testable\n* AC-3: Main application coordinates components without tight coupling", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 107, "links": [], "links_back": ["SPEC_ARCH_LAYERS_1", "SPEC_ARCH_COMM_1", "SPEC_ARCH_TASKS_1", "API_COMP_WEB_SERVER", "API_COMP_WIFI_MGR"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["architecture", "modularity"], "template": null, "title": "Component-based Architecture", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_CFG_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL persist configuration settings across power cycles using ESP32 NVS (Non-Volatile Storage).\n\n**Rationale:**\nMaintains user settings and system configuration permanently.\n\n**Acceptance Criteria:**\n\n* AC-1: Configuration survives device reset and power loss\n* AC-2: Factory reset capability restores default settings\n* AC-3: Configuration corruption detection and recovery", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_CFG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 89, "links": [], "links_back": ["REQ_CFG_JSON_1", "REQ_CFG_JSON_4", "REQ_CFG_JSON_6", "REQ_CFG_JSON_9", "REQ_DSP_2", "REQ_WEB_CONF_1", "SPEC_ARCH_CONFIG_1", "SPEC_ARCH_CONFIG_FLOW_1", "API_COMP_WEB_SERVER", "API_COMP_WIFI_MGR", "API_FUNC_WIFI_SET_CRED", "API_FUNC_WIFI_CLEAR_CRED"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["storage", "nvs", "configuration"], "template": null, "title": "Non-volatile Configuration Storage", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_HW_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL operate on ESP32 microcontroller with 4MB flash memory.\n\n**Rationale:**\nESP32 provides WiFi connectivity, sufficient processing power, and adequate flash memory for IoT applications.\n\n**Acceptance Criteria:**\n\n* AC-1: System boots successfully on ESP32 WROOM-32 or compatible modules\n* AC-2: Flash usage does not exceed 90% of available 4MB\n* AC-3: System operates within ESP32 memory constraints (DRAM/IRAM)", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_HW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 34, "links": [], "links_back": ["SPEC_ARCH_MEMORY_1", "SPEC_ARCH_BUILD_1", "SPEC_ARCH_FLASH_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["hardware", "platform"], "template": null, "title": "ESP32 Hardware Platform", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_NET_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL provide WiFi connectivity in both Access Point (AP) and Station (STA) modes.\n\n**Rationale:**\nEnables web interface access and network configuration flexibility.\n\n**Acceptance Criteria:**\n\n* AC-1: System creates WiFi Access Point for initial configuration\n* AC-2: System connects to existing WiFi networks as station\n* AC-3: Automatic fallback to AP mode if STA connection fails", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_NET_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 52, "links": [], "links_back": ["REQ_NETIF_TUNNEL_4", "REQ_SYS_WEB_1", "REQ_SYS_SIM_2", "REQ_WEB_3", "API_COMP_WEB_SERVER", "API_FUNC_WEB_START", "API_COMP_WIFI_MGR", "API_FUNC_WIFI_INIT", "API_FUNC_WIFI_START", "API_FUNC_WIFI_STOP", "API_FUNC_WIFI_GET_STATUS", "API_FUNC_WIFI_GET_IP", "API_FUNC_WIFI_SWITCH_AP", "API_FUNC_WIFI_MONITOR", "API_STRUCT_WIFI_MODE", "API_STRUCT_WIFI_CRED", "API_STRUCT_WIFI_STATUS"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["network", "wifi"], "template": null, "title": "WiFi Connectivity", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_PERF_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL manage memory efficiently within ESP32 constraints.\n\n**Rationale:**\nPrevents memory leaks and ensures stable operation.\n\n**Acceptance Criteria:**\n\n* AC-1: Heap usage monitored and bounded\n* AC-2: No memory leaks during normal operation\n* AC-3: Stack overflow protection for all tasks\n* AC-4: Dynamic allocation minimized in time-critical paths", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_PERF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 144, "links": [], "links_back": ["SPEC_ARCH_PERF_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["performance", "memory"], "template": null, "title": "Memory Management", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_REL_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL handle errors gracefully and attempt recovery where possible.\n\n**Rationale:**\nEnsures system reliability and user experience.\n\n**Acceptance Criteria:**\n\n* AC-1: Component timeouts handled without system crash\n* AC-2: Network connection failures trigger automatic retry\n* AC-3: System logs errors for diagnostics\n* AC-4: Watchdog timer prevents system hang", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_REL_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 125, "links": [], "links_back": ["REQ_CFG_JSON_11", "SPEC_ARCH_LOGGING_1", "SPEC_ARCH_ERROR_RECOVERY_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["reliability", "error-handling"], "template": null, "title": "Error Handling and Recovery", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_SEC_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system MAY support HTTPS for encrypted web interface communication.\n\n**Rationale:**\nEncrypted communication protects sensitive data (WiFi passwords, configuration) from network eavesdropping. However, embedded certificate management is complex.\n\n**Known Challenges:**\n\n* ESP32 flash constraints for certificate storage\n* Self-signed certificates trigger browser warnings\n* OTA updates complicate certificate lifecycle\n* QEMU emulation does not support HTTPS testing\n* Previous implementation attempts encountered stability issues\n\n**Acceptance Criteria (if implemented):**\n\n* AC-1: Web server supports both HTTP and HTTPS ports\n* AC-2: Self-signed certificate generated at build time or first boot\n* AC-3: Certificate embedded in flash or stored in NVS\n* AC-4: Browser security warnings documented for users\n* AC-5: Certificate renewal process defined for production deployments\n\n**Note:** This requirement is intentionally marked \"open\" due to complexity. For many embedded use cases, physical access security and network isolation provide sufficient protection. Production deployments requiring HTTPS should evaluate alternatives (VPN, mTLS, secure network).", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_SEC_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 208, "links": [], "links_back": ["API_COMP_CERT_HANDLER", "API_FUNC_CERT_HANDLER_INIT", "API_FUNC_CERT_HANDLER_GET_SERVER_CERT", "API_FUNC_CERT_HANDLER_GET_SERVER_KEY", "API_FUNC_CERT_HANDLER_GET_CA_CERT", "API_FUNC_CERT_HANDLER_GET_INFO"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Future Enhancements", "sections": ["Future Enhancements", "System Requirements"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["security", "https", "future"], "template": null, "title": "HTTPS Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_SIM_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL support build-time selectable emulator mode (QEMU) that replaces hardware-specific modules with simulator implementations while preserving public APIs.\n\n**Rationale:**\nEnables development and testing without physical hardware, improves reproducibility and CI test coverage.\n\n**Acceptance Criteria:**\n\n* AC-1: Kconfig option ``CONFIG_TARGET_EMULATOR`` enables emulator builds\n* AC-2: Simulator implementations selected by CMake without requiring code changes\n* AC-3: Simulator components implement complete public API of hardware counterparts\n* AC-4: Emulator build runnable under QEMU with console output\n* AC-5: Documentation provides build/run verification steps", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_SIM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 163, "links": [], "links_back": ["REQ_NETIF_TUNNEL_1", "REQ_NETIF_TUNNEL_DOC_1", "REQ_SYS_SIM_2", "SPEC_SNS_SIM_1", "SPEC_ARCH_NETIF_1", "SPEC_ARCH_QEMU_1", "SPEC_ARCH_QEMU_BUILD_1", "SPEC_ARCH_CODESPACES_1", "SPEC_LED_SIM_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulator", "qemu", "testing"], "template": null, "title": "Emulator Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_SIM_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHOULD provide network connectivity when running in QEMU emulation to enable testing of network-dependent features.\n\n**Rationale:**\nEnables development and testing of web interfaces, WiFi configuration, and network protocols without physical ESP32 hardware.\n\n**Acceptance Criteria:**\n\n* AC-1: UART-based network tunnel bridges QEMU to host network stack\n* AC-2: Web interface accessible from host machine during emulation\n* AC-3: DHCP client obtains IP address in emulation mode\n* AC-4: Network features testable without hardware WiFi module\n* AC-5: Documentation describes emulation network setup and limitations", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_SIM_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 183, "links": ["REQ_SYS_SIM_1", "REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulator", "qemu", "network", "development"], "template": null, "title": "Emulator Network Connectivity", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_TIME_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system MAY support network time synchronization via NTP for accurate timestamps.\n\n**Rationale:**\nAccurate system time enables timestamped logs, scheduled tasks, and time-based security features. Many IoT applications require synchronized time.\n\n**Acceptance Criteria (if implemented):**\n\n* AC-1: NTP client synchronizes with configurable NTP server\n* AC-2: Timezone configuration via web interface\n* AC-3: System time persists across reboots (RTC or NVS)\n* AC-4: Time synchronization status visible in web interface\n* AC-5: Fallback behavior defined if NTP unavailable\n\n**Note:** This requirement is marked \"open\" as template focuses on core functionality. Time synchronization can be added when application requires timestamped events or scheduling.", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_TIME_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 239, "links": [], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Future Enhancements", "sections": ["Future Enhancements", "System Requirements"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["time", "ntp", "future"], "template": null, "title": "System Time and NTP Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_WEB_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL provide web interface for configuration and monitoring.\n\n**Rationale:**\nUser-friendly interface for system setup and operation without firmware recompilation.\n\n**Acceptance Criteria:**\n\n* AC-1: Web interface accessible via HTTP\n* AC-2: Configuration changes applied without firmware recompilation\n* AC-3: Real-time monitoring of system status", "created_at": "", "docname": "11_requirements/req_system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_SYS_WEB_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 70, "links": ["REQ_SYS_NET_1"], "links_back": ["REQ_CFG_JSON_10", "REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_CONF_1", "REQ_WEB_SCHEMA_1", "REQ_WEB_4", "REQ_WEB_5", "REQ_WEB_LED_1", "SPEC_ARCH_WEB_1", "SPEC_ARCH_CERT_1", "SPEC_ARCH_WIFI_1", "SPEC_ARCH_HTTP_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_INIT", "API_COMP_WIFI_MGR"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "configuration"], "template": null, "title": "Web-based Configuration", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a web page that displays current system status with real-time updates for user monitoring.\n\n**Rationale:** Users need to monitor the device's operation remotely via web interface without requiring physical access.\n\n**Acceptance Criteria:**\n\n- AC-1: Main page SHALL display current system status\n- AC-2: Status values SHALL update with reasonable responsiveness\n- AC-3: Page SHALL indicate system state (normal, error, warning)\n- AC-4: Page SHALL be accessible via web browser on mobile and desktop devices", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 18, "links": ["REQ_SYS_WEB_1"], "links_back": ["REQ_LED_5", "REQ_WEB_NF_1", "REQ_WEB_NF_2", "SPEC_WEB_ARCH_1", "SPEC_WEB_STATIC_1", "SPEC_WEB_REST_HEALTH_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_INIT", "API_FUNC_WEB_STATIC_FILE"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "monitoring"], "template": null, "title": "Real-time Status Display", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a web page for configuring device parameters as defined in the configuration management requirements.\n\n**Rationale:** Users need to adjust device settings remotely without firmware recompilation or physical access.\n\n**Acceptance Criteria:**\n\n- AC-1: Settings page SHALL display all user-configurable parameters\n- AC-2: Settings page SHALL validate user input ranges before submission\n- AC-3: Settings page SHALL provide immediate feedback on invalid inputs\n- AC-4: Settings page SHALL confirm successful parameter updates\n- AC-5: Settings page SHALL handle configuration save errors gracefully", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 37, "links": ["REQ_SYS_WEB_1", "REQ_CFG_JSON_7"], "links_back": ["REQ_WEB_NF_1", "REQ_WEB_NF_2", "SPEC_WEB_ARCH_1", "SPEC_WEB_STATIC_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_INIT", "API_FUNC_WEB_STATIC_FILE"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "configuration"], "template": null, "title": "Configuration Interface", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a captive portal WiFi setup page for initial network configuration.\n\n**Rationale:** Users need an intuitive method to configure WiFi credentials without serial console access or hardcoded credentials.\n\n**Acceptance Criteria:**\n\n- AC-1: Device SHALL start in AP mode when WiFi credentials are not configured\n- AC-2: WiFi setup page SHALL display available WiFi networks (SSID scan)\n- AC-3: WiFi setup page SHALL accept SSID and password input\n- AC-4: WiFi credentials SHALL be saved to NVS and validated on next boot\n- AC-5: WiFi setup page SHALL provide feedback on save success/failure\n- AC-6: Device SHALL switch to STA mode after successful WiFi configuration on next boot", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 57, "links": ["REQ_SYS_NET_1"], "links_back": ["REQ_WEB_NF_2", "SPEC_WEB_ARCH_1", "SPEC_WEB_STATIC_1", "SPEC_WEB_REST_WIFI_1", "SPEC_WEB_INTEGRATION_WIFI_1", "SPEC_WEB_CAPTIVE_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_INIT", "API_FUNC_WEB_START", "API_COMP_WIFI_MGR", "API_FUNC_WIFI_INIT", "API_FUNC_WIFI_START", "API_FUNC_WIFI_GET_STATUS", "API_FUNC_WIFI_SET_CRED", "API_FUNC_WIFI_CLEAR_CRED", "API_FUNC_WIFI_SWITCH_AP"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "wifi", "network"], "template": null, "title": "WiFi Setup Interface", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_4": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide navigation between multiple web pages (status, settings, WiFi setup).\n\n**Rationale:** Users need to access different functionality areas without memorizing URLs.\n\n**Acceptance Criteria:**\n\n- AC-1: All pages SHALL include navigation menu or links\n- AC-2: Navigation SHALL clearly indicate current page\n- AC-3: Navigation SHALL be accessible on mobile devices\n- AC-4: Page URLs SHALL be intuitive and RESTful (e.g., `/`, `/settings`, `/wifi`)", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 120, "links": ["REQ_SYS_WEB_1"], "links_back": ["SPEC_WEB_ROUTES_1", "SPEC_WEB_EXTEND_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_INIT", "API_FUNC_WEB_STATIC_FILE"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "navigation"], "template": null, "title": "Web Interface Navigation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_5": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The web server SHALL handle multiple simultaneous HTTP connections without blocking.\n\n**Rationale:** Multiple users or browser tabs may access the device simultaneously.\n\n**Acceptance Criteria:**\n\n- AC-1: Web server SHALL support at least 4 concurrent connections\n- AC-2: Server SHALL respond to new connections within 2 seconds under load\n- AC-3: Server SHALL not crash or hang under concurrent access\n- AC-4: Connection handling SHALL not interfere with real-time system operation", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 139, "links": ["REQ_SYS_WEB_1"], "links_back": ["SPEC_WEB_ROUTES_1", "SPEC_WEB_CONFIG_1", "SPEC_WEB_SECURITY_1", "SPEC_WEB_TEST_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_INIT", "API_FUNC_WEB_STOP", "API_FUNC_WEB_IS_RUNNING", "API_FUNC_WEB_GET_PORT", "API_STRUCT_WEB_CONFIG", "API_COMP_WIFI_MGR"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "performance"], "template": null, "title": "HTTP Server Concurrency", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_CONF_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The web server SHALL provide REST API endpoints for device configuration management.\n\n**Rationale:** Web interface needs standardized API to read and modify device configuration values stored in NVS.\n\n**Acceptance Criteria:**\n\n- AC-1: GET /api/config SHALL return all current configuration values as JSON\n- AC-2: POST /api/config SHALL accept configuration updates as JSON payload\n- AC-3: POST /api/config/reset SHALL trigger factory reset of configuration\n- AC-4: API SHALL integrate with configuration manager component\n- AC-5: API SHALL return appropriate HTTP status codes (200 OK, 400 Bad Request, 500 Internal Server Error)\n- AC-6: Configuration changes SHALL be persisted to NVS immediately\n- AC-7: Device SHALL restart after configuration changes for consistency", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_CONF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 78, "links": ["REQ_SYS_WEB_1", "REQ_SYS_CFG_1"], "links_back": ["REQ_WEB_SCHEMA_1", "SPEC_CFG_WEB_ARCH_1", "SPEC_WEB_ARCH_1", "SPEC_WEB_REST_CFG_1", "SPEC_WEB_INTEGRATION_CFG_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_INIT"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "api", "config"], "template": null, "title": "Configuration REST API", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_LED_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The web server SHALL provide a REST API endpoint to retrieve current LED strip\nstate for real-time visualization in the web interface.\n\n**Rationale:** Users viewing the web interface should see real-time visual representation of\nthe LED strip state, enabling remote monitoring without physical line-of-sight to the device.\n\n**Acceptance Criteria:**\n\n- AC-1: GET /api/led/state SHALL return JSON with LED count and color array\n- AC-2: Response SHALL include all LED colors as hex RGB strings (e.g., \"FF0000\" for red)\n- AC-3: Endpoint SHALL use thread-safe LED state read API (REQ_LED_5)\n- AC-4: Response SHALL set CORS headers for cross-origin access\n- AC-5: Endpoint SHALL return 500 Internal Server Error if LED controller not initialized\n- AC-6: Response time SHALL be under 200ms for 40 LEDs\n- AC-7: Memory SHALL be properly freed after response (no leaks)\n\n**Verification:** Call endpoint from browser, verify JSON format, test with LED animations,\ncheck memory usage over time, verify CORS headers allow cross-origin requests.", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_LED_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 158, "links": ["REQ_SYS_WEB_1", "REQ_LED_5"], "links_back": ["SPEC_WEB_REST_LED_1", "API_COMP_WEB_SERVER"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "important", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "api", "led", "visualization"], "template": null, "title": "LED State API Endpoint", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_NF_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Web pages SHOULD load and render within 3 seconds on typical mobile/desktop browsers.\n\n**Rationale:** Responsive UI improves user experience and reduces perceived latency.\n\n**Acceptance Criteria:**\n\n- AC-1: Initial page load SHALL complete within 3 seconds (excluding network latency)\n- AC-2: Navigation between pages SHALL feel instantaneous (<500ms)\n- AC-3: AJAX updates SHALL not cause page flickering or layout shifts", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_NF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 188, "links": ["REQ_WEB_1", "REQ_WEB_2"], "links_back": ["SPEC_WEB_STATIC_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "performance", "ux"], "template": null, "title": "Web UI Responsiveness", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_NF_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Web interface SHOULD be optimized for mobile devices with responsive design.\n\n**Rationale:** Many users will access the device from smartphones in the field.\n\n**Acceptance Criteria:**\n\n- AC-1: UI SHALL be usable on screens as small as 320px width\n- AC-2: Touch targets SHALL be at least 44x44px for mobile usability\n- AC-3: Text SHALL be readable without zooming on mobile devices", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_NF_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 206, "links": ["REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "mobile"], "template": null, "title": "Mobile-First Design", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_SCHEMA_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The web interface SHOULD dynamically generate configuration forms from schema definition.\n\n**Rationale:** Dynamic generation eliminates manual HTML maintenance and ensures UI stays in sync with configuration structure.\n\n**Acceptance Criteria:**\n\n- AC-1: Web server SHALL serve configuration schema as static file (e.g., /config_schema.json)\n- AC-2: Browser JavaScript SHALL fetch schema and generate form fields dynamically\n- AC-3: Form fields SHALL match parameter types from schema (text, password, number, checkbox)\n- AC-4: Browser SHALL validate inputs based on schema constraints before submission\n- AC-5: Invalid inputs SHALL display clear error messages to user", "created_at": "", "docname": "11_requirements/req_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "REQ_WEB_SCHEMA_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 100, "links": ["REQ_WEB_CONF_1", "REQ_SYS_WEB_1"], "links_back": ["SPEC_WEB_REST_CFG_1", "API_COMP_WEB_SERVER", "API_FUNC_WEB_STATIC_FILE"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "returns": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "config"], "template": null, "title": "Schema-Driven Configuration Form", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_BUILD_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Project uses ESP-IDF CMake build system with component registration.\n\n**Build Structure:**\n\n.. code-block:: cmake\n\n   # Top-level CMakeLists.txt\n   cmake_minimum_required(VERSION 3.16)\n   include($ENV{IDF_PATH}/tools/cmake/project.cmake)\n   project(esp32-template)\n\n   # Component CMakeLists.txt\n   idf_component_register(\n       SRCS \"component.c\"\n       INCLUDE_DIRS \".\"\n       REQUIRES esp_http_server nvs_flash\n   )\n\n**Configuration Files:**\n\n- ``sdkconfig``: ESP-IDF configuration (flash, partition table)\n- ``CMakeLists.txt``: Build definitions\n- ``main/Kconfig.projbuild``: Custom menuconfig options", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_BUILD_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 426, "links": ["REQ_SYS_HW_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Build System Integration", "sections": ["Build System Integration", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["build", "cmake"], "template": null, "title": "ESP-IDF CMake Integration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CERT_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Automated SSL certificate management for HTTPS (work in progress).\n\n**Purpose:** Enable HTTPS for web server without manual certificate management.\n\n**Key Design Decisions:**\n\n- **Build-Time Generation**: Certificates generated during build if missing\n- **Dual Tool Support**: OpenSSL binary (preferred) or Python cryptography fallback\n- **Firmware Embedding**: Uses ESP-IDF ``EMBED_FILES`` feature\n- **Long Validity**: 25-year certificate lifetime for device lifecycle\n\n**Location**: ``main/components/cert_handler/``\n\n**Status**: \ud83d\udea7 Implementation in progress, HTTPS not working in QEMU yet\n\n**Known Limitation**: HTTPS support in QEMU requires additional testing", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_CERT_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 116, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["component", "security"], "template": null, "title": "Certificate Handler Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CODESPACES_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template optimized for zero-setup development in GitHub Codespaces.\n\n**Development Environment:**\n\n- **DevContainer**: Ubuntu 24.04 with ESP-IDF v5.4.1 pre-installed\n- **QEMU**: Integrated emulator for hardware-free testing\n- **VS Code**: Pre-configured extensions (ESP-IDF, C/C++, Python)\n- **Pre-commit Hooks**: Quality gates for documentation\n\n**Workflow:**\n\n.. code-block:: text\n\n   Fork Template \u2192 Open in Codespaces \u2192 Customize main.c \u2192\n   Build \u2192 Test in QEMU \u2192 Flash to Hardware\n\n**Benefits**: Consistent environment, no local setup, works in browser", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_CODESPACES_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 487, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Development Workflow Design", "sections": ["Development Workflow Design", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["development", "devcontainer"], "template": null, "title": "GitHub Codespaces Integration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_COMM_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Components communicate through well-defined APIs and FreeRTOS primitives.\n\n**Communication Patterns:**\n\n.. code-block:: text\n\n   User Application\n        \u2195 (Function calls)\n   Component APIs\n        \u2195 (FreeRTOS primitives)\n   ESP-IDF HAL\n        \u2195 (Hardware registers)\n   Hardware\n\n**Synchronization Mechanisms:**\n\n- **Mutexes**: Protect shared configuration state\n- **Queues**: Producer-consumer data flow between tasks\n- **Event Groups**: Task coordination and signaling\n- **Semaphores**: Resource counting and blocking\n\n**Design Principle**: Components expose clean APIs; internal synchronization is hidden from users", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_COMM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 174, "links": ["REQ_SYS_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["dataflow", "communication"], "template": null, "title": "Component Communication Pattern", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CONFIG_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Example component demonstrating NVS-based configuration patterns.\n\n**Purpose:** Provide reference implementation for persistent configuration management.\n\n**Key Design Decisions:**\n\n- **NVS Storage**: Uses ESP-IDF Non-Volatile Storage API\n- **Runtime Cache**: Configuration cached in RAM for fast access\n- **Validation Framework**: All parameters validated before persistence\n- **Factory Reset**: Recovery mechanism included\n\n**Location**: ``main/components/config_manager/``\n\n**API Pattern**: Getter/setter functions with validation\n\n**See Also**: :doc:`spec_config_manager_json` for detailed design", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_CONFIG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 65, "links": ["REQ_SYS_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["component", "config"], "template": null, "title": "Configuration Manager Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CONFIG_FLOW_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration flows through the system with caching and validation.\n\n**Flow Stages:**\n\n.. code-block:: text\n\n   Boot:      NVS \u2192 config_load() \u2192 Runtime Cache \u2192 Application\n   Runtime:   Application \u2192 config_get() \u2192 Runtime Cache (fast)\n   Update:    Web UI \u2192 Validation \u2192 config_save() \u2192 NVS \u2192 Cache\n   Factory:   Factory Reset \u2192 Defaults \u2192 NVS \u2192 Cache\n\n**Performance Optimization**: Runtime cache enables sub-microsecond config access\n\n**Data Integrity**: All updates validated before NVS write", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_CONFIG_FLOW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 204, "links": ["REQ_SYS_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["dataflow", "config"], "template": null, "title": "Configuration Data Flow", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_ERROR_RECOVERY_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Reset-first error recovery strategy for IoT device reliability.\n\n**Recovery Philosophy:**\n\nSystem uses **reset as primary recovery mechanism** for system-level failures, leveraging fast boot time (~3 seconds) and NVS persistence.\n\n**Error Classification:**\n\n1. **Protocol-Level Errors** \u2192 Handle gracefully\n\n   - TCP packet loss: Let lwIP retry\n   - HTTP timeouts: Return error to client\n   - Transient WiFi drops: Reconnection logic handles\n   - Configuration validation failures: Reject and log\n\n2. **System-Level Errors** \u2192 Reset device\n\n   - WiFi total failure after retries\n   - NVS corruption detection\n   - Critical component initialization failure\n   - Unrecoverable state machine deadlock\n\n**Watchdog Protection:**\n\n- Task watchdog enabled (CONFIG_ESP_TASK_WDT)\n- Prevents infinite loops and deadlocks\n- Automatic reset on watchdog timeout\n\n**Design Rationale:**\n\n- \u2705 Simpler code with fewer state machines\n- \u2705 Fast boot time makes reset acceptable\n- \u2705 NVS survives reset (configuration preserved)\n- \u2705 Reduced attack surface (less recovery code = fewer bugs)\n- \u2705 Deterministic recovery path\n\n**Trade-offs:**\n\n- May lose transient runtime state (acceptable for stateless IoT device)\n- Debugging requires log analysis (logging captures failure context)", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_ERROR_RECOVERY_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 565, "links": ["REQ_SYS_REL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Error Recovery Strategy", "sections": ["Error Recovery Strategy", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["error-handling", "reliability", "reset"], "template": null, "title": "Error Recovery and Reset Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_FLASH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template configured for 4MB flash with optimized partitions.\n\n**Flash Layout:**\n\n- **Flash Size**: 4MB (suitable for most ESP32 modules)\n- **Partition Table**: Single App Large (maximizes app space)\n- **Free Space**: ~41% available for growth\n- **HTTPS Ready**: Sufficient space for SSL certificates\n\n**Partition Layout:**\n\n.. code-block:: text\n\n   Name        Type  Offset   Size\n   nvs         data  0x9000   24K   (config storage)\n   phy_init    data  0xf000   4K    (RF calibration)\n   factory     app   0x10000  ~3.8MB (firmware)\n\n**Verification**: ``idf.py size`` shows memory usage", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_FLASH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 457, "links": ["REQ_SYS_HW_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Build System Integration", "sections": ["Build System Integration", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["flash", "memory"], "template": null, "title": "Flash Memory Configuration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_HTTP_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** HTTP server provides web interface and REST API.\n\n**Server Features:**\n\n- Static file serving from embedded filesystem\n- RESTful API endpoints for configuration\n- Captive portal detection and redirect\n- CORS headers for development\n\n**URL Structure:**\n\n.. code-block:: text\n\n   /                   \u2192 index.html (main page)\n   /settings           \u2192 settings.html (configuration)\n   /wifi-setup         \u2192 wifi-setup.html (captive portal)\n   /api/config         \u2192 REST API (GET/POST)\n   /api/wifi           \u2192 WiFi management API\n\n**Status**: \u2705 HTTP working, \ud83d\udea7 HTTPS in progress", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_HTTP_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 270, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["network", "http", "web"], "template": null, "title": "HTTP Server Architecture Details", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_LAYERS_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system implements a four-layer architecture for clear separation of concerns.\n\n**Architecture Layers:**\n\n.. code-block:: text\n\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502                   User Application Layer                    \u2502\n   \u2502              (main.c - User customizable)                   \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2195\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502              Example Component Library                      \u2502\n   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n   \u2502 config_manager\u2502  web_server  \u2502 cert_handler \u2502 netif_tunnel  \u2502\n   \u2502  - NVS mgmt   \u2502  - HTTP API  \u2502  - SSL certs \u2502  - QEMU net   \u2502\n   \u2502  - Validation \u2502  - WiFi mgr  \u2502  - Auto-gen  \u2502  - UART tun   \u2502\n   \u2502  - Runtime    \u2502  - Captive   \u2502  - Embedding \u2502  - Bridge     \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2195\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502          ESP-IDF Hardware Abstraction Layer                 \u2502\n   \u2502   NVS | HTTP | WiFi | GPIO | FreeRTOS | Netif | TCP/IP     \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2195\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502            ESP32 Hardware / QEMU Emulator                   \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n**Layer Responsibilities:**\n\n1. **User Application Layer**: Entry point (``main.c``), application-specific logic\n2. **Component Library**: Reusable example components (config, web, networking)\n3. **ESP-IDF HAL**: Framework-provided hardware abstraction\n4. **Hardware**: Physical ESP32 or QEMU emulation\n\n**Design Rationale:** Layered architecture enables:\n\n- Independent testing of each layer\n- Component reuse across projects\n- Clear upgrade paths when ESP-IDF updates\n- Hardware/emulator abstraction", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_LAYERS_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 12, "links": ["REQ_SYS_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Overview", "sections": ["Architecture Overview", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["architecture", "layering"], "template": null, "title": "ESP32 Distance Sensor Layered Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_LOGGING_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Consistent logging strategy using ESP-IDF logging framework for diagnostics and debugging.\n\n**Log Levels:**\n\n- **ESP_LOGI**: Normal operational events (initialization, state transitions)\n- **ESP_LOGW**: Recoverable issues (degraded mode, fallback actions)\n- **ESP_LOGE**: Error conditions requiring attention (failed operations)\n- **ESP_LOGD**: Debug information (disabled in production builds)\n\n**Logging Guidelines:**\n\n- **Component TAGs**: Each file defines ``static const char* TAG`` with component name\n- **Error Context**: Always include ``esp_err_to_name()`` for ESP-IDF error codes\n- **Initialization**: Log start and completion of major initialization steps\n- **State Changes**: Log WiFi mode changes, connection events, system transitions\n- **User Actions**: Log web API requests and configuration changes\n\n**Build Configuration:**\n\n- **Production**: INFO level (boot sequence, errors, warnings)\n- **Development**: DEBUG level (detailed operational data)\n- **Configure via menuconfig**: Component config \u2192 Log output \u2192 Default log verbosity\n\n**Performance Consideration:**\n\nLogging is synchronous and blocks the calling task. Avoid logging in time-critical paths (ISRs, high-frequency tasks).\n\n**Example Usage:**\n\n.. code-block:: c\n\n   static const char* TAG = \"wifi_manager\";\n\n   ESP_LOGI(TAG, \"Initializing WiFi manager\");\n   esp_err_t ret = esp_wifi_init(&cfg);\n   if (ret != ESP_OK) {\n       ESP_LOGE(TAG, \"WiFi init failed: %s\", esp_err_to_name(ret));\n       return ret;\n   }", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_LOGGING_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 515, "links": ["REQ_SYS_REL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Logging and Diagnostics", "sections": ["Logging and Diagnostics", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["logging", "diagnostics", "debugging"], "template": null, "title": "Logging and Diagnostics Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_MEMORY_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Memory managed with FreeRTOS heap and ESP-IDF capabilities.\n\n**Allocation Strategy:**\n\n- **Static**: Component structures at compile time (predictable)\n- **Dynamic**: Runtime allocations use ``heap_caps_malloc()``\n- **DMA Buffers**: Use ``MALLOC_CAP_DMA`` capability\n- **IRAM**: Use ``IRAM_ATTR`` only for time-critical ISRs\n\n**Memory Configuration:**\n\n- 4MB flash (CONFIG_ESPTOOLPY_FLASHSIZE_4MB)\n- ~41% free flash after base system\n- Monitor: ``esp_get_free_heap_size()``\n\n**Design Principle**: Prefer static allocation for predictable memory usage", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_MEMORY_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 399, "links": ["REQ_SYS_HW_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Threading Architecture", "sections": ["Threading Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["memory", "performance"], "template": null, "title": "Memory Management Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_NETIF_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** QEMU-specific network bridge enabling full TCP/IP stack in emulation.\n\n**Purpose:** Enable hardware-free development with real network connectivity.\n\n**Key Design Decisions:**\n\n- **UART-Based Tunnel**: Uses UART1 for frame transport\n- **Ethernet Encapsulation**: IP packets wrapped in Ethernet frames\n- **Length-Prefix Protocol**: 2-byte big-endian length header per frame\n- **Python Bridge**: Host-side TUN device management\n- **Conditional Compilation**: Only built for QEMU target\n\n**Architecture:**\n\n.. code-block:: text\n\n   ESP32 lwIP Stack \u2192 UART1 \u2192 Python Bridge \u2192 Host TUN Device\n\n**Location**: ``main/components/netif_uart_tunnel/``\n\n**Performance**: ~10 KB/s throughput (limited by 115200 baud UART)\n\n**See Also**: :doc:`../90_guides/qemu-network-internals` for implementation details", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_NETIF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 140, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["component", "qemu", "network"], "template": null, "title": "Network Tunnel Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_PERF_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template targets reasonable performance for IoT applications.\n\n**Performance Targets:**\n\n- **Boot Time**: < 3 seconds to WiFi connection\n- **Web Response**: < 500ms for configuration API calls\n- **Memory Usage**: < 100KB application heap usage\n- **Task Latency**: < 100ms for application tasks\n\n**Monitoring:**\n\n- Use ESP_LOGI() for timing measurements\n- Monitor heap with esp_get_free_heap_size()\n- Check stack usage with uxTaskGetStackHighWaterMark()\n- Profile with ESP-IDF performance tools", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_PERF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 616, "links": ["REQ_SYS_PERF_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Performance Targets", "sections": ["Performance Targets", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["performance", "requirements"], "template": null, "title": "System Performance Requirements", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_QEMU_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template supports QEMU emulation for hardware-free development.\n\n**Emulation Strategy:**\n\n- **Network Stack**: Full TCP/IP via UART tunnel (not WiFi simulation)\n- **Component Abstraction**: Optional simulator implementations with identical APIs\n- **Build System**: CMake automatically selects hardware vs. simulator components\n- **Clean Code**: No ``#ifdef`` conditionals in application code\n\n**Network Architecture:**\n\n.. code-block:: text\n\n   Browser (Host) \u2192 HTTP Proxy \u2192 TUN Bridge \u2192 QEMU UART1 \u2192 ESP32 lwIP\n\n**Components:**\n\n1. **QEMU Emulator**: ESP32 hardware emulation\n2. **Network Tunnel**: ``netif_uart_tunnel_sim.c`` driver\n3. **TUN Bridge**: ``tools/serial_tun_bridge.py`` (Python)\n4. **HTTP Proxy**: ``tools/http_proxy.py`` for browser access\n\n**Benefits**:\n\n- Fast iteration without hardware flashing\n- CI/CD automation without physical devices\n- GDB debugging with VS Code integration\n- Cross-platform development", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_QEMU_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 301, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "QEMU Emulation Architecture", "sections": ["QEMU Emulation Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["qemu", "emulation"], "template": null, "title": "QEMU Hardware Abstraction", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_QEMU_BUILD_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Build system automatically selects appropriate component implementations.\n\n**Selection Mechanism:**\n\n.. code-block:: cmake\n\n   # Component CMakeLists.txt pattern\n   if(CONFIG_TARGET_EMULATOR)\n       set(COMPONENT_SRCS \"component_sim.c\")\n   else()\n       set(COMPONENT_SRCS \"component.c\")\n   endif()\n\n**Configuration**: ``idf.py menuconfig`` \u2192 \"Build for QEMU emulator\"\n\n**Design Benefits:**\n\n- Same header files for both implementations\n- No code pollution with conditional compilation\n- Easy to add simulator support to any component", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_QEMU_BUILD_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 337, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "QEMU Emulation Architecture", "sections": ["QEMU Emulation Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["qemu", "build"], "template": null, "title": "QEMU Component Selection", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_TASKS_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Application uses FreeRTOS tasks with priority-based scheduling.\n\n**Task Structure:**\n\n.. code-block:: text\n\n   Core 0: Application Tasks (user-defined)\n   \u251c\u2500\u2500 Main Task (Priority 1)\n   \u2502   \u2514\u2500\u2500 Initialization and coordination\n   \u2514\u2500\u2500 User Tasks (Priority varies)\n       \u2514\u2500\u2500 Application-specific logic\n\n   Core 1: WiFi/Network Stack (ESP-IDF managed)\n   \u251c\u2500\u2500 WiFi Management (Priority 2+)\n   \u251c\u2500\u2500 TCP/IP Stack (lwIP)\n   \u2514\u2500\u2500 HTTP Server\n\n**Design Guidelines:**\n\n- Core 0 for application tasks\n- Core 1 reserved for WiFi/network (best performance)\n- Priority range: 0-25 (higher = more important)\n- Monitor stack with ``uxTaskGetStackHighWaterMark()``", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_TASKS_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 368, "links": ["REQ_SYS_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Threading Architecture", "sections": ["Threading Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["threading", "rtos"], "template": null, "title": "FreeRTOS Task Organization", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_WEB_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Example HTTP server with WiFi management and captive portal.\n\n**Purpose:** Provide reference implementation for web-based device configuration.\n\n**Key Design Decisions:**\n\n- **HTTP Server**: ESP-IDF ``esp_http_server`` component\n- **Static Files**: Embedded in firmware using ``EMBED_FILES``\n- **Captive Portal**: DNS server redirects all requests to device\n- **WiFi Manager**: Automatic AP/STA mode switching with NVS credentials\n- **Fallback Logic**: AP mode if STA connection fails\n\n**Location**: ``main/components/web_server/``\n\n**API Pattern**: Initialization function, REST endpoints for configuration\n\n**Status**: \u2705 HTTP working, \ud83d\udea7 HTTPS in progress\n\n**See Also**: Web server requirements in :doc:`../11_requirements/req_web_server`", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_WEB_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 89, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["component", "web", "network"], "template": null, "title": "Web Server Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_WIFI_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** WiFi management with automatic reconnection and AP fallback, including recovery strategy after network loss.\n\n**WiFi Operation Modes:**\n\n1. **Station (STA) Mode**: Connect to existing WiFi network\n2. **Access Point (AP) Mode**: Create configuration network\n3. **Fallback Logic**: Auto-switch to AP if STA fails\n\n**Connection Flow:**\n\n.. code-block:: text\n\n   Boot \u2192 Load NVS Credentials \u2192 STA Connection Attempt\n                                        \u2193 (success)\n                                   STA Connected\n                                        \u2193 (failure after timeout)\n                                   AP Mode + Captive Portal\n                                   (retries STA every 5 min)\n                                        \u2193 (5 min timeout reached)\n                                       Reset & Boot\n\n**AP Mode Failsafe Recovery:**\n\n- **Purpose**: Handle scenarios where network is unavailable after power loss\n- **AP Entry**: System enters AP mode with captive portal when STA connection fails\n- **Retry Strategy**: Attempts to reconnect to configured network every 5 minutes\n- **Recovery Timeout**: After 5 minutes in AP mode without successful STA connection, system performs reset\n- **Rationale**: Prevents indefinite AP mode if network hardware has failed or credentials are invalid; ensures system attempts network recovery periodically\n\n**Credential Management:**\n\n- WiFi SSID/password stored in NVS\n- Factory reset clears credentials\n- Web interface provides credential update\n\n**Status**: \u2705 Complete with NVS integration", "created_at": "", "docname": "12_design/spec_high_level_architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_ARCH_WIFI_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 226, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["network", "wifi"], "template": null, "title": "WiFi Manager Design Details", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_API_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Thin NVS wrapper providing type-safe getters and setters for configuration values.\n\n**Core API:**\n\n.. code-block:: c\n\n   // ====== Lifecycle ======\n   esp_err_t config_init(void);\n   esp_err_t config_factory_reset(void);\n\n   // ====== Type-Safe Getters (read from NVS) ======\n   esp_err_t config_get_string(const char* key, char* buf, size_t len);\n   esp_err_t config_get_int32(const char* key, int32_t* value);\n   esp_err_t config_get_int16(const char* key, int16_t* value);\n   esp_err_t config_get_bool(const char* key, bool* value);\n\n   // ====== Type-Safe Setters (write to NVS) ======\n   esp_err_t config_set_string(const char* key, const char* value);\n   esp_err_t config_set_int32(const char* key, int32_t value);\n   esp_err_t config_set_int16(const char* key, int16_t value);\n   esp_err_t config_set_bool(const char* key, bool value);\n\n   // ====== Generated Function ======\n   void config_write_factory_defaults(void);  // Auto-generated from schema\n\n**Implementation Characteristics:**\n\n- **Simple NVS Wrappers**: Each function ~5-10 lines (minimal overhead)\n- **No JSON Parsing**: Direct NVS access, no runtime deserialization\n- **No Validation Logic**: Server trusts client (browser does validation)\n- **No Domain Knowledge**: Functions never mention WiFi, LEDs, etc.\n- **Type Safety by API**: Compiler enforces correct type via function signature\n\n**Typical Usage:**\n\n.. code-block:: c\n\n   // Read configuration\n   char ssid[33];\n   config_get_string(\"wifi_ssid\", ssid, sizeof(ssid));\n\n   int32_t led_count;\n   config_get_int32(\"led_count\", &led_count);\n\n   // Write configuration\n   config_set_string(\"wifi_ssid\", \"MyNetwork\");\n   config_set_int32(\"led_count\", 120);\n\n**Error Handling:**\n\n.. code-block:: c\n\n   int32_t value;\n   esp_err_t err = config_get_int32(\"led_count\", &value);\n\n   if (err != ESP_OK) {\n       ESP_LOGW(TAG, \"Failed to read led_count: %s\", esp_err_to_name(err));\n       value = 60;  // Use default\n   }\n\n**Design Rationale:**\n\n- **No Validation in C**: Validation happens in browser (simpler code)\n- **Direct Key Access**: Eliminates enum systems, more flexible\n- **Key Duplication Accepted**: Key appears in config_schema.json AND C code\n  (This is intentional: explicit is better than implicit for embedded)", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_API_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 338, "links": ["REQ_CFG_JSON_7", "REQ_CFG_JSON_6"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "NVS Access Layer (Config Manager)", "sections": ["NVS Access Layer (Config Manager)", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["api", "interface", "c-api"], "template": null, "title": "Type-Safe Configuration API", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_ARCH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The configuration system uses a single JSON schema as source of truth with build-time code generation and runtime NVS storage.\n\n**Architecture Layers:**\n\n.. code-block:: text\n\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502          Application Layer                   \u2502\n   \u2502  (main.c, components)                        \u2502\n   \u2502  Uses: config_get_int32(\"led_count\")         \u2502\n   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n   \u2502     Configuration API Layer (NVS wrapper)    \u2502\n   \u2502  (config_manager.c, config_manager.h)        \u2502\n   \u2502  Direct key-based access, no JSON parsing    \u2502\n   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n   \u2502         NVS Storage Layer                    \u2502\n   \u2502  Direct key\u2192value mapping (no complexity)    \u2502\n   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n   \u2502         Metadata (Build-Time)                \u2502\n   \u2502  config_schema.json (source of truth)        \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n**Browser UI Layer (Separate):**\n\n.. code-block:: text\n\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502      Browser Client (JavaScript)             \u2502\n   \u2502  Fetches: /config_schema.json                \u2502\n   \u2502  Generates: Form UI dynamically              \u2502\n   \u2502  Validates: Client-side (min/max/pattern)    \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n**Key Design Principle:** C code does NOT parse JSON at runtime. JSON is embedded as static file for browser only.\n\n**Layer Responsibilities:**\n\n- **Application Layer**: Consumes configuration via simple API (config_get_xxx/config_set_xxx)\n- **Config Manager**: Thin NVS wrapper, type-safe getters/setters, no validation logic\n- **NVS Layer**: Simple key-value storage, no complex structures\n- **JSON Schema**: Defines structure, defaults, UI labels, validation rules (build/browser only)", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 12, "links": ["REQ_CFG_JSON_1", "REQ_CFG_JSON_6"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Overview", "sections": ["Architecture Overview", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["architecture", "config", "json-schema"], "template": null, "title": "JSON Schema-Driven Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_BULK_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration manager provides bulk JSON operations for efficient configuration management. These functions process all configuration fields in atomic operations.\n\n**Design Principle:** Bulk JSON API is the primary interface for multi-field configuration operations. Individual field access remains available for specific use cases.\n\n**Function 1: Schema Access**\n\n.. code-block:: c\n\n   /**\n    * @brief Get embedded JSON schema for dynamic UI generation\n    * @param[out] schema_json Pointer to embedded schema string (no free() needed)\n    * @return ESP_OK on success, ESP_ERR_NOT_FOUND if schema not embedded\n    */\n   esp_err_t config_get_schema_json(char **schema_json);\n\n**Function 2: Bulk Configuration Read**\n\n.. code-block:: c\n\n   /**\n    * @brief Read all configuration values as structured JSON array\n    * @param[out] config_json Allocated JSON string (caller must free())\n    * @return ESP_OK on success, ESP_ERR_NO_MEM on allocation failure\n    */\n   esp_err_t config_get_all_as_json(char **config_json);\n\n**Implementation Strategy:**\n- Read JSON schema to enumerate all defined fields\n- For each field, call appropriate ``config_get_*()`` function based on schema type\n- Build JSON array with {key, type, value} objects for all current values\n- Handle password masking (never expose sensitive fields)\n\n**Function 3: Bulk Configuration Write**\n\n.. code-block:: c\n\n   /**\n    * @brief Update configuration from structured JSON array\n    * @param[in] config_json JSON array with {key, type, value} objects\n    * @return ESP_OK on success, ESP_ERR_INVALID_ARG on validation failure\n    */\n   esp_err_t config_set_all_from_json(const char *config_json);\n\n**Implementation Strategy:**\n- Parse input JSON array to extract {key, type, value} objects\n- For each object, validate ``key`` exists in schema and ``type`` matches\n- Call appropriate ``config_set_*_no_commit()`` function based on ``type``\n- Single ``config_commit()`` call for atomic update\n- Return error if any field validation fails\n\n**Error Handling:**\n- Unknown ``key`` fields: ignored (forward compatibility)\n- Invalid ``type`` values: return ESP_ERR_INVALID_ARG\n- Type mismatch (``type`` vs schema): return ESP_ERR_INVALID_ARG\n- Range violations: return ESP_ERR_INVALID_ARG\n- NVS errors: propagate ESP_ERR_NVS_* codes\n- Malformed JSON: return ESP_ERR_INVALID_ARG\n\n**JSON Format Example:**\n\n.. code-block:: json\n\n   [\n     {\n       \"key\": \"wifi_ssid\",\n       \"type\": \"string\",\n       \"value\": \"MyNetwork\"\n     },\n     {\n       \"key\": \"wifi_pass\",\n       \"type\": \"string\",\n       \"value\": \"password123\"\n     },\n     {\n       \"key\": \"ap_ssid\",\n       \"type\": \"string\",\n       \"value\": \"MyDevice-AP\"\n     },\n     {\n       \"key\": \"led_count\",\n       \"type\": \"integer\",\n       \"value\": 50\n     },\n     {\n       \"key\": \"led_bright\",\n       \"type\": \"integer\",\n       \"value\": 128\n     },\n     {\n       \"key\": \"device_name\",\n       \"type\": \"string\",\n       \"value\": \"MyDevice\"\n     }\n   ]\n\n**Design Properties:**\n- **No hardcoded fields** in any client component\n- **Schema-driven completeness** (all fields included automatically)\n- **Future-proof** (new schema fields work without client changes)\n- **Atomic updates** (all changes committed together)\n- **Type safety** (schema validates types before NVS storage)\n\n**Primary Use Cases:**\n- Web server HTTP endpoints: Use bulk APIs for GET/POST operations\n- Factory reset: Load default values with ``config_set_all_from_json()``\n- Configuration export/import: System backup and restore\n- CLI commands: Batch configuration from command line\n- Remote management: Configuration updates from network protocols", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_BULK_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 492, "links": ["REQ_CFG_JSON_12", "REQ_CFG_JSON_13"], "links_back": ["SPEC_CFG_WEB_FLOW_1", "SPEC_CFG_WEB_MAPPING_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Web Interface Design", "sections": ["Web Interface Design", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["api", "json", "bulk-operations"], "template": null, "title": "Bulk JSON Configuration API", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_CODEGEN_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Factory reset uses the bulk JSON configuration system for consistent data processing and validation.\n\n**JSON-Based Factory Reset Architecture:**\n\n.. code-block:: text\n\n   config_schema.json\n         \u2502\n         \u2514\u2500\u2500\u2192 tools/generate_config_factory.py (Python 3)\n              \u2502\n              \u2514\u2500\u2500\u2192 config_factory_generated.c (auto-generated, compiled)\n\n                   const char* config_factory_defaults_json =\n                   \"[\"\n                   \"  {\\\"key\\\":\\\"wifi_ssid\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"\\\"},\"\n                   \"  {\\\"key\\\":\\\"wifi_pass\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"\\\"},\"\n                   \"  {\\\"key\\\":\\\"ap_ssid\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"ESP32-Setup\\\"},\"\n                   \"  {\\\"key\\\":\\\"led_count\\\",\\\"type\\\":\\\"integer\\\",\\\"value\\\":50}\"\n                   \"]\";\n\n                   esp_err_t config_write_factory_defaults(void) {\n                       return config_set_all_from_json(config_factory_defaults_json);\n                   }\n\n**Generator Script (Simplified):**\n\n.. code-block:: python\n\n   #!/usr/bin/env python3\n   import json\n   import sys\n\n   def generate_factory_json(schema_file, output_file):\n       with open(schema_file) as f:\n           schema = json.load(f)\n\n       # Build factory defaults JSON array with {key, type, value} structure\n       defaults_array = []\n       for field in schema['fields']:\n           defaults_array.append({\n               'key': field['key'],\n               'type': field['type'],\n               'value': field['default']\n           })\n\n       factory_json = json.dumps(defaults_array, separators=(',', ':'))\n\n       with open(output_file, 'w') as f:\n           f.write('// Auto-generated - DO NOT EDIT\\n')\n           f.write('#include \"config_manager.h\"\\n\\n')\n           f.write(f'const char* config_factory_defaults_json = \"{factory_json}\";\\n\\n')\n           f.write('esp_err_t config_write_factory_defaults(void) {\\n')\n           f.write('    return config_set_all_from_json(config_factory_defaults_json);\\n')\n           f.write('}\\n')\n\n   if __name__ == '__main__':\n       generate_factory_json(sys.argv[1], sys.argv[2])\n\n**CMake Integration:** (unchanged)\n\n.. code-block:: cmake\n\n   # Generate factory defaults from schema\n   add_custom_command(\n       OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/config_factory_generated.c\n       COMMAND python3 ${CMAKE_CURRENT_SOURCE_DIR}/tools/generate_config_factory.py\n               ${CMAKE_CURRENT_SOURCE_DIR}/config_schema.json\n               ${CMAKE_CURRENT_BINARY_DIR}/config_factory_generated.c\n       DEPENDS config_schema.json tools/generate_config_factory.py\n       COMMENT \"Generating factory config defaults from schema\"\n   )\n\n   idf_component_register(\n       SRCS \"config_manager.c\"\n            \"${CMAKE_CURRENT_BINARY_DIR}/config_factory_generated.c\"\n       INCLUDE_DIRS \"include\"\n       EMBED_FILES \"config_schema.json\"\n   )\n\n**Key Design Properties:**\n\n- **Consistent API**: Factory reset uses same ``config_set_all_from_json()`` function\n- **Schema-Driven**: Generator reads schema to create structured JSON array\n- **Build-Time Generation**: Factory defaults compiled into firmware\n- **Atomic Operation**: All defaults applied in single transaction", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_CODEGEN_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 189, "links": ["REQ_CFG_JSON_1", "REQ_CFG_JSON_4", "REQ_CFG_JSON_5", "REQ_CFG_JSON_9"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Structure Design", "sections": ["Data Structure Design", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["build-process", "code-generation", "factory-reset"], "template": null, "title": "Factory Reset via Bulk JSON Update", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_EXTEND_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Simple process for adding new configuration fields to schema.\n\n**Step-by-Step Guide:**\n\n**1. Define in config_schema.json:**\n\n.. code-block:: json\n\n   {\n     \"key\": \"my_setting\",\n     \"type\": \"integer\",\n     \"label\": \"My Custom Setting\",\n     \"description\": \"This is what my setting does\",\n     \"default\": 100,\n     \"min\": 1,\n     \"max\": 1000,\n     \"step\": 10,\n     \"group\": \"application\",\n     \"order\": 1\n   }\n\n**2. Use in Application Code:**\n\n.. code-block:: c\n\n   #include \"config_manager.h\"\n\n   int32_t my_setting;\n   esp_err_t err = config_get_int32(\"my_setting\", &my_setting);\n\n   if (err != ESP_OK) {\n       ESP_LOGW(TAG, \"Failed to read my_setting: %s\", esp_err_to_name(err));\n       my_setting = 100;  // Fallback to default\n   }\n\n   // Use my_setting...\n\n**3. Web UI Auto-Updates:**\n\n- Reload settings page\n- New field appears automatically with validation rules\n- Label and description shown from schema\n\n**Key Naming Rules:**\n\n- Use `snake_case` (matches C naming conventions)\n- \u226415 characters (NVS key length limit)\n- Avoid special characters except underscore\n- Make names descriptive (\"led_count\" better than \"lc\")", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_EXTEND_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 611, "links": ["REQ_CFG_JSON_1", "REQ_CFG_JSON_13"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Best Practices & Development Guide", "sections": ["Best Practices & Development Guide", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["development", "guide", "extensibility"], "template": null, "title": "Adding New Configuration Fields", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_SCHEMA_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** JSON schema defines all configuration fields with metadata for type-safety and UI generation.\n\n**Schema File Location:** `main/components/config_manager/config_schema.json`\n\n**Schema Structure:**\n\n.. code-block:: json\n\n   {\n     \"schema_version\": \"1.0\",\n     \"config_namespace\": \"esp32_app\",\n     \"groups\": [\n       {\n         \"id\": \"wifi\",\n         \"label\": \"\ud83d\udcf6 WiFi Settings\",\n         \"description\": \"Network configuration\",\n         \"order\": 1\n       }\n     ],\n     \"fields\": [\n       {\n         \"key\": \"wifi_ssid\",\n         \"type\": \"string\",\n         \"label\": \"WiFi SSID\",\n         \"default\": \"\",\n         \"required\": true,\n         \"maxLength\": 32,\n         \"pattern\": \"^[^\\\\x00]{1,32}$\",\n         \"group\": \"wifi\",\n         \"order\": 1\n       }\n     ]\n   }\n\n**Schema Elements:**\n\n- **schema_version**: Version for future compatibility\n- **config_namespace**: NVS namespace name\n- **groups**: UI section grouping (order matters)\n- **fields**: Individual configuration parameters\n\n**Field Properties:**\n\n============================== ======== =========================================================================\nProperty                       Type     Purpose\n============================== ======== =========================================================================\n`key`                          string   NVS key name (\u226415 chars), used directly: config_get(\"key\")\n`type`                         enum     One of: \"string\", \"password\", \"integer\", \"boolean\", \"hidden\"\n`label`                        string   Human-readable label for UI\n`default`                      mixed    Default value if NVS not initialized\n`required`                     bool     If true, must have a value\n`group`                        string   Associates field with a group (from groups.id)\n`order`                        int      Display order (within group, lower = first)\n`minLength` / `maxLength`      int      (string/password) Length constraints\n`min` / `max`                  int      (integer) Range constraints\n`step`                         int      (integer) UI increment step\n`pattern`                      regex    (string/password) Validation regex (browser-only)\n============================== ======== =========================================================================\n\n**Type Mapping to C API:**\n\n.. code-block:: c\n\n   // Browser forms generated based on type\n   \"string\"   \u2192 <input type=\"text\">\n   \"password\" \u2192 <input type=\"password\">\n   \"integer\"  \u2192 <input type=\"number\">\n   \"boolean\"  \u2192 <input type=\"checkbox\">\n   \"hidden\"   \u2192 <input type=\"hidden\">\n\n   // C code uses matching getters\n   \"string\" / \"password\"  \u2192 config_get_string(key, buf, len)\n   \"integer\"             \u2192 config_get_int32(key, &value) or config_get_int16(key, &value)\n   \"boolean\"             \u2192 config_get_bool(key, &value)\n   \"hidden\"              \u2192 config_get_string(key, buf, len)  (internal config)\n\n**Design Rationale:**\n\n- **Direct Key Usage**: Using key directly as NVS key eliminates separate UUIDs (saves flash)\n- **Flat Attributes**: No nested validation objects (simpler JSON, smaller file)\n- **Type Defines Input**: Single type field eliminates redundant inputType property\n- **Groups for Organization**: Sections on settings page without separate metadata structure\n- **Order Field**: Ensures predictable UI layout (JSON object order not guaranteed)", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_SCHEMA_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 98, "links": ["REQ_CFG_JSON_1", "REQ_CFG_JSON_2", "REQ_CFG_JSON_3"], "links_back": ["SPEC_CFG_WEB_FORM_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Structure Design", "sections": ["Data Structure Design", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["data-structure", "schema"], "template": null, "title": "Configuration Schema Structure", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_SOURCE_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration schema defined once in JSON, used for multiple purposes without duplication.\n\n**Single Source of Truth Model:**\n\n.. code-block:: text\n\n   config_schema.json (ONLY definition)\n         \u2502\n         \u251c\u2500\u2500\u2192 C Code (config_factory_generated.c)\n         \u2502    Generates: config_write_factory_defaults() function\n         \u2502    Purpose: Initialize NVS with defaults at build-time\n         \u2502    When: Build-time Python script (no runtime parsing)\n         \u2502\n         \u251c\u2500\u2500\u2192 Browser (fetched at runtime)\n         \u2502    Fetches: GET /config_schema.json\n         \u2502    Purpose: Generate form, validate inputs\n         \u2502    When: User loads settings page\n         \u2502\n         \u2514\u2500\u2500\u2192 Documentation/Reference\n              Developers read schema to understand config fields\n\n**Benefits:**\n\n1. **No Duplication**: Update schema once, form auto-updates, defaults auto-generated\n2. **Type Safety**: C code validates types match schema (optional validator script)\n3. **Self-Documenting**: Schema contains labels, descriptions, validation rules\n4. **Zero Runtime Overhead**: JSON parsing happens at build-time only, not on ESP32", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_SOURCE_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 61, "links": ["REQ_CFG_JSON_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Overview", "sections": ["Architecture Overview", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["architecture", "schema", "design-pattern"], "template": null, "title": "JSON Schema as Single Source of Truth", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_STORAGE_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration parameters stored in NVS using schema keys directly.\n\n**Storage Strategy:**\n\n.. code-block:: c\n\n   // NVS namespace: \"config\"\n   // NVS keys: schema \"key\" fields (\u226415 chars required)\n\n   config_schema.json:\n   {\n     \"key\": \"wifi_ssid\",\n     \"default\": \"ESP32-AP\"\n   }\n\n   Stored in NVS as:\n   nvs_set_str(handle, \"wifi_ssid\", \"ESP32-AP\");\n\n   Retrieved with:\n   char ssid[33];\n   nvs_get_str(handle, \"wifi_ssid\", ssid, sizeof(ssid));\n\n**Key Properties:**\n\n- **Direct Keys**: NVS key = schema \"key\" field (no transformation)\n- **Key Length**: Must be \u226415 characters (ESP-IDF NVS constraint)\n- **Type-Specific Storage**: Uses correct NVS function (nvs_set_str, nvs_set_i32, etc.)\n- **Namespace Isolation**: All config in \"config\" namespace, separate from other NVS users\n- **Simple Structure**: No metadata stored, only values\n\n**Example NVS Content:**\n\n.. code-block:: text\n\n   Namespace: config\n   \u251c\u2500 \"wifi_ssid\"      \u2192 \"ESP32-AP\" (string)\n   \u251c\u2500 \"wifi_password\"  \u2192 \"\" (string)\n   \u251c\u2500 \"led_count\"      \u2192 60 (integer)\n   \u2514\u2500 \"ap_channel\"     \u2192 1 (integer)\n\n**Design Rationale:**\n\n- **No UUID System**: Using meaningful keys directly is simpler and readable\n- **Minimal Overhead**: NVS overhead minimized with short, direct keys\n- **Easy Debugging**: Readable keys vs. UUID system", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_STORAGE_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 282, "links": ["REQ_CFG_JSON_6", "REQ_CFG_JSON_8"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Structure Design", "sections": ["Data Structure Design", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["storage", "nvs"], "template": null, "title": "NVS Storage Format", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_TYPESAFETY_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Achieving type safety through API design and optional validation rather than mandatory code generation.\n\n**Type Safety Mechanisms:**\n\n1. **API Signature Type Safety:**\n\n.. code-block:: c\n\n   // Compiler enforces types at call site\n   int32_t count;\n   config_get_int32(\"led_count\", &count);  // \u2705 Correct: matches schema type\n\n   char* str;\n   config_get_int32(\"wifi_ssid\", (int32_t*)str);  // \u274c Logical error (caught by developer testing)\n\n2. **Schema Documents Correct Type:**\n\n.. code-block:: json\n\n   {\"key\": \"led_count\", \"type\": \"integer\"}   \u2192 Use config_get_int32()\n   {\"key\": \"wifi_ssid\", \"type\": \"string\"}    \u2192 Use config_get_string()\n\n3. **Optional: Static Validator Script (Nice-to-Have):**\n\n.. code-block:: python\n\n   # Pre-build validation (not required)\n   python3 tools/validate_config_schema.py\n\n   # Finds type mismatches in code:\n   # ERROR: src/main.c:42 - config_get_int32(\"wifi_ssid\"):\n   #        schema says type=\"string\", not integer\n\n**When Type Mismatches Happen:**\n\n- \u274c If schema says `\"string\"` but code calls `config_get_int32()`:\n  - Result: Reads binary garbage as integer\n  - Discovery: Runtime error during testing (type mismatch obvious)\n  - Recovery: Trivial fix (change one line in C code)\n\n**For Templates, This is Acceptable:**\n\n- Small number of config fields (5-10 typically)\n- Type errors obvious after one test run\n- No runtime overhead of validation\n- Code remains simple and understandable\n\n**When Additional Safety is Needed:**\n\n- Projects with 20+ config fields\n- Pre-commit validator script (optional)\n- Or: Use code generation approach (separate branch/option)\n\n**Design Philosophy:**\n\n- **Explicit > Implicit**: Keys appear in both JSON and C code (obvious when they match)\n- **Simple > Magic**: No hidden code generation unless chosen\n- **Learnable > Complex**: Beginners can understand entire system quickly", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_TYPESAFETY_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 668, "links": ["REQ_CFG_JSON_7", "REQ_CFG_JSON_14"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Best Practices & Development Guide", "sections": ["Best Practices & Development Guide", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["type-safety", "best-practices"], "template": null, "title": "Type Safety Without Code Generation", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_JSON_UI_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Browser fetches config_schema.json and generates settings form dynamically.\n\n**Form Generation Flow:**\n\n.. code-block:: text\n\n   Browser loads /settings.html\n         \u2502\n         \u2514\u2500\u2500\u2192 JavaScript: fetch('/config_schema.json')\n              \u2502\n              \u2514\u2500\u2500\u2192 Parse schema, create groups\n                   \u2502\n                   \u2514\u2500\u2500\u2192 For each field:\n                        \u251c\u2500 Create input element (type-specific)\n                        \u251c\u2500 Apply validation attributes (min/max/pattern)\n                        \u251c\u2500 Set label, description\n                        \u2514\u2500 Add to corresponding group div\n\n**Browser-Side Validation:**\n\n.. code-block:: javascript\n\n   function generateFormFromSchema(schema) {\n       for (const group of schema.groups) {\n           const groupDiv = createGroupDiv(group);\n\n           for (const field of schema.fields) {\n               if (field.group === group.id) {\n                   // Create input based on field type\n                   const input = createInputElement(field);\n\n                   // Apply validation attributes\n                   if (field.type === 'integer') {\n                       input.min = field.min;\n                       input.max = field.max;\n                       input.step = field.step || 1;\n                   }\n\n                   if (field.type === 'string' || field.type === 'password') {\n                       input.minLength = field.minLength;\n                       input.maxLength = field.maxLength;\n                       input.pattern = field.pattern;\n                   }\n\n                   // Add to form\n                   groupDiv.appendChild(createFormGroup(field, input));\n               }\n           }\n\n           document.getElementById('settings').appendChild(groupDiv);\n       }\n   }\n\n**Validation Rules:**\n\n============  ====================  ==========================\nField Type    Browser Validation    Server Trust?\n============  ====================  ==========================\nstring        maxLength, pattern    Yes (no re-validation)\npassword      minLength, maxLength  Yes\ninteger       min, max, step        Yes\nboolean       HTML5 checkbox        Yes\n============  ====================  ==========================\n\n**Design Rationale:**\n\n- **Browser-Only Validation**: Simple approach for template (no server-side re-validation)\n- **Self-Updating UI**: No need to hardcode form HTML, schema drives generation\n- **Validation Rules as Schema**: Constraints visible in one place", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_UI_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 415, "links": ["REQ_CFG_JSON_10", "REQ_CFG_JSON_11"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Web Interface Design", "sections": ["Web Interface Design", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "javascript"], "template": null, "title": "JSON Schema for UI Generation", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_ARCH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Overview:**\nThe configuration webpage is a single-page JavaScript application that dynamically generates configuration forms from JSON schema and manages all configuration operations through RESTful bulk APIs.\n\n**Architecture Layers:**\n\n1. **Schema Processing Layer**:\n   - Fetch JSON schema from ``GET /api/config/schema``\n   - Parse schema field definitions (key, type, label, description, validation)\n   - Cache schema for form generation and validation\n\n2. **Form Generation Layer**:\n   - Dynamic HTML form element creation based on schema types\n   - Input type mapping (string \u2192 text, integer \u2192 number, boolean \u2192 checkbox)\n   - Validation attribute generation (min, max, pattern, required)\n   - Label and description rendering\n\n3. **Data Management Layer**:\n   - Fetch configuration as structured JSON array ``GET /api/config``\n   - Parse ``{key, type, value}`` objects\n   - Update form fields with current values\n   - Collect form data and generate structured JSON for save operations\n\n4. **API Integration Layer**:\n   - HTTP client for REST API communication\n   - Error handling and retry logic\n   - Response parsing and status code handling\n   - Loading state management\n\n5. **User Interaction Layer**:\n   - Save button: Collect form \u2192 Generate JSON \u2192 ``POST /api/config``\n   - Restore button: Fetch current config \u2192 Update form\n   - Factory Reset button: Confirmation dialog \u2192 ``POST /api/config/reset``\n   - Reset countdown modal with timer display\n\n**Component Dependencies:**\n\n- ``/api/config/schema``: JSON schema endpoint (config_manager)\n- ``/api/config``: Bulk configuration GET/POST endpoint (web_server \u2192 config_manager)\n- ``/api/config/reset``: Factory reset endpoint (web_server \u2192 config_manager)", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 12, "links": ["REQ_WEB_CONF_1", "REQ_CFG_JSON_12", "REQ_CFG_JSON_13"], "links_back": ["SPEC_CFG_WEB_FLOW_1", "SPEC_CFG_WEB_FORM_1", "SPEC_CFG_WEB_MAPPING_1", "SPEC_CFG_WEB_STATE_1", "SPEC_CFG_WEB_COUNTDOWN_1", "SPEC_CFG_WEB_ERROR_1", "SPEC_CFG_WEB_INIT_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Overview", "sections": ["Architecture Overview", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["frontend", "javascript", "ui"], "template": null, "title": "Configuration Webpage Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_COUNTDOWN_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Modal dialog with countdown timer shown after configuration save or factory reset to inform user of pending device reboot.\n\n**Modal HTML Structure:**\n\n.. code-block:: html\n\n   <div id=\"countdown-modal\" class=\"modal\">\n     <div class=\"modal-content\">\n       <h2>Configuration Saved</h2>\n       <p>Device will restart in <span id=\"countdown\">5</span> seconds...</p>\n       <p class=\"warning\">Page will reload automatically after restart.</p>\n     </div>\n   </div>\n\n**Countdown JavaScript Logic:**\n\n.. code-block:: javascript\n\n   function showResetCountdown(seconds = 5) {\n     setState('COUNTDOWN');\n\n     const countdownEl = document.getElementById('countdown');\n     let remaining = seconds;\n\n     const interval = setInterval(() => {\n       remaining--;\n       countdownEl.textContent = remaining;\n\n       if (remaining <= 0) {\n         clearInterval(interval);\n         // Device should have rebooted, attempt page reload\n         window.location.reload();\n       }\n     }, 1000);\n   }\n\n**Factory Reset Countdown Variant:**\n\n.. code-block:: javascript\n\n   async function factoryReset() {\n     // Show confirmation dialog\n     const confirmed = confirm(\n       'Factory Reset will restore all settings to defaults.\\n\\n' +\n       'WiFi credentials will be erased.\\n' +\n       'Device will restart in AP mode.\\n\\n' +\n       'Are you sure?'\n     );\n\n     if (!confirmed) return;\n\n     try {\n       const response = await fetch('/api/config/reset', {\n         method: 'POST'\n       });\n\n       if (!response.ok) {\n         throw new Error('Reset failed: ' + response.status);\n       }\n\n       // Show countdown modal\n       showFactoryResetCountdown(5);\n\n     } catch (error) {\n       showMessage('Factory reset failed: ' + error.message, 'error');\n     }\n   }\n\n   function showFactoryResetCountdown(seconds = 5) {\n     setState('COUNTDOWN');\n\n     // Update modal text for factory reset\n     const modal = document.getElementById('countdown-modal');\n     modal.querySelector('h2').textContent = 'Factory Reset Initiated';\n     modal.querySelector('.warning').textContent =\n       'Device resetting to defaults. Redirecting to WiFi setup...';\n\n     const countdownEl = document.getElementById('countdown');\n     let remaining = seconds;\n\n     const interval = setInterval(() => {\n       remaining--;\n       countdownEl.textContent = remaining;\n\n       if (remaining <= 0) {\n         clearInterval(interval);\n         // Redirect to WiFi setup page (device now in AP mode)\n         window.location.href = '/wifi-setup.html';\n       }\n     }, 1000);\n   }\n\n**Design Properties:**\n\n- **Non-blocking UI**: Modal overlay prevents user interaction during countdown\n- **Clear messaging**: User knows exactly what's happening and when\n- **Automatic recovery**: Page reloads/redirects without user action\n- **Different variants**: Save countdown vs Factory Reset countdown with appropriate messaging", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_COUNTDOWN_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 474, "links": ["SPEC_CFG_WEB_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Reset Countdown Modal", "sections": ["Reset Countdown Modal", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["ui", "countdown", "reset"], "template": null, "title": "Device Reset Countdown Interface", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_ERROR_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Comprehensive error handling for all API operations with user-friendly feedback.\n\n**Error Categories:**\n\n1. **Network Errors**: Fetch timeout, connection refused, DNS failure\n2. **HTTP Errors**: 4xx client errors, 5xx server errors\n3. **Validation Errors**: Invalid form data, schema mismatch\n4. **Parse Errors**: Malformed JSON responses\n\n**Error Handling Implementation:**\n\n.. code-block:: javascript\n\n   async function apiCall(url, options = {}) {\n     try {\n       const response = await fetch(url, {\n         ...options,\n         timeout: 10000 // 10 second timeout\n       });\n\n       if (!response.ok) {\n         // HTTP error\n         let errorMsg = `HTTP ${response.status}`;\n\n         // Try to parse error response\n         try {\n           const errorData = await response.json();\n           if (errorData.error) {\n             errorMsg = errorData.error;\n           }\n         } catch (e) {\n           // Response not JSON, use default message\n         }\n\n         throw new Error(errorMsg);\n       }\n\n       // Parse successful response\n       const data = await response.json();\n       return data;\n\n     } catch (error) {\n       // Network error or other exception\n       if (error.name === 'AbortError') {\n         throw new Error('Request timeout - device may be offline');\n       }\n       throw error;\n     }\n   }\n\n**User Feedback Display:**\n\n.. code-block:: javascript\n\n   function showMessage(message, type = 'info') {\n     const messageEl = document.getElementById('message-banner');\n\n     messageEl.textContent = message;\n     messageEl.className = `message ${type}`; // 'success', 'error', 'warning', 'info'\n     messageEl.style.display = 'block';\n\n     // Auto-hide success messages after 5 seconds\n     if (type === 'success') {\n       setTimeout(() => {\n         messageEl.style.display = 'none';\n       }, 5000);\n     }\n   }\n\n**Retry Logic for Critical Operations:**\n\n.. code-block:: javascript\n\n   async function loadSchemaWithRetry(maxRetries = 3) {\n     let lastError;\n\n     for (let i = 0; i < maxRetries; i++) {\n       try {\n         const schema = await apiCall('/api/config/schema');\n         return schema;\n       } catch (error) {\n         lastError = error;\n         if (i < maxRetries - 1) {\n           // Wait before retry: 1s, 2s, 4s\n           await sleep(1000 * Math.pow(2, i));\n         }\n       }\n     }\n\n     throw new Error(`Failed to load schema after ${maxRetries} attempts: ${lastError.message}`);\n   }", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_ERROR_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 583, "links": ["SPEC_CFG_WEB_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Error Handling", "sections": ["Error Handling", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["error-handling", "feedback"], "template": null, "title": "Error Handling and User Feedback", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_FLOW_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Page Load Sequence:**\n\n::\n\n   1. Browser loads settings.html\n      \u2193\n   2. JavaScript fetches schema: GET /api/config/schema\n      \u2193\n   3. Parse schema \u2192 Generate form HTML dynamically\n      \u2193\n   4. Fetch current config: GET /api/config\n      \u2193\n   5. Parse [{key, type, value}, ...] \u2192 Update form fields\n      \u2193\n   6. Enable user interaction (Save, Restore, Factory Reset)\n\n**Save Configuration Flow:**\n\n::\n\n   1. User clicks \"Save\" button\n      \u2193\n   2. JavaScript collects form values\n      \u2193\n   3. Build structured JSON array:\n      [\n        {key: \"wifi_ssid\", type: \"string\", value: \"MyNetwork\"},\n        {key: \"led_count\", type: \"integer\", value: 50},\n        ...\n      ]\n      \u2193\n   4. POST /api/config with JSON body\n      \u2193\n   5. Server responds: 200 OK or error\n      \u2193\n   6. Show success message + reset countdown modal\n      \u2193\n   7. Auto-reload page after countdown (device reboots)\n\n**Restore Configuration Flow:**\n\n::\n\n   1. User clicks \"Restore\" button\n      \u2193\n   2. Fetch current config: GET /api/config\n      \u2193\n   3. Parse structured JSON array\n      \u2193\n   4. Update all form fields with current values\n      \u2193\n   5. Show success message\n\n**Factory Reset Flow:**\n\n::\n\n   1. User clicks \"Factory Reset\" button\n      \u2193\n   2. Show confirmation dialog: \"This will reset all settings!\"\n      \u2193\n   3. User confirms\n      \u2193\n   4. POST /api/config/reset\n      \u2193\n   5. Server responds: 200 OK (device will reboot)\n      \u2193\n   6. Show countdown modal: \"Device resetting in 5...4...3...2...1\"\n      \u2193\n   7. Auto-redirect to WiFi setup page (device rebooted to defaults)", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_FLOW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 62, "links": ["SPEC_CFG_WEB_ARCH_1", "SPEC_CFG_JSON_BULK_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["data-flow", "json", "api"], "template": null, "title": "Configuration Data Flow", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_FORM_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** JavaScript code that dynamically creates HTML form elements based on JSON schema field definitions.\n\n**Schema Field Processing:**\n\n.. code-block:: javascript\n\n   // Input: JSON schema from GET /api/config/schema\n   const schema = {\n     \"fields\": [\n       {\n         \"key\": \"wifi_ssid\",\n         \"type\": \"string\",\n         \"label\": \"WiFi SSID\",\n         \"description\": \"Network name to connect\",\n         \"default\": \"\",\n         \"validation\": {\n           \"required\": true,\n           \"maxLength\": 32\n         }\n       },\n       {\n         \"key\": \"led_count\",\n         \"type\": \"integer\",\n         \"label\": \"LED Count\",\n         \"description\": \"Number of LEDs in strip\",\n         \"default\": 50,\n         \"validation\": {\n           \"min\": 1,\n           \"max\": 300\n         }\n       }\n     ]\n   };\n\n   // Process each field to generate form HTML\n   function generateForm(schema) {\n     const formContainer = document.getElementById('config-form');\n\n     schema.fields.forEach(field => {\n       const formGroup = createFormGroup(field);\n       formContainer.appendChild(formGroup);\n     });\n   }\n\n**Form Element Generation Logic:**\n\n.. code-block:: javascript\n\n   function createFormGroup(field) {\n     const group = document.createElement('div');\n     group.className = 'form-group';\n\n     // Create label\n     const label = document.createElement('label');\n     label.textContent = field.label;\n     label.htmlFor = field.key;\n\n     // Create input based on type\n     let input;\n     switch(field.type) {\n       case 'string':\n         input = document.createElement('input');\n         input.type = field.key.includes('pass') ? 'password' : 'text';\n         if (field.validation?.maxLength) {\n           input.maxLength = field.validation.maxLength;\n         }\n         if (field.validation?.pattern) {\n           input.pattern = field.validation.pattern;\n         }\n         break;\n\n       case 'integer':\n         input = document.createElement('input');\n         input.type = 'number';\n         if (field.validation?.min !== undefined) {\n           input.min = field.validation.min;\n         }\n         if (field.validation?.max !== undefined) {\n           input.max = field.validation.max;\n         }\n         break;\n\n       case 'boolean':\n         input = document.createElement('input');\n         input.type = 'checkbox';\n         break;\n     }\n\n     input.id = field.key;\n     input.name = field.key;\n     input.required = field.validation?.required || false;\n\n     // Create description\n     const description = document.createElement('small');\n     description.className = 'form-text';\n     description.textContent = field.description;\n\n     group.appendChild(label);\n     group.appendChild(input);\n     group.appendChild(description);\n\n     return group;\n   }\n\n**Design Properties:**\n\n- **No hardcoded form fields**: All HTML generated from schema\n- **Type-safe input elements**: Schema type maps to correct HTML input type\n- **Automatic validation**: HTML5 validation attributes from schema\n- **Password detection**: Fields with \"pass\" in key get type=\"password\"\n- **Extensible**: New schema fields automatically generate form elements", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_FORM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 143, "links": ["SPEC_CFG_WEB_ARCH_1", "SPEC_CFG_JSON_SCHEMA_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Schema-Driven Form Generation", "sections": ["Schema-Driven Form Generation", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["form-generation", "schema", "javascript"], "template": null, "title": "Dynamic Form Generation from Schema", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_INIT_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Complete initialization sequence when configuration page loads.\n\n**Initialization Code:**\n\n.. code-block:: javascript\n\n   // Global cached schema\n   let cachedSchema = null;\n\n   // DOMContentLoaded event handler\n   document.addEventListener('DOMContentLoaded', async function() {\n     try {\n       setState('LOADING');\n\n       // Step 1: Load JSON schema with retry\n       showMessage('Loading configuration schema...', 'info');\n       cachedSchema = await loadSchemaWithRetry(3);\n\n       // Step 2: Generate form from schema\n       showMessage('Generating form...', 'info');\n       generateForm(cachedSchema);\n\n       // Step 3: Load current configuration\n       showMessage('Loading current configuration...', 'info');\n       await loadConfiguration();\n\n       // Step 4: Attach event handlers\n       document.getElementById('save-btn').addEventListener('click', saveConfiguration);\n       document.getElementById('restore-btn').addEventListener('click', loadConfiguration);\n       document.getElementById('factory-reset-btn').addEventListener('click', factoryReset);\n\n       // Step 5: Ready for user interaction\n       setState('READY');\n       showMessage('Configuration loaded successfully', 'success');\n\n     } catch (error) {\n       setState('ERROR');\n       showMessage('Failed to initialize page: ' + error.message, 'error');\n\n       // Show retry button\n       const retryBtn = document.getElementById('retry-btn');\n       retryBtn.style.display = 'block';\n       retryBtn.addEventListener('click', () => {\n         window.location.reload();\n       });\n     }\n   });\n\n**Initialization Sequence Diagram:**\n\n::\n\n   Page Load\n     \u2193\n   DOMContentLoaded event\n     \u2193\n   setState('LOADING')\n     \u2193\n   Fetch /api/config/schema (with retry)\n     \u2193\n   Parse schema \u2192 cachedSchema\n     \u2193\n   generateForm(cachedSchema)\n     \u2193\n   Fetch /api/config\n     \u2193\n   Parse config array \u2192 Update form fields\n     \u2193\n   Attach button event handlers\n     \u2193\n   setState('READY')\n     \u2193\n   User can interact", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_INIT_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 685, "links": ["SPEC_CFG_WEB_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Page Initialization Sequence", "sections": ["Page Initialization Sequence", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["initialization", "lifecycle"], "template": null, "title": "Complete Page Initialization Flow", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_MAPPING_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** JavaScript logic for loading structured JSON configuration data into form fields and collecting form data back into structured JSON format.\n\n**Loading Configuration into Form:**\n\n.. code-block:: javascript\n\n   // Input: Structured JSON array from GET /api/config\n   async function loadConfiguration() {\n     try {\n       const response = await fetch('/api/config');\n       const configArray = await response.json();\n\n       // Example configArray:\n       // [\n       //   {key: \"wifi_ssid\", type: \"string\", value: \"MyNetwork\"},\n       //   {key: \"led_count\", type: \"integer\", value: 50},\n       //   {key: \"enable_leds\", type: \"boolean\", value: true}\n       // ]\n\n       configArray.forEach(item => {\n         const input = document.getElementById(item.key);\n         if (!input) return; // Field not in form (schema mismatch)\n\n         switch(item.type) {\n           case 'string':\n           case 'integer':\n             input.value = item.value;\n             break;\n           case 'boolean':\n             input.checked = item.value;\n             break;\n         }\n       });\n\n       showMessage('Configuration loaded', 'success');\n     } catch (error) {\n       showMessage('Failed to load configuration: ' + error.message, 'error');\n     }\n   }\n\n**Collecting Form Data into Structured JSON:**\n\n.. code-block:: javascript\n\n   function collectFormData(schema) {\n     const configArray = [];\n\n     schema.fields.forEach(field => {\n       const input = document.getElementById(field.key);\n       if (!input) return;\n\n       let value;\n       switch(field.type) {\n         case 'string':\n           value = input.value;\n           break;\n         case 'integer':\n           value = parseInt(input.value, 10);\n           break;\n         case 'boolean':\n           value = input.checked;\n           break;\n       }\n\n       configArray.push({\n         key: field.key,\n         type: field.type,\n         value: value\n       });\n     });\n\n     return configArray;\n   }\n\n**Save Configuration to Server:**\n\n.. code-block:: javascript\n\n   async function saveConfiguration() {\n     try {\n       // Validate form first\n       const form = document.getElementById('config-form');\n       if (!form.checkValidity()) {\n         form.reportValidity();\n         return;\n       }\n\n       // Collect form data as structured JSON\n       const configArray = collectFormData(cachedSchema);\n\n       // POST to server\n       const response = await fetch('/api/config', {\n         method: 'POST',\n         headers: {\n           'Content-Type': 'application/json'\n         },\n         body: JSON.stringify(configArray)\n       });\n\n       if (!response.ok) {\n         throw new Error('Server returned ' + response.status);\n       }\n\n       showMessage('Configuration saved successfully', 'success');\n       showResetCountdown();\n\n     } catch (error) {\n       showMessage('Failed to save configuration: ' + error.message, 'error');\n     }\n   }\n\n**Design Properties:**\n\n- **Type-aware mapping**: Converts between HTML input values and typed JSON\n- **Schema-driven**: Uses cached schema for type information\n- **Validation before save**: HTML5 form validation prevents invalid data\n- **Error handling**: Network errors and HTTP errors handled gracefully", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_MAPPING_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 265, "links": ["SPEC_CFG_WEB_ARCH_1", "SPEC_CFG_JSON_BULK_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Data Mapping", "sections": ["Configuration Data Mapping", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["data-mapping", "json", "form"], "template": null, "title": "JSON Array to Form Field Mapping", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_STATE_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** JavaScript state management for different UI states during page lifecycle.\n\n**State Definitions:**\n\n====================  ====================================  ===================================\nState                 UI Behavior                           User Actions Allowed\n====================  ====================================  ===================================\n``LOADING``           Loading spinner visible               None (buttons disabled)\n``READY``             Form visible and enabled              Save, Restore, Factory Reset\n``SAVING``            Save button shows spinner             None (all buttons disabled)\n``ERROR``             Error message displayed               Retry allowed\n``COUNTDOWN``         Modal with countdown timer            None (auto-reload pending)\n====================  ====================================  ===================================\n\n**State Transition Logic:**\n\n.. code-block:: javascript\n\n   let currentState = 'LOADING';\n\n   function setState(newState) {\n     currentState = newState;\n\n     // Update UI based on state\n     const form = document.getElementById('config-form');\n     const saveBtn = document.getElementById('save-btn');\n     const restoreBtn = document.getElementById('restore-btn');\n     const resetBtn = document.getElementById('factory-reset-btn');\n     const spinner = document.getElementById('loading-spinner');\n\n     switch(newState) {\n       case 'LOADING':\n         form.style.display = 'none';\n         spinner.style.display = 'block';\n         saveBtn.disabled = true;\n         restoreBtn.disabled = true;\n         resetBtn.disabled = true;\n         break;\n\n       case 'READY':\n         form.style.display = 'block';\n         spinner.style.display = 'none';\n         saveBtn.disabled = false;\n         restoreBtn.disabled = false;\n         resetBtn.disabled = false;\n         break;\n\n       case 'SAVING':\n         saveBtn.disabled = true;\n         saveBtn.innerHTML = '<span class=\"spinner\"></span> Saving...';\n         restoreBtn.disabled = true;\n         resetBtn.disabled = true;\n         break;\n\n       case 'ERROR':\n         form.style.display = 'block';\n         spinner.style.display = 'none';\n         saveBtn.disabled = false;\n         restoreBtn.disabled = false;\n         resetBtn.disabled = false;\n         break;\n\n       case 'COUNTDOWN':\n         showModal('countdown-modal');\n         saveBtn.disabled = true;\n         restoreBtn.disabled = true;\n         resetBtn.disabled = true;\n         break;\n     }\n   }", "created_at": "", "docname": "12_design/spec_config_webpage", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_WEB_STATE_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 393, "links": ["SPEC_CFG_WEB_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "User Interface States", "sections": ["User Interface States", "Configuration Webpage Design Specification"], "service": "", "signature": null, "specific": "", "status": "open", "style": null, "tags": ["ui-state", "javascript"], "template": null, "title": "UI State Management", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_DSP_ALGO_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Distance-to-LED mapping\n\n\n**Position Mapping:**\n\n- Formula: ``led_index = (distance_mm - min_mm) * (led_count - 1) / (max_mm - min_mm)``\n- Boundary clamping: ``[0, led_count-1]``\n\n**Behaviors:**\n\n- single LED green illuminated at mapped position\n\n**Validation:** Position updates correctly with distance changes.", "created_at": "", "docname": "12_design/spec_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_DSP_ALGO_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 76, "links": ["REQ_DSP_3", "REQ_DSP_4", "REQ_DSP_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Core Algorithms", "sections": ["Core Algorithms", "Display System Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "algorithm", "mapping"], "template": null, "title": "Distance-to-Visual Mapping Algorithm", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_DSP_ALGO_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Pure integer arithmetic for all distance calculations and display operations.\n\n**Implementation:**\n\n- Distance representation: ``uint16_t`` millimeters (0-65535mm)\n- Position calculations: Multiplication before division for precision preservation\n- Boundary checks: Integer comparisons\n- Memory efficiency: 2-byte integers vs 4-byte floats\n- Execution speed: Integer ALU operations vs FPU operations\n- Deterministic timing: No floating-point precision variations\n\n**Rationale:** Avoid floating-point on resource-constrained microcontrollers unless necessary.\n\n**Validation:** All arithmetic operations complete within deterministic time bounds.", "created_at": "", "docname": "12_design/spec_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_DSP_ALGO_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 96, "links": ["REQ_SYS_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Core Algorithms", "sections": ["Core Algorithms", "Display System Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "performance", "arithmetic"], "template": null, "title": "Embedded Arithmetic Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_DSP_API_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Minimal public API for display system initialization and task management.\n\n**Public Functions:**\n\n- ``display_init()``: Initialize display system with configuration\n- ``display_start()``: Create and start display task\n- ``display_stop()``: Stop display task gracefully\n\n**Internal Functions:**\n\n- ``display_task()``: Main task loop (blocking on distance measurements)\n- ``animation_timer_callback()``: 100ms timer for animation updates\n- ``calculate_led_position()``: Distance-to-LED mapping\n- ``render_frame()``: Multi-layer rendering pipeline\n\n**Validation:** API minimal and clear, internal functions properly encapsulated, task\nlifecycle managed correctly.", "created_at": "", "docname": "12_design/spec_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_DSP_API_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 120, "links": ["REQ_DSP_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "API Design", "sections": ["API Design", "Display System Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "api", "interface"], "template": null, "title": "Public Display API", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_DSP_ARCH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Implement single FreeRTOS task that blocks on ``distance_sensor_get_latest()``.\n\n**Implementation:**\n\n- Task priority set below measurement task to ensure proper data flow hierarchy\n- Task runs continuously until system restart\n- Core assignment and stack size from centralized configuration\n- Blocking wait pattern eliminates polling overhead and provides immediate response\n\n**Validation:** Task created successfully, priority hierarchy maintained, blocks efficiently.", "created_at": "", "docname": "12_design/spec_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_DSP_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 37, "links": ["REQ_DSP_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "System Integration", "sections": ["System Integration", "Display System Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "freertos", "task"], "template": null, "title": "Task-Based Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_DSP_ARCH_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Use ``config_manager`` API for all distance range parameters.\n\n**Implementation:**\n\n- Obtain min/max distance values via ``config_get_int32()`` using ``dist_min_mm`` /\n  ``dist_max_mm`` fields (millimeters)\n- Cache config values locally at task startup for performance\n- Configuration changes handled via system restart (restart-based architecture)\n- Configuration validation responsibility belongs to ``config_manager``\n\n**Validation:** All distance parameters obtained from ``config_manager`` API, no separate\nconfig structures.", "created_at": "", "docname": "12_design/spec_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_DSP_ARCH_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 54, "links": ["REQ_DSP_2", "REQ_CFG_JSON_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "System Integration", "sections": ["System Integration", "Display System Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "configuration"], "template": null, "title": "Configuration Integration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_DSP_OVERVIEW_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** WS2812 addressable LED strip as primary display hardware with config-driven\nparameters.\n\n**Implementation:**\n\n- LED count: Configurable via ``config_manager`` API (1-100 LEDs, validated)\n- Brightness: Configurable via ``config_manager`` API (0-255, hardware PWM control)\n- GPIO pin: Hardware-specific configuration for WS2812 data line\n- Initialization: LED hardware initialized before task starts processing measurements\n- Real-time operation: Continuous reactive updates as distance measurements arrive\n\n**Validation:** LED strip responds to configuration changes, hardware initialization successful.", "created_at": "", "docname": "12_design/spec_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_DSP_OVERVIEW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 18, "links": ["REQ_DSP_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "System Integration", "sections": ["System Integration", "Display System Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "hardware", "integration"], "template": null, "title": "WS2812 Hardware Integration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_API_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Individual LED pixel manipulation with bounds checking and color utilities.\n\n**Implementation:**\n\n- ``led_set_pixel(index, color)``: Set specific LED color with index validation\n- ``led_get_pixel(index)``: Read current LED color from buffer\n- ``led_clear_pixel(index)``: Turn off specific LED (set to black)\n- Color Structure: ``led_color_t`` with 8-bit RGB components\n- Predefined Colors: Constants for common colors (RED, GREEN, BLUE, WHITE, OFF, etc.)\n- Bounds Checking: Index validation against configured LED count\n\n**Validation:** Index validation prevents buffer overruns, color values stored accurately,\npredefined colors work correctly.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_API_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 60, "links": ["REQ_LED_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "API Specifications", "sections": ["API Specifications", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "api", "control"], "template": null, "title": "Pixel-Level Control API", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_API_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Efficient batch operations for common patterns and hardware updates.\n\n**Implementation:**\n\n- ``led_clear_all()``: Set all LEDs to off state in single operation\n- ``led_show()``: Transmit complete buffer to hardware via RMT (enables REQ_LED_4)\n- Color Utilities: ``led_color_rgb()`` constructor, ``led_color_brightness()`` scaling\n- Status Functions: ``led_get_count()``, ``led_is_initialized()`` for state queries\n- Atomic Updates: Buffer modifications independent until ``led_show()`` called\n\n**Validation:** Clear all zeros entire buffer, show triggers RMT transmission, utilities\nproduce correct colors.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_API_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 80, "links": ["REQ_LED_2", "REQ_LED_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "API Specifications", "sections": ["API Specifications", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "api", "batch"], "template": null, "title": "Batch Operations API", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_API_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Thread-safe LED state snapshot API for external monitoring and visualization components.\n\n**Implementation:**\n\n- ``led_get_all_colors(output_buffer, max_count)``: Copy current LED state to caller buffer\n- Snapshot Semantics: Returns state matching last ``led_show()`` call (physical LED state)\n- Thread Safety: Mutex-protected read operation safe for concurrent access from multiple tasks\n- Partial Read Support: Respects ``max_count`` limit to prevent buffer overruns\n- Return Value: Number of LEDs actually copied (min(led_count, max_count)), or 0 on error\n- Error Conditions: Returns 0 if not initialized, invalid buffer pointer, or mutex error\n- Buffer Ownership: Caller allocates and owns output buffer memory\n- Copy Operation: Deep copy of LED color data (``memcpy`` of color structures)\n\n**Rationale:** Web server and monitoring tasks need non-blocking access to LED state without\ninterfering with display logic updates. Mutex ensures data consistency when display task is\nupdating buffer.\n\n**Validation:** Concurrent access from web server and display task shows no corruption,\nreturned colors match physical LED state, mutex prevents race conditions, partial reads work\ncorrectly with buffer size limits.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_API_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 99, "links": ["REQ_LED_5"], "links_back": ["SPEC_WEB_REST_LED_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "API Specifications", "sections": ["API Specifications", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "api", "monitoring", "thread-safety"], "template": null, "title": "LED State Read API", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_ARCH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** ESP32 RMT (Remote Control) peripheral abstraction for WS2812 timing generation.\n\n**Implementation:**\n\n- RMT Channel Configuration: 80MHz resolution, configurable GPIO pin, 64-symbol memory blocks\n- Encoder Configuration: Bytes encoder with precise WS2812 timing (T0H=0.4\u00b5s, T0L=0.8\u00b5s, T1H=0.8\u00b5s, T1L=0.4\u00b5s)\n- Transmission Queue: 4-deep queue for overlapping operations\n- Clock Source: Default ESP32 RMT clock for consistent timing\n- Channel Management: Single channel allocation with proper cleanup\n\n**Validation:** RMT channel created successfully, timing parameters match WS2812 datasheet,\ntransmission completes without errors.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 19, "links": ["REQ_LED_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Hardware Abstraction", "sections": ["Hardware Abstraction", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "rmt", "hardware"], "template": null, "title": "RMT Peripheral Hardware Abstraction", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_ARCH_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** In-memory LED state buffer for performance optimization and atomic updates.\n\n**Implementation:**\n\n- Buffer Structure: Array of ``led_color_t`` structures (3 bytes per LED: R, G, B)\n- Dynamic Allocation: ``malloc()`` during initialization based on configured LED count (REQ_LED_3)\n- State Separation: RAM buffer independent from physical LED state until ``led_show()``\n- Update Pattern: Modify buffer \u2192 call ``led_show()`` \u2192 physical update\n- Memory Management: Allocation during init, deallocation during cleanup\n\n**Validation:** Buffer allocates correctly for configured LED count, updates modify only\nbuffer until show, memory freed on cleanup.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_ARCH_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 38, "links": ["REQ_LED_2", "REQ_LED_3"], "links_back": ["SPEC_LED_SIM_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Hardware Abstraction", "sections": ["Hardware Abstraction", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "memory", "buffer"], "template": null, "title": "RAM Buffer Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_DATA_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** RGB color representation with GRB hardware conversion for WS2812 compatibility.\n\n**Implementation:**\n\n- API Color Format: RGB (Red, Green, Blue) for user-friendly interface\n- Hardware Format: GRB (Green, Red, Blue) as required by WS2812 LEDs\n- Conversion Logic: Reorder RGB\u2192GRB during ``led_show()`` transmission preparation\n- Data Buffer: Temporary allocation for GRB transmission data\n- Brightness Scaling: Integer arithmetic for brightness adjustment without floating point\n\n**Validation:** Color values convert correctly RGB\u2192GRB, brightness scaling maintains color\nratios, no precision loss.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_DATA_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 148, "links": ["REQ_LED_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Timing and Data Format", "sections": ["Timing and Data Format", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "color", "conversion"], "template": null, "title": "Color Representation and Conversion", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_ERR_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Comprehensive input validation and state checking with appropriate error codes.\n\n**Implementation:**\n\n- State Validation: Check initialization before operations\n- Bounds Checking: LED index validation against configured count (REQ_LED_3)\n- Parameter Validation: Non-null config, valid LED count range\n- RMT Error Handling: Propagate RMT peripheral errors to caller\n- Graceful Degradation: Safe operation when not initialized (return errors, not crash)\n\n**Validation:** Invalid inputs return appropriate error codes, operations fail safely,\nsystem remains stable.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_ERR_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 189, "links": ["REQ_LED_2", "REQ_LED_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Memory and Error Handling", "sections": ["Memory and Error Handling", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "error-handling", "validation"], "template": null, "title": "Error Handling and Validation", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_MEM_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Controlled dynamic allocation with proper cleanup and error handling.\n\n**Implementation:**\n\n- Initialization Allocation: LED buffer ``malloc()`` based on configured count\n- Validation: LED count bounds (1-1000) to prevent excessive allocation\n- Cleanup: ``free()`` buffer and reset pointers during deinitialization\n- Temporary Allocation: GRB data buffer during transmission (freed immediately)\n- Error Recovery: Cleanup partial initialization on failure\n\n**Validation:** Memory allocated correctly, no leaks after deinitialization, error paths\nclean up properly.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_MEM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 170, "links": ["REQ_LED_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Memory and Error Handling", "sections": ["Memory and Error Handling", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "memory", "resource"], "template": null, "title": "Dynamic Memory Management", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_SIM_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Provide a simulator implementation for the LED controller that exposes the full\npublic API (``led_controller.h``) while replacing RMT transmission with a rate-limited\nterminal visualization.\n\n**Implementation:**\n\n- API Compatibility: The simulator SHALL implement all public functions declared in\n  ``led_controller.h`` and return the same error codes and behavior as the hardware\n  implementation\n- Buffer Semantics: Maintain the same in-memory buffer and batch ``led_show()`` semantics\n  as the hardware implementation\n- Visualization: Rate-limited (\u22481Hz) terminal output using Unicode emoji blocks\n  (\ud83d\udd34\ud83d\udfe2\ud83d\udd35\ud83d\udfe1\ud83d\udfe3\u26aa\u26ab) to represent per-pixel color state\n- Non-intrusive: The simulator SHOULD NOT change header files, configuration, or\n  higher-layer logic (e.g., display logic)\n\n**Validation:** Simulator build compiles with ``CONFIG_TARGET_EMULATOR=y``, ``led_show()``\nlogs appear ~1x/sec and reflect buffer state.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_SIM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 211, "links": ["REQ_SYS_SIM_1", "SPEC_LED_ARCH_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Simulator Specification", "sections": ["Simulator Specification", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "simulator", "qemu"], "template": null, "title": "LED Controller Simulator", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_LED_TIMING_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Precise WS2812 protocol timing using RMT encoder configuration.\n\n**Implementation:**\n\n- Bit 0 Encoding: High 0.4\u00b5s (32 ticks), Low 0.8\u00b5s (64 ticks)\n- Bit 1 Encoding: High 0.8\u00b5s (64 ticks), Low 0.4\u00b5s (32 ticks)\n- Reset Period: 50\u00b5s (4000 ticks) low signal between frames\n- Clock Resolution: 80MHz RMT clock for 12.5ns tick precision\n- MSB First: Most significant bit transmitted first per WS2812 protocol\n\n**Validation:** Timing measurements match WS2812 datasheet specifications, LED strips\nrespond correctly.", "created_at": "", "docname": "12_design/spec_led_controller", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_LED_TIMING_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 129, "links": ["REQ_LED_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Timing and Data Format", "sections": ["Timing and Data Format", "LED Controller Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["led", "timing", "ws2812"], "template": null, "title": "WS2812 Timing Specification", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_ALGO_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Integer arithmetic for temperature-compensated distance calculation.\n\n**Implementation:**\n\n- Speed of sound: ``calculate_speed_of_sound_scaled(temperature_c_x10)`` with scaling factor 1,000,000\n- Formula: ``speed = 331300000 + (606 * temperature_c_x10 * 100)``\n- Distance: ``distance_mm = (echo_duration_us * speed_of_sound_scaled) / 2000000``\n- Avoids floating-point operations for embedded performance\n- Temperature input as ``temperature_c_x10`` (200 = 20.0\u00b0C)\n\n**Validation:** Distance calculations accurate within \u00b11mm for known echo durations and\ntemperatures.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_ALGO_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 97, "links": ["REQ_SNS_11"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Algorithm Specifications", "sections": ["Algorithm Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "algorithm", "calibration"], "template": null, "title": "Distance Calculation Algorithm", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_ALGO_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Exponential Moving Average filter using integer arithmetic.\n\n**Implementation:**\n\n- Formula: ``smoothed = (smoothing_factor * new) + ((1000 - smoothing_factor) * previous) / 1000``\n- Smoothing factor range 0-1000 (300 = 30% new, 70% previous)\n- Previous value stored as ``uint16_t previous_smoothed_value_mm``\n- First measurement initializes filter without smoothing\n- Applied only to valid measurements (not out-of-range or timeout)\n\n**Validation:** Smoothing reduces noise while maintaining responsiveness, factor extremes\n(0, 1000) work correctly.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_ALGO_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 116, "links": ["REQ_SNS_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Algorithm Specifications", "sections": ["Algorithm Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "algorithm", "filtering"], "template": null, "title": "EMA Smoothing Filter Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_API_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Simple blocking and monitoring API for consumers.\n\n**Implementation:**\n\n- ``distance_sensor_get_latest()``: Blocking receive from processed queue with ``portMAX_DELAY``\n- ``distance_sensor_has_new_measurement()``: Non-blocking queue status check\n- ``distance_sensor_get_queue_overflows()``: Returns overflow counter for monitoring\n- ``distance_sensor_monitor()``: Health check with overflow logging\n- ``distance_sensor_is_running()``: Task state query\n\n**Validation:** Blocking API waits for new data, non-blocking API returns immediately,\nmonitoring functions provide accurate metrics.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_API_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 138, "links": ["REQ_SNS_5", "REQ_SNS_7"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "API Specifications", "sections": ["API Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "api", "interface"], "template": null, "title": "Public API Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_ARCH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Separate ISR and task responsibilities using FreeRTOS queues for communication.\n\n**Implementation:**\n\n- ISR captures raw timestamps only, minimal processing\n- Sensor task performs calculations, validation, and smoothing\n- Raw queue (size 2): ISR \u2192 Task communication for timestamps\n- Processed queue (size 5): Task \u2192 API communication for measurements\n- Queue-based design eliminates shared variables and race conditions\n\n**Validation:** ISR completes within microseconds, task receives raw timestamps, API\nconsumers get processed measurements.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 20, "links": ["REQ_SNS_3", "REQ_SNS_4", "REQ_SNS_8"], "links_back": ["SPEC_SNS_SIM_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Specifications", "sections": ["Architecture Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "architecture", "real-time"], "template": null, "title": "Dual-Queue Real-Time Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_ARCH_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** HC-SR04 ultrasonic sensor interface using ESP32 GPIO.\n\n**Implementation:**\n\n- Trigger pin (default GPIO14): Output mode, generates 10\u00b5s pulse\n- Echo pin (default GPIO13): Input mode with ``GPIO_INTR_ANYEDGE`` interrupt\n- GPIO configuration during ``distance_sensor_init()`` with validation\n- ISR handler attached to echo pin for edge detection\n\n**Validation:** GPIO pins configured correctly, ISR service installed, trigger pulse generated.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_ARCH_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 39, "links": ["REQ_SNS_1", "REQ_SNS_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Specifications", "sections": ["Architecture Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "gpio", "hardware"], "template": null, "title": "GPIO Interface Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_ERR_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Comprehensive error detection and recovery.\n\n**Implementation:**\n\n- Timeout: No echo within timeout \u2192 enqueue ``DISTANCE_SENSOR_TIMEOUT`` with distance 0\n- Out-of-range: Distance < 20mm or > 4000mm \u2192 mark ``DISTANCE_SENSOR_OUT_OF_RANGE``, no smoothing\n- Queue overflow: Processed queue full \u2192 drop oldest, increment ``queue_overflow_counter``\n- Graceful degradation with status codes in measurement structure\n\n**Validation:** Error conditions produce correct status codes, overflow policy drops oldest\ncorrectly, system continues operation.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_ERR_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 160, "links": ["REQ_SNS_12", "REQ_SNS_13", "REQ_SNS_14"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Error Handling Specifications", "sections": ["Error Handling Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "error-handling", "robustness"], "template": null, "title": "Error Handling Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_ISR_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** IRAM-resident ISR for deterministic timestamp capture.\n\n**Implementation:**\n\n- Rising edge: Capture ``echo_start_time`` using ``esp_timer_get_time()``\n- Falling edge: Capture ``echo_end_time`` and queue raw measurement via ``xQueueSendFromISR``\n- Uses ``portYIELD_FROM_ISR`` for task scheduling\n- Marked ``IRAM_ATTR`` for real-time constraints\n- No floating-point, heap allocation, or blocking operations\n\n**Validation:** ISR execution time < 10\u00b5s, timestamps captured accurately, raw queue\nreceives data.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_ISR_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 56, "links": ["REQ_SNS_3", "REQ_SNS_8"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Specifications", "sections": ["Architecture Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "isr", "real-time"], "template": null, "title": "Interrupt Service Routine Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_SIM_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Provide a simulator implementation for the distance sensor that implements the\nfull public API declared in ``distance_sensor.h`` while replacing ISR/GPIO timing with a\ndeterministic simulated data producer.\n\n**Implementation:**\n\n- API Compatibility: The simulator SHALL implement ``distance_sensor_init()``, ``distance_sensor_start()``,\n  ``distance_sensor_get_latest()`` and all other public functions with identical signatures\n  and return codes\n- Queue Semantics: The simulator MUST produce ``distance_measurement_t`` entries on the\n  processed queue with the same semantics as the hardware task (blocking consumers, identical\n  status codes for out-of-range/timeouts when simulated)\n- Animation Pattern: Deterministic sweep from 5cm to 60cm and back in 1mm steps, advancing\n  once per second\n- Isolation: Simulator implementation SHOULD be in ``distance_sensor_sim.c`` and selected\n  via CMake when ``CONFIG_TARGET_EMULATOR=y`` without modifying headers or higher-level\n  application code\n\n**Validation:** Simulator build compiles, ``distance_sensor_get_latest()`` receives simulated\nmeasurements at \u22481Hz, and status codes match expectations.\n\n**Example Implementation Pattern:**\n\n.. code-block:: c\n\n   // Simulated sensor with animated distance sweep\n   static void distance_sensor_task(void* pvParameters) {\n       static uint16_t sim_distance = 50;  // Start at 5cm\n       static int8_t direction = 1;        // 1 = increasing, -1 = decreasing\n\n       while(1) {\n           // Animate distance: 5cm \u2192 60cm \u2192 5cm (1mm steps)\n           sim_distance += direction;\n           if (sim_distance >= 600) direction = -1;  // 60cm\n           if (sim_distance <= 50)  direction = 1;   // 5cm\n\n           distance_measurement_t sim_data = {\n               .distance_mm = sim_distance,\n               .timestamp_us = esp_timer_get_time(),\n               .status = DISTANCE_SENSOR_OK\n           };\n\n           xQueueSend(processed_measurement_queue, &sim_data, portMAX_DELAY);\n           vTaskDelay(pdMS_TO_TICKS(1000));  // 1 second steps\n       }\n   }", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_SIM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 181, "links": ["REQ_SYS_SIM_1", "SPEC_SNS_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Simulator Specification", "sections": ["Simulator Specification", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "simulator", "qemu"], "template": null, "title": "Distance Sensor Simulator Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_SNS_TASK_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** FreeRTOS task for continuous measurement processing.\n\n**Implementation:**\n\n- Task priority 5, stack size 4096 bytes, pinned to core 1\n- Measurement loop: trigger pulse \u2192 wait for raw queue \u2192 calculate distance \u2192 validate \u2192 smooth \u2192 enqueue\n- Configurable measurement interval (default 100ms) with ``vTaskDelay``\n- Timeout handling for missing echo responses (default 30ms)\n- Created by ``distance_sensor_start()``, deleted by ``distance_sensor_stop()``\n\n**Validation:** Task created successfully, measurement loop operates at configured interval,\nprocesses raw data correctly.", "created_at": "", "docname": "12_design/spec_distance_sensor", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_SNS_TASK_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 75, "links": ["REQ_SNS_4", "REQ_SNS_6", "REQ_SNS_10"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Specifications", "sections": ["Architecture Specifications", "Distance Sensor Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["sensor", "freertos", "task"], "template": null, "title": "Sensor Task Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_STARTUP_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Startup test executes after LED controller initialization in main() function.\n\n**Implementation:**\n\n- **Execution Point**: Called in main.c after ``led_controller_init()`` succeeds\n- **Dependency Check**: Uses ``led_is_initialized()`` to verify LED controller readiness\n- **Error Handling**: Returns ``ESP_ERR_INVALID_STATE`` if LED controller not initialized\n- **Integration**: Direct function call from main(), no separate task required\n\n**Architecture Flow:**\n\n.. code-block:: text\n\n   main() \u2192 led_controller_init() \u2192 led_running_test_single_cycle() \u2192 normal_operation()\n\n**Validation:** LED controller must be successfully initialized before startup test can execute.", "created_at": "", "docname": "12_design/spec_startup_test", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_STARTUP_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 20, "links": ["REQ_STARTUP_1"], "links_back": ["SPEC_STARTUP_4"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Integration Architecture", "sections": ["Integration Architecture", "Startup Test Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["startup", "initialization", "dependency"], "template": null, "title": "LED Controller Dependency Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_STARTUP_2": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Single moving LED pattern implemented using sequential clear-set-show operations.\n\n**Core Algorithm** (``led_running_test_single_cycle``):\n\n.. code-block:: c\n\n   for (uint16_t i = 0; i < led_count; i++) {\n       // Clear previous LED (wrap around for first LED)\n       if (i > 0) {\n           led_clear_pixel(i - 1);\n       } else {\n           led_clear_pixel(led_count - 1);  // Clear last LED on first iteration\n       }\n\n       // Set current LED\n       led_set_pixel(i, color);\n       led_show();                    // Update physical LEDs\n\n       vTaskDelay(pdMS_TO_TICKS(delay_ms));  // Timing control\n   }\n\n**Design Characteristics:**\n\n- **Single LED Active**: Only one LED illuminated at any time (clear previous, set current)\n- **Sequential Progression**: LEDs activated from index 0 to (led_count-1)\n- **Configurable Color**: Color parameter allows different startup patterns\n- **Configurable Timing**: Delay parameter controls speed (default 50ms per LED)\n- **Immediate Updates**: ``led_show()`` called after each LED change for real-time feedback\n\n**Current Implementation:**\n\n- Called as: ``led_running_test_single_cycle(LED_COLOR_GREEN, 50)``\n- Green color for startup indication\n- 50ms delay between LED activations\n- Single cycle (not repeating)\n\n**Validation:** LEDs light sequentially from first to last position with visible timing.", "created_at": "", "docname": "12_design/spec_startup_test", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_STARTUP_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 46, "links": ["REQ_STARTUP_2"], "links_back": ["SPEC_STARTUP_4"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Test Algorithm", "sections": ["Test Algorithm", "Startup Test Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["startup", "algorithm", "visual"], "template": null, "title": "Sequential LED Pattern Algorithm", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_STARTUP_3": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** One-time execution pattern with proper LED state management.\n\n**Integration Pattern** (from main.c):\n\n.. code-block:: c\n\n   // 1. Initialize LED controller\n   led_controller_init(&led_config);\n\n   // 2. Clear initial state\n   led_clear_all();\n   led_show();\n\n   // 3. Execute startup test\n   ESP_LOGI(TAG, \"Running one-time LED hardware test...\");\n   led_running_test_single_cycle(LED_COLOR_GREEN, 50);\n   ESP_LOGI(TAG, \"Hardware test completed\");\n\n   // 4. Clean up for normal operation\n   led_clear_all();\n   led_show();\n\n   // 5. Continue with normal initialization\n\n**Design Characteristics:**\n\n- **One-Time Execution**: Called once during startup, not as background task\n- **State Cleanup**: LEDs cleared before and after test\n- **Logging Integration**: ESP_LOG* statements for startup visibility\n- **Non-Blocking**: Executes synchronously in main thread\n- **Clean Transition**: All LEDs off after test, ready for normal operation\n\n**Performance:**\n\n- Total execution time for 40 LEDs: ~2 seconds (40 \u00d7 50ms)\n- Memory usage: No additional allocation beyond LED controller\n- CPU impact: Minimal, just timing delays\n\n**Validation:** Test completes within reasonable time, all LEDs cleared after completion.", "created_at": "", "docname": "12_design/spec_startup_test", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_STARTUP_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 93, "links": ["REQ_STARTUP_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Startup Integration", "sections": ["Startup Integration", "Startup Test Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["startup", "integration", "cleanup"], "template": null, "title": "Startup Integration and Cleanup", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_STARTUP_4": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Minimal component structure with clear API and dependencies.\n\n**Component Structure:**\n\n.. code-block:: text\n\n   main/components/startup_tests/\n   \u251c\u2500\u2500 led_running_test.h          // Public API\n   \u251c\u2500\u2500 led_running_test.c          // Implementation\n   \u2514\u2500\u2500 CMakeLists.txt              // Build config\n\n**API Design:**\n\n- **Primary Function**: ``led_running_test_single_cycle(color, delay_ms)``\n- **Extended Functions**: ``led_running_test_multiple_cycles()``, ``led_running_test_rainbow()``\n- **Error Handling**: ESP-IDF error codes (``ESP_OK``, ``ESP_ERR_INVALID_STATE``)\n- **Dependencies**: LED controller component\n\n**Alternative Patterns:**\n\n- **Multiple Cycles**: ``led_running_test_multiple_cycles()`` for repeated patterns\n- **Rainbow Effect**: ``led_running_test_rainbow()`` for color-changing sequences\n\n**Validation:** Component structure clean, API minimal, dependencies clear, alternative\npatterns available for diagnostics.", "created_at": "", "docname": "12_design/spec_startup_test", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_STARTUP_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 142, "links": ["SPEC_STARTUP_1", "SPEC_STARTUP_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Component Structure", "sections": ["Component Structure", "Startup Test Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["startup", "architecture", "component"], "template": null, "title": "Component Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_ARCH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Overview:**\nThe web server component provides a layered HTTP server architecture based on ESP-IDF's ``esp_http_server`` library. It serves three main pages (dashboard, WiFi setup, settings) plus REST API endpoints.\n\n**Architecture Layers:**\n\n1. **ESP-IDF HTTP Server Layer**:\n   - ``httpd_start()`` with custom config (port, max connections, LRU purge)\n   - Event-driven non-blocking connection handling\n   - URI handler registration system\n\n2. **Static Content Layer**:\n   - HTML/CSS/JS files embedded in flash using ``EMBED_FILES``\n   - Binary symbols generated at build time (``_binary_xxx_start/end``)\n   - MIME type detection based on file extension\n   - Cache control headers (no-cache for development)\n\n3. **REST API Layer**:\n   - WiFi management endpoints (``/scan``, ``/connect``, ``/status``, ``/reset``)\n   - Configuration endpoints (``/api/config``, ``/api/config/reset``)\n   - System health endpoint (``/api/system/health``)\n   - JSON request/response using cJSON library\n\n4. **Integration Layer**:\n   - Calls to ``wifi_manager`` component for WiFi operations\n   - Calls to ``config_manager`` component for configuration access\n   - Error code mapping from ESP-IDF to HTTP status codes\n\n**Component Dependencies:**\n\n- ``wifi_manager``: WiFi connection state, credentials, scanning\n- ``config_manager``: Configuration read/write, factory reset\n- ``esp_http_server``: HTTP protocol handling\n- ``cJSON``: JSON serialization/deserialization\n- ``cert_handler``: HTTPS support (future)\n\n**Data Flow Example (Schema-Driven Configuration Update):**\n\n::\n\n   Browser GET /api/config/schema\n     \u2193\n   schema_get_handler() \u2192 config_get_schema_json()\n     \u2193\n   Return embedded config_schema.json\n     \u2193\n   Browser generates dynamic form from schema\n     \u2193\n   Browser POST /api/config (flat JSON)\n     \u2193\n   config_set_handler() \u2192 config_set_all_from_json()\n     \u2193\n   Config manager parses JSON using schema for type validation\n     \u2193\n   Bulk NVS write (all fields, single commit)\n     \u2193\n   Return HTTP 200 with success response", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 12, "links": ["REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_3", "REQ_WEB_CONF_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Architecture Overview", "sections": ["Architecture Overview", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "architecture"], "template": null, "title": "Web Server Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_CAPTIVE_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Current Implementation:**\n\nThe template provides a **simplified captive portal** approach:\n\n1. **AP Mode:** Device starts in AP mode (``ESP32-AP``) if no WiFi credentials stored\n2. **Direct IP Access:** Users connect to AP and navigate to device IP (e.g., ``192.168.4.1``)\n3. **WiFi Setup Page:** ``/wifi-setup.html`` provides network scanning and credential entry\n4. **Manual Navigation:** No DNS redirect - users manually enter IP address\n\n**Previous DNS Server Approach (Removed for Simplicity):**\n\nEarlier versions included a DNS server to redirect all DNS queries to device IP for automatic captive portal popup. This was removed to simplify the template.\n\n**Re-enabling Captive Portal (Optional):**\n\nUsers can optionally implement DNS redirect:\n\n1. Start DNS server in AP mode (listen UDP port 53)\n2. Respond to all DNS queries with device AP IP (``192.168.4.1``)\n3. Trigger browser captive portal detection (iOS, Android, Windows)\n\n**Current User Experience:**\n\n1. Connect to ``ESP32-AP`` WiFi network\n2. Open browser and navigate to ``http://192.168.4.1``\n3. Click \"WiFi\" in navigation menu\n4. Scan networks, select SSID, enter password, click \"Connect\"\n5. Device saves credentials and restarts in STA mode\n\n**Note:** This simplified approach works well for template usage. Production deployments may want full DNS redirect captive portal.", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_CAPTIVE_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 862, "links": ["REQ_WEB_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Captive Portal Implementation", "sections": ["Captive Portal Implementation", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "captive-portal", "wifi"], "template": null, "title": "Captive Portal Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_CONFIG_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Server Configuration:**\n\n.. code-block:: c\n\n   typedef struct {\n       uint16_t port;              // Default: 80\n       uint8_t max_open_sockets;   // Default: 7\n   } web_server_config_t;\n\n   #define WEB_SERVER_DEFAULT_CONFIG() { \\\n       .port = 80, \\\n       .max_open_sockets = 7 \\\n   }\n\n**ESP-IDF httpd_config_t Settings:**\n\n.. code-block:: c\n\n   httpd_config_t httpd_config = HTTPD_DEFAULT_CONFIG();\n   httpd_config.server_port = 80;\n   httpd_config.max_open_sockets = 7;     // Concurrent connections\n   httpd_config.max_uri_handlers = 32;    // Increased from default 8\n   httpd_config.lru_purge_enable = true;  // Auto-remove LRU handlers\n\n**Performance Characteristics:**\n\n- **Max Concurrent Connections:** 7 (ESP32 memory constraint)\n- **Connection Timeout:** 20 seconds default (ESP-IDF)\n- **Non-blocking I/O:** Event-driven, doesn't block FreeRTOS tasks\n- **Memory per Connection:** ~1-2KB depending on request size\n\n**Initialization Sequence:**\n\n.. code-block:: c\n\n   esp_err_t web_server_init(const web_server_config_t *config)\n   {\n       // 1. Store configuration\n       current_config = *config;\n\n       // 2. Start HTTP server\n       httpd_config_t httpd_config = HTTPD_DEFAULT_CONFIG();\n       httpd_config.server_port = current_config.port;\n       httpd_config.max_open_sockets = current_config.max_open_sockets;\n       httpd_config.max_uri_handlers = 32;\n       httpd_config.lru_purge_enable = true;\n\n       if (httpd_start(&server, &httpd_config) != ESP_OK) {\n           return ESP_FAIL;\n       }\n\n       // 3. Register all URI handlers (32 handlers total)\n       // ... (registration code)\n\n       return ESP_OK;\n   }\n\n**Start/Stop Functions:**\n\n.. code-block:: c\n\n   esp_err_t web_server_start(void)\n   {\n       server_running = true;\n       ESP_LOGI(TAG, \"Web server started successfully\");\n       return ESP_OK;\n   }\n\n   esp_err_t web_server_stop(void)\n   {\n       if (server != NULL) {\n           httpd_stop(server);\n           server = NULL;\n       }\n       server_running = false;\n       return ESP_OK;\n   }\n\n**Query Functions:**\n\n.. code-block:: c\n\n   bool web_server_is_running(void);      // Check running state\n   uint16_t web_server_get_port(void);    // Get configured port", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_CONFIG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 903, "links": ["REQ_WEB_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Server Configuration and Lifecycle", "sections": ["Server Configuration and Lifecycle", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "config", "performance"], "template": null, "title": "HTTP Server Configuration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_EXTEND_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Adding a New Static HTML Page:**\n\n1. **Create HTML File:**\n\n   Create ``main/components/web_server/www/my-page.html``\n\n2. **Update CMakeLists.txt:**\n\n   .. code-block:: cmake\n\n      EMBED_FILES\n          \"www/index.html\"\n          \"www/wifi-setup.html\"\n          \"www/settings.html\"\n          \"www/my-page.html\"   # ADD THIS LINE\n\n3. **Add Binary Symbol Declarations:**\n\n   In ``web_server.c``:\n\n   .. code-block:: c\n\n      extern const uint8_t my_page_html_start[] asm(\"_binary_my_page_html_start\");\n      extern const uint8_t my_page_html_end[] asm(\"_binary_my_page_html_end\");\n\n4. **Update ``get_embedded_file()``:**\n\n   .. code-block:: c\n\n      else if (strcmp(clean_filename, \"/my-page.html\") == 0)\n      {\n          *data = my_page_html_start;\n          *size = my_page_html_end - my_page_html_start;\n      }\n\n5. **Register URI Handler:**\n\n   .. code-block:: c\n\n      httpd_uri_t my_page_uri = {\n          .uri = \"/my-page.html\",\n          .method = HTTP_GET,\n          .handler = static_file_handler,\n          .user_ctx = NULL\n      };\n      httpd_register_uri_handler(server, &my_page_uri);\n\n6. **Add Navigation Link:**\n\n   Update navbar in all HTML files:\n\n   .. code-block:: html\n\n      <a href=\"/my-page.html\" class=\"nav-btn\">My Page</a>\n\n**Adding a New REST API Endpoint:**\n\n1. **Implement Handler Function:**\n\n   .. code-block:: c\n\n      static esp_err_t my_api_handler(httpd_req_t *req)\n      {\n          httpd_resp_set_type(req, \"application/json\");\n          httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n\n          // Your API logic here\n\n          const char *response = \"{\\\"status\\\":\\\"success\\\"}\";\n          return httpd_resp_send(req, response, HTTPD_RESP_USE_STRLEN);\n      }\n\n2. **Register URI Handler:**\n\n   .. code-block:: c\n\n      httpd_uri_t my_api_uri = {\n          .uri = \"/api/my-endpoint\",\n          .method = HTTP_GET,  // or HTTP_POST\n          .handler = my_api_handler,\n          .user_ctx = NULL\n      };\n      httpd_register_uri_handler(server, &my_api_uri);\n\n3. **Update JavaScript:**\n\n   Add API call in ``www/js/app.js``:\n\n   .. code-block:: javascript\n\n      async function fetchMyData() {\n          const response = await fetch('/api/my-endpoint');\n          const data = await response.json();\n          // Handle data\n      }", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_EXTEND_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 998, "links": ["REQ_WEB_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Adding New Pages and Endpoints", "sections": ["Adding New Pages and Endpoints", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "extensibility", "guide"], "template": null, "title": "Extension Guide for Web Pages", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_INTEGRATION_CFG_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Integration Points:**\n\nThe web server integrates with the config manager component through a well-defined C API:\n\n**Include Header:**\n\n.. code-block:: c\n\n   #include \"config_manager.h\"  // Provides config_get_*, config_set_* functions\n\n**Reading Configuration:**\n\n.. code-block:: c\n\n   char wifi_ssid[CONFIG_STRING_MAX_LEN + 1];\n   uint16_t led_count;\n\n   esp_err_t ret = config_get_string(CONFIG_WIFI_SSID, wifi_ssid, sizeof(wifi_ssid));\n   if (ret != ESP_OK) {\n       ESP_LOGE(TAG, \"Failed to get WiFi SSID: %s\", esp_err_to_name(ret));\n       // Use default or return error to client\n   }\n\n   config_get_uint16(CONFIG_LED_COUNT, &led_count);\n\n**Writing Configuration:**\n\n.. code-block:: c\n\n   const char *new_ssid = \"NewNetwork\";\n   esp_err_t ret = config_set_string(CONFIG_WIFI_SSID, new_ssid);\n   if (ret != ESP_OK) {\n       ESP_LOGE(TAG, \"Failed to set WiFi SSID: %s\", esp_err_to_name(ret));\n       httpd_resp_send_err(req, HTTPD_400_BAD_REQUEST, \"Invalid WiFi SSID\");\n       return ESP_FAIL;\n   }\n\n**Factory Reset:**\n\n.. code-block:: c\n\n   esp_err_t ret = config_factory_reset();\n   if (ret != ESP_OK) {\n       httpd_resp_send_err(req, HTTPD_500_INTERNAL_SERVER_ERROR, \"Factory reset failed\");\n       return ESP_FAIL;\n   }\n\n**Error Code Mapping:**\n\n============================  =================================  ===============\nConfig Manager Error          HTTP Status Code                   Response Action\n============================  =================================  ===============\n``ESP_OK``                    200 OK                             Return data/success\n``ESP_ERR_INVALID_ARG``       400 Bad Request                    Invalid parameter\n``ESP_ERR_NVS_NOT_FOUND``     404 Not Found                      Key doesn't exist\n``ESP_ERR_NO_MEM``            500 Internal Server Error          Memory allocation failed\n``ESP_FAIL`` (NVS error)      500 Internal Server Error          Storage error\n============================  =================================  ===============\n\n**Separation of Concerns:**\n\n- **Config Manager** owns NVS storage logic, key-value mapping, defaults\n- **Web Server** owns HTTP protocol, JSON serialization, client interaction\n- **Interface:** Simple C function calls with ``esp_err_t`` return codes\n\n**Note:** Config Manager does NOT know about HTTP, JSON, or web interfaces. Web Server does NOT know about NVS internals or storage keys.", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_INTEGRATION_CFG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 719, "links": ["REQ_WEB_CONF_1", "REQ_CFG_JSON_10"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Configuration Manager Integration", "sections": ["Configuration Manager Integration", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "integration", "config"], "template": null, "title": "Config Manager Integration Pattern", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_INTEGRATION_WIFI_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Integration Points:**\n\n.. code-block:: c\n\n   #include \"wifi_manager.h\"\n\n**WiFi Scanning:**\n\n.. code-block:: c\n\n   // Start scan (blocking)\n   wifi_scan_config_t scan_config = {\n       .show_hidden = false,\n       .scan_type = WIFI_SCAN_TYPE_ACTIVE,\n       .scan_time.active.min = 100,\n       .scan_time.active.max = 300,\n   };\n   esp_wifi_scan_start(&scan_config, true);\n\n   // Get results\n   uint16_t ap_count = 0;\n   esp_wifi_scan_get_ap_num(&ap_count);\n   wifi_ap_record_t *ap_records = malloc(sizeof(wifi_ap_record_t) * ap_count);\n   esp_wifi_scan_get_ap_records(&ap_count, ap_records);\n\n**Set WiFi Credentials:**\n\n.. code-block:: c\n\n   wifi_credentials_t credentials = {0};\n   strncpy(credentials.ssid, \"MyNetwork\", sizeof(credentials.ssid) - 1);\n   strncpy(credentials.password, \"password\", sizeof(credentials.password) - 1);\n\n   esp_err_t ret = wifi_manager_set_credentials(&credentials);\n\n**Get WiFi Status:**\n\n.. code-block:: c\n\n   wifi_status_t status;\n   wifi_manager_get_status(&status);\n\n   // status.mode, status.connected_ssid, status.rssi, status.has_credentials\n\n**Clear Credentials:**\n\n.. code-block:: c\n\n   esp_err_t ret = wifi_manager_clear_credentials();\n\n**Lifecycle:**\n\n- WiFi Manager starts web server when entering AP mode (captive portal)\n- WiFi Manager stops web server when successfully connecting to WiFi (optional behavior)\n- Web server can run independently in both AP and STA modes", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_INTEGRATION_WIFI_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 796, "links": ["REQ_WEB_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "WiFi Manager Integration", "sections": ["WiFi Manager Integration", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "integration", "wifi"], "template": null, "title": "WiFi Manager Integration Pattern", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_REST_CFG_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Architecture:**\nThe web server provides HTTP transport for configuration operations. All configuration logic is delegated to the config manager component.\n\n**Endpoints:**\n\n1. ``GET /api/config/schema`` - Retrieve JSON schema for UI generation\n2. ``GET /api/config`` - Retrieve all configuration values\n3. ``POST /api/config`` - Update configuration values\n\n---\n\n**Endpoint: GET /api/config/schema**\n\n**Purpose:** Return JSON schema for frontend UI generation\n\n**Request:** None\n\n**Response (200 OK):**\n\n.. code-block:: json\n\n   {\n     \"title\": \"ESP32 Device Configuration\",\n     \"version\": \"1.0.0\",\n     \"fields\": [\n       {\n         \"key\": \"wifi_ssid\",\n         \"type\": \"string\",\n         \"label\": \"WiFi Network Name\",\n         \"default\": \"\",\n         \"required\": false,\n         \"maxLength\": 63,\n         \"group\": \"wifi\"\n       },\n       {\n         \"key\": \"ap_ssid\",\n         \"type\": \"string\",\n         \"label\": \"AP SSID\",\n         \"default\": \"ESP32-Setup\",\n         \"required\": true,\n         \"maxLength\": 32,\n         \"group\": \"ap\"\n       }\n     ]\n   }\n\n**Implementation:**\n\n.. code-block:: c\n\n   static esp_err_t schema_get_handler(httpd_req_t *req)\n   {\n       httpd_resp_set_hdr(req, \"Content-Type\", \"application/json\");\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n\n       char *schema_json = NULL;\n       esp_err_t ret = config_get_schema_json(&schema_json);\n       if (ret != ESP_OK) {\n           httpd_resp_send_err(req, HTTPD_500_INTERNAL_SERVER_ERROR,\n                               \"Failed to load configuration schema\");\n           return ESP_FAIL;\n       }\n\n       httpd_resp_send(req, schema_json, HTTPD_RESP_USE_STRLEN);\n       // Note: schema_json points to embedded flash data, no free() needed\n\n       return ESP_OK;\n   }\n\n---\n\n**Endpoint: GET /api/config**\n\n**Purpose:** Retrieve all current configuration values\n\n**Request:** None\n\n**Response (200 OK):**\n\n.. code-block:: json\n\n   {\n     \"wifi_ssid\": \"MyNetwork\",\n     \"wifi_pass\": \"\",\n     \"ap_ssid\": \"ESP32-Setup\",\n     \"ap_pass\": \"12345678\",\n     \"led_count\": 50,\n     \"led_bright\": 128,\n     \"device_name\": \"MyDevice\"\n   }\n\n**Implementation:**\n\n.. code-block:: c\n\n   static esp_err_t config_get_handler(httpd_req_t *req)\n   {\n       httpd_resp_set_hdr(req, \"Content-Type\", \"application/json\");\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n\n       char *config_json = NULL;\n       esp_err_t ret = config_get_all_as_json(&config_json);\n       if (ret != ESP_OK) {\n           httpd_resp_send_err(req, HTTPD_500_INTERNAL_SERVER_ERROR,\n                               \"Failed to read configuration\");\n           return ESP_FAIL;\n       }\n\n       httpd_resp_send(req, config_json, HTTPD_RESP_USE_STRLEN);\n       free(config_json);\n\n       return ESP_OK;\n   }\n\n---\n\n**Endpoint: POST /api/config**\n\n**Purpose:** Update configuration values\n\n**Request Body:**\n\n.. code-block:: json\n\n   {\n     \"wifi_ssid\": \"NewNetwork\",\n     \"wifi_pass\": \"newpassword123\",\n     \"ap_ssid\": \"MyDevice-AP\",\n     \"led_count\": 144,\n     \"device_name\": \"UpdatedDevice\"\n   }\n\n**Response (200 OK):**\n\n.. code-block:: json\n\n   {\n     \"status\": \"success\",\n     \"message\": \"Configuration saved successfully\"\n   }\n\n**Implementation:**\n\n.. code-block:: c\n\n   static esp_err_t config_set_handler(httpd_req_t *req)\n   {\n       httpd_resp_set_hdr(req, \"Content-Type\", \"application/json\");\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n\n       // Read request body\n       char content[1024];\n       int ret = httpd_req_recv(req, content, sizeof(content) - 1);\n       if (ret <= 0) {\n           httpd_resp_send_err(req, HTTPD_400_BAD_REQUEST, \"Invalid request body\");\n           return ESP_FAIL;\n       }\n       content[ret] = '\\0';\n\n       esp_err_t config_ret = config_set_all_from_json(content);\n       if (config_ret != ESP_OK) {\n           httpd_resp_send_err(req, HTTPD_400_BAD_REQUEST, \"Configuration update failed\");\n           return ESP_FAIL;\n       }\n\n       const char *response = \"{\\\"status\\\":\\\"success\\\",\\\"message\\\":\\\"Configuration saved successfully\\\"}\";\n       httpd_resp_send(req, response, HTTPD_RESP_USE_STRLEN);\n\n       return ESP_OK;\n   }\n\n---\n\n**Endpoint: POST /api/config/reset**\n\n**Purpose:** Reset all configuration to factory defaults\n\n**Request:** None\n\n**Response (200 OK):**\n\n.. code-block:: json\n\n   {\n     \"status\": \"success\",\n     \"message\": \"Configuration reset to factory defaults\"\n   }\n\n**Implementation:**\n\n.. code-block:: c\n\n   static esp_err_t config_reset_handler(httpd_req_t *req)\n   {\n       httpd_resp_set_hdr(req, \"Content-Type\", \"application/json\");\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n\n       esp_err_t ret = config_factory_reset();\n       if (ret != ESP_OK) {\n           httpd_resp_send_err(req, HTTPD_500_INTERNAL_SERVER_ERROR,\n                               \"Factory reset failed\");\n           return ESP_FAIL;\n       }\n\n       const char *response = \"{\\\"status\\\":\\\"success\\\",\\\"message\\\":\\\"Configuration reset to factory defaults\\\"}\";\n       httpd_resp_send(req, response, HTTPD_RESP_USE_STRLEN);\n       return ESP_OK;\n   }", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_REST_CFG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 279, "links": ["REQ_WEB_CONF_1", "REQ_WEB_SCHEMA_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Configuration API Design", "sections": ["Configuration API Design", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "api", "config", "schema"], "template": null, "title": "Configuration API Endpoints", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_REST_HEALTH_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Endpoint: GET /api/system/health**\n\n**Purpose:** System diagnostics and health monitoring\n\n**Response:**\n\n.. code-block:: json\n\n   {\n     \"uptime_seconds\": 3542.5,\n     \"free_heap_bytes\": 125432,\n     \"minimum_free_heap_bytes\": 98234,\n     \"heap_fragmentation_percent\": 21.7,\n     \"configuration\": {\n       \"status\": \"healthy\",\n       \"api_version\": \"2.0\"\n     },\n     \"wifi\": {\n       \"status\": \"connected\",\n       \"ssid\": \"MyNetwork\",\n       \"rssi\": -48\n     },\n     \"overall_status\": \"healthy\",\n     \"device_type\": \"ESP32 Template\",\n     \"firmware_version\": \"1.0.0\"\n   }\n\n**Health Assessment Logic:**\n\n.. code-block:: c\n\n   bool system_healthy = (wifi_status == ESP_OK) &&\n                        (free_heap > 50000); // At least 50KB free\n\n**Use Cases:**\n\n- Dashboard real-time monitoring\n- Remote diagnostics\n- Automated health checks", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_REST_HEALTH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 588, "links": ["REQ_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Configuration API Design", "sections": ["Configuration API Design", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "api", "diagnostics"], "template": null, "title": "System Health API Endpoint", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_REST_LED_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Endpoint: GET /api/led/state**\n\n**Purpose:** Retrieve current LED strip state for real-time web visualization\n\n**Response:**\n\n.. code-block:: json\n\n   {\n     \"led_count\": 40,\n     \"colors\": \"FF0000 00FF00 0000FF 000000 FFFFFF ...\"\n   }\n\n**Response Format:**\n\n- ``led_count``: Number of LEDs in the strip (matches configuration)\n- ``colors``: Space-separated hex RGB colors (e.g., \"FF0000\" = red, \"000000\" = off)\n- Each color: 6 hex digits (RRGGBB format)\n- Total response size: ~280 bytes for 40 LEDs + JSON overhead\n\n**Implementation Details:**\n\n.. code-block:: c\n\n   // Handler function\n   static esp_err_t led_state_handler(httpd_req_t *req)\n   {\n       // 1. Set CORS headers for cross-origin access\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n       httpd_resp_set_hdr(req, \"Content-Type\", \"application/json\");\n\n       // 2. Get LED count from controller\n       uint16_t led_count = led_get_count();\n\n       // 3. Allocate snapshot buffer\n       led_color_t *snapshot = malloc(led_count * sizeof(led_color_t));\n\n       // 4. Get thread-safe snapshot using REQ_LED_5 API\n       uint16_t actual = led_get_all_colors(snapshot, led_count);\n\n       // 5. Convert RGB to hex string: \"RRGGBB RRGGBB ...\"\n       //    Format: sprintf(pos, \"%02X%02X%02X\", r, g, b)\n\n       // 6. Build JSON response\n       // 7. Send response\n       // 8. Free buffers\n   }\n\n**Error Handling:**\n\n- LED controller not initialized \u2192 500 Internal Server Error\n- Memory allocation failure \u2192 500 Internal Server Error\n- Snapshot read failure \u2192 500 Internal Server Error\n- All errors log to console for debugging\n\n**Performance:**\n\n- Typical response time: <100ms for 40 LEDs\n- Memory usage: ~600 bytes (LED snapshot + hex string buffers)\n- Thread-safe: Uses mutex-protected ``led_get_all_colors()``\n- No blocking of LED updates: Snapshot operation is fast\n\n**Use Cases:**\n\n- Real-time LED strip visualization in web UI\n- Remote monitoring of LED states\n- JavaScript canvas/CSS LED animation sync\n- Debugging LED display issues\n\n**CORS Support:**\n\n- Access-Control-Allow-Origin: * (allows cross-origin requests)\n- Enables local development and external web apps", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_REST_LED_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 635, "links": ["REQ_WEB_LED_1", "SPEC_LED_API_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Configuration API Design", "sections": ["Configuration API Design", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "api", "led", "visualization"], "template": null, "title": "LED State API Endpoint", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_REST_WIFI_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Endpoint: GET /scan**\n\n**Purpose:** Scan for available WiFi networks\n\n**Response:**\n\n.. code-block:: json\n\n   {\n     \"networks\": [\n       {\n         \"ssid\": \"NetworkName\",\n         \"rssi\": -45,\n         \"authmode\": 3\n       }\n     ]\n   }\n\n**Implementation Notes:**\n\n- Automatically switches to APSTA mode if in AP mode (scanning requires STA)\n- Returns sorted list by signal strength (RSSI)\n- ``authmode``: 0=Open, 2=WPA-PSK, 3=WPA2-PSK, 4=WPA/WPA2-PSK\n\n---\n\n**Endpoint: POST /connect**\n\n**Purpose:** Connect to WiFi network with provided credentials\n\n**Request:**\n\n.. code-block:: json\n\n   {\n     \"ssid\": \"NetworkName\",\n     \"password\": \"secretpassword\"\n   }\n\n**Response (200 OK):**\n\n.. code-block:: json\n\n   {\n     \"success\": true\n   }\n\n**Integration:** Calls ``wifi_manager_set_credentials()`` to save credentials to NVS and initiate connection.\n\n---\n\n**Endpoint: GET /status**\n\n**Purpose:** Get current WiFi connection status\n\n**Response:**\n\n.. code-block:: json\n\n   {\n     \"mode\": 1,\n     \"ssid\": \"ConnectedNetwork\",\n     \"rssi\": -52,\n     \"has_credentials\": true,\n     \"ip\": \"192.168.1.100\"\n   }\n\n**Integration:** Calls ``wifi_manager_get_status()`` and ``wifi_manager_get_ip_address()``.\n\n---\n\n**Endpoint: POST /reset**\n\n**Purpose:** Clear WiFi credentials and restart device in AP mode\n\n**Response:**\n\n.. code-block:: json\n\n   {\n     \"success\": true,\n     \"message\": \"Device will restart in AP mode in 3 seconds\"\n   }\n\n**Implementation:** Calls ``wifi_manager_clear_credentials()`` and schedules device restart.", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_REST_WIFI_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 495, "links": ["REQ_WEB_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Configuration API Design", "sections": ["Configuration API Design", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "api", "wifi"], "template": null, "title": "WiFi Management REST API Endpoints", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_ROUTES_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Handler Registration:**\n\nAll URI handlers are registered in ``web_server_init()`` using ``httpd_register_uri_handler()``.\n\n**Main Pages:**\n\n=========================  ============  ================================  ===============\nURI                        HTTP Method   Handler Function                  Purpose\n=========================  ============  ================================  ===============\n``/``                      GET           ``root_handler()``                Dashboard (redirects to /index.html)\n``/index.html``            GET           ``static_file_handler()``         Main dashboard page\n``/wifi-setup.html``       GET           ``static_file_handler()``         WiFi configuration page\n``/settings.html``         GET           ``static_file_handler()``         Device settings page\n``/config``                GET           ``config_handler()``              **Captive portal redirect** (\u2192 /wifi-setup.html)\n=========================  ============  ================================  ===============\n\n**Static Assets:**\n\n=========================  ============  ================================  ===============\nURI                        HTTP Method   Handler Function                  Content Type\n=========================  ============  ================================  ===============\n``/css/style.css``         GET           ``static_file_handler()``         text/css\n``/js/app.js``             GET           ``static_file_handler()``         application/javascript\n``/favicon.svg``           GET           ``static_file_handler()``         image/svg+xml\n``/favicon.ico``           GET           ``static_file_handler()``         image/svg+xml (alias)\n=========================  ============  ================================  ===============\n\n**WiFi Management API:**\n\n=========================  ============  ================================  ===============\nURI                        HTTP Method   Handler Function                  Purpose\n=========================  ============  ================================  ===============\n``/scan``                  GET           ``scan_handler()``                WiFi network scan\n``/connect``               POST          ``connect_handler()``             Connect to WiFi network\n``/reset``                 POST          ``reset_handler()``               Clear WiFi credentials, restart\n``/api/status``            GET           ``wifi_status_handler()``         **WiFi status** (SSID, RSSI, mode)\n=========================  ============  ================================  ===============\n\n**Configuration Management API:**\n\n=========================  ============  ================================  ===============\nURI                        HTTP Method   Handler Function                  Purpose\n=========================  ============  ================================  ===============\n``/api/config/schema``     GET           ``schema_get_handler()``          Get JSON schema for UI generation\n``/api/config``            GET           ``config_get_handler()``          Get all configuration values (bulk)\n``/api/config``            POST          ``config_set_handler()``          Update configuration values (bulk)\n``/api/config/reset``      POST          ``config_reset_handler()``        Factory reset configuration\n=========================  ============  ================================  ===============\n\n**System Diagnostics API:**\n\n=========================  ============  ================================  ===============\nURI                        HTTP Method   Handler Function                  Purpose\n=========================  ============  ================================  ===============\n``/api/system/health``     GET           ``system_health_handler()``       **System diagnostics** (uptime, memory, health)\n=========================  ============  ================================  ===============\n\n**CORS Support:**\n\n=========================  ============  ================================  ===============\nURI                        HTTP Method   Handler Function                  Purpose\n=========================  ============  ================================  ===============\n``/api/*``                 OPTIONS       ``cors_preflight_handler()``      CORS preflight\n=========================  ============  ================================  ===============\n\n**Handler Registration Pattern:**\n\n.. code-block:: c\n\n   httpd_uri_t scan_uri = {\n       .uri = \"/scan\",\n       .method = HTTP_GET,\n       .handler = scan_handler,\n       .user_ctx = NULL\n   };\n   esp_err_t ret = httpd_register_uri_handler(server, &scan_uri);\n   ESP_LOGI(TAG, \"Registered handler for '/scan' - %s\",\n            ret == ESP_OK ? \"OK\" : esp_err_to_name(ret));\n\n**Configuration:**\n\n- ``max_uri_handlers``: 32 (increased from default 8)\n- ``lru_purge_enable``: true (automatically remove least recently used handlers if limit reached)", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_ROUTES_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 185, "links": ["REQ_WEB_4", "REQ_WEB_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "URI Routing and Handlers", "sections": ["URI Routing and Handlers", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "routing"], "template": null, "title": "URI Routing Table", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_SECURITY_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Current CORS Policy:**\n\nAll API endpoints return:\n\n.. code-block:: c\n\n   httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n\n**Rationale:** Template simplicity - allows development from any origin (GitHub Pages, local files, etc.)\n\n**Production Recommendation:**\n\nFor production deployments, restrict CORS to specific origins:\n\n.. code-block:: c\n\n   // Option 1: Lock to device IP only (no external access)\n   httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"null\");\n\n   // Option 2: Allow specific external domain (hybrid GitHub Pages approach)\n   httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\",\n                     \"https://yourusername.github.io\");\n\n**CORS Preflight Handler:**\n\n.. code-block:: c\n\n   static esp_err_t cors_preflight_handler(httpd_req_t *req)\n   {\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Methods\", \"GET, POST, OPTIONS\");\n       httpd_resp_set_hdr(req, \"Access-Control-Allow-Headers\", \"Content-Type, Authorization\");\n       httpd_resp_set_hdr(req, \"Access-Control-Max-Age\", \"86400\"); // 24 hours\n       httpd_resp_send(req, \"\", 0);\n       return ESP_OK;\n   }\n\nRegistered for:\n\n.. code-block:: c\n\n   httpd_uri_t options_uri = {\n       .uri = \"/api/*\",    // Wildcard for all API endpoints\n       .method = HTTP_OPTIONS,\n       .handler = cors_preflight_handler,\n       .user_ctx = NULL\n   };\n\n**Password Exposure Protection:**\n\nConfiguration GET endpoints never return password fields:\n\n.. code-block:: c\n\n   cJSON_AddStringToObject(wifi, \"password\", \"\");  // Always empty string\n\nPasswords are only accepted in POST requests, never echoed back.", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_SECURITY_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 1104, "links": ["REQ_WEB_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "CORS and Security", "sections": ["CORS and Security", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "security", "cors"], "template": null, "title": "CORS Configuration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_STATIC_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Problem:**\nESP32 has no filesystem by default. HTML/CSS/JS files must be embedded in firmware flash.\n\n**Solution:**\nUse ESP-IDF's ``EMBED_FILES`` CMake directive to convert static files into binary symbols at build time.\n\n**CMakeLists.txt Configuration:**\n\n.. code-block:: cmake\n\n   idf_component_register(\n       SRCS \"web_server.c\" \"wifi_manager.c\"\n       INCLUDE_DIRS \".\"\n       EMBED_FILES\n           \"www/index.html\"\n           \"www/wifi-setup.html\"\n           \"www/settings.html\"\n           \"www/favicon.svg\"\n           \"www/css/style.css\"\n           \"www/js/app.js\"\n       REQUIRES\n           config_manager\n           esp_wifi\n           esp_http_server\n           json\n   )\n\n**Generated Binary Symbols:**\n\nFor each file ``path/to/file.ext``, CMake generates:\n\n- ``_binary_file_ext_start``: Pointer to start of file data\n- ``_binary_file_ext_end``: Pointer to end of file data\n\n**C Code Access:**\n\n.. code-block:: c\n\n   extern const uint8_t index_html_start[] asm(\"_binary_index_html_start\");\n   extern const uint8_t index_html_end[] asm(\"_binary_index_html_end\");\n\n   size_t size = index_html_end - index_html_start;\n   httpd_resp_send(req, (const char*)index_html_start, size);\n\n**File Lookup Function:**\n\nThe ``get_embedded_file()`` function maps URI paths to embedded file symbols:\n\n.. code-block:: c\n\n   static esp_err_t get_embedded_file(const char *filename,\n                                      const uint8_t **data,\n                                      size_t *size)\n   {\n       // Strip query parameters (?v=2 for cache busting)\n       char clean_filename[128];\n       strncpy(clean_filename, filename, sizeof(clean_filename) - 1);\n       char *query = strchr(clean_filename, '?');\n       if (query != NULL) *query = '\\0';\n\n       if (strcmp(clean_filename, \"/index.html\") == 0) {\n           *data = index_html_start;\n           *size = index_html_end - index_html_start;\n       }\n       // ... more file mappings ...\n       else {\n           return ESP_ERR_NOT_FOUND;\n       }\n       return ESP_OK;\n   }\n\n**MIME Type Detection:**\n\n.. code-block:: c\n\n   static const char *get_mime_type(const char *filename)\n   {\n       const char *ext = strrchr(filename, '.');\n       if (strcmp(ext, \".html\") == 0) return \"text/html\";\n       if (strcmp(ext, \".css\") == 0) return \"text/css\";\n       if (strcmp(ext, \".js\") == 0) return \"application/javascript\";\n       if (strcmp(ext, \".svg\") == 0) return \"image/svg+xml\";\n       if (strcmp(ext, \".json\") == 0) return \"application/json\";\n       return \"text/plain\";\n   }\n\n**Cache Control:**\n\nFor template/development, caching is disabled:\n\n.. code-block:: c\n\n   httpd_resp_set_hdr(req, \"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n   httpd_resp_set_hdr(req, \"Pragma\", \"no-cache\");\n   httpd_resp_set_hdr(req, \"Expires\", \"0\");", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_STATIC_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 79, "links": ["REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_3", "REQ_WEB_NF_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Static File Embedding", "sections": ["Static File Embedding", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "build", "embedding"], "template": null, "title": "Static File Embedding Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_WEB_TEST_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Manual Testing:**\n\n1. **QEMU Testing (No Hardware):**\n\n   - Build and run in QEMU emulator\n   - HTTP proxy required for browser access: ``python tools/http_proxy.py``\n   - Access via ``http://localhost:8000``\n\n2. **Hardware Testing:**\n\n   - Flash to ESP32 device\n   - Connect to ``ESP32-AP`` WiFi network\n   - Navigate to ``http://192.168.4.1``\n\n**Browser Developer Tools:**\n\n- **Network Tab:** Monitor HTTP requests/responses, status codes\n- **Console Tab:** Check for JavaScript errors\n- **Application Tab:** Inspect localStorage/sessionStorage\n\n**ESP32 Serial Monitor:**\n\n.. code-block:: text\n\n   I (1234) web_server: Initializing web server on port 80\n   I (1235) web_server: Registered handler for '/' - OK\n   I (1236) web_server: Registered handler for '/scan' - OK\n   I (1237) web_server: Web server initialized successfully\n   I (5678) web_server: Serving static file: /index.html\n   I (5679) web_server: Found index.html, size: 4823\n\n**Common Issues:**\n\n1. **404 Not Found:** Check ``get_embedded_file()`` has correct path mapping\n2. **Empty Response:** Verify EMBED_FILES in CMakeLists.txt\n3. **CORS Errors:** Ensure ``Access-Control-Allow-Origin`` header set\n4. **Memory Errors:** Reduce ``max_open_sockets`` or check heap usage", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_TEST_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 1172, "links": ["REQ_WEB_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Testing and Debugging", "sections": ["Testing and Debugging", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "testing"], "template": null, "title": "Web Server Testing Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}}, "needs_amount": 235, "needs_schema": {"$schema": "http://json-schema.org/draft-07/schema#", "properties": {"acceptance_criteria": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "api_signature": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "arch": {"additionalProperties": {"type": "string"}, "default": {}, "description": "Mapping of uml key to uml content.", "field_type": "core", "type": "object"}, "avatar": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "closed_at": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "completion": {"default": null, "description": "Added for needgantt functionality", "field_type": "extra", "type": "integer"}, "component": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "constraints": {"default": [], "description": "List of constraint names, which are defined for this need.", "field_type": "core", "items": {"type": "string"}, "type": "array"}, "constraints_error": {"default": null, "description": "An error message set if any constraint failed, and `error_message` field is set in config.", "field_type": "core", "type": ["string", "null"]}, "constraints_passed": {"default": true, "description": "True if all constraints passed, False if any failed, None if not yet checked.", "field_type": "core", "type": ["boolean", "null"]}, "constraints_results": {"additionalProperties": {"type": "object"}, "default": {}, "description": "Mapping of constraint name, to check name, to result, None if not yet checked.", "field_type": "core", "type": ["object", "null"]}, "content": {"default": "", "description": "The main content of the need.", "field_type": "core", "type": "string"}, "created_at": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "docname": {"default": null, "description": "Name of the document where the need is defined (None if external).", "field_type": "core", "type": ["string", "null"]}, "doctype": {"default": ".rst", "description": "The markup type of the content, denoted by the suffix of the source file, e.g. '.rst'.", "field_type": "core", "type": "string"}, "duration": {"default": null, "description": "Added for needgantt functionality", "field_type": "extra", "type": "integer"}, "external_css": {"default": "", "description": "CSS class name, added to the external reference.", "field_type": "core", "type": "string"}, "external_url": {"default": null, "description": "URL of the need, if it is an external need.", "field_type": "core", "type": ["string", "null"]}, "has_dead_links": {"default": false, "description": "True if any links reference need ids that are not found in the need list.", "field_type": "core", "type": "boolean"}, "has_forbidden_dead_links": {"default": false, "description": "True if any links reference need ids that are not found in the need list, and the link type does not allow dead links.", "field_type": "core", "type": "boolean"}, "header_file": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "id": {"description": "ID of the data.", "field_type": "core", "type": "string"}, "id_prefix": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "is_external": {"default": false, "description": "If true, no node is created and need is referencing external url.", "field_type": "core", "type": "boolean"}, "is_import": {"default": false, "description": "If true, the need was derived from an import.", "field_type": "core", "type": "boolean"}, "is_modified": {"default": false, "description": "Whether the need was modified by needextend.", "field_type": "core", "type": "boolean"}, "jinja_content": {"default": false, "description": "Whether the content was pre-processed by jinja.", "field_type": "core", "type": "boolean"}, "layout": {"default": null, "description": "Key of the layout, which is used to render the need.", "field_type": "core", "type": ["string", "null"]}, "lineno": {"default": null, "description": "Line number where the need is defined (None if external).", "field_type": "core", "type": ["integer", "null"]}, "links": {"default": [], "description": "Link field", "field_type": "links", "items": {"type": "string"}, "type": "array"}, "links_back": {"default": [], "description": "Backlink field", "field_type": "backlinks", "items": {"type": "string"}, "type": "array"}, "max_amount": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "max_content_lines": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "modifications": {"default": 0, "description": "Number of modifications by needextend.", "field_type": "core", "type": "integer"}, "parameters": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "params": {"default": "", "description": "Added by service open-needs", "field_type": "extra", "type": "string"}, "parent_need": {"default": null, "description": "Simply the first parent id.", "field_type": "core", "type": ["string", "null"]}, "parent_needs": {"default": [], "description": "Link field", "field_type": "links", "items": {"type": "string"}, "type": "array"}, "parent_needs_back": {"default": [], "description": "Backlink field", "field_type": "backlinks", "items": {"type": "string"}, "type": "array"}, "parts": {"additionalProperties": {"type": "object"}, "default": {}, "description": "Mapping of parts, a.k.a. sub-needs, IDs to data that overrides the need's data", "field_type": "core", "type": "object"}, "post_content": {"default": null, "description": "Additional content after the need.", "field_type": "core", "type": ["string", "null"]}, "post_template": {"default": null, "description": "The template key, if the post_content was created from a jinja template.", "field_type": "core", "type": ["string", "null"]}, "pre_content": {"default": null, "description": "Additional content before the need.", "field_type": "core", "type": ["string", "null"]}, "pre_template": {"default": null, "description": "The template key, if the pre_content was created from a jinja template.", "field_type": "core", "type": ["string", "null"]}, "prefix": {"default": "", "description": "Added by service open-needs", "field_type": "extra", "type": "string"}, "priority": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "query": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "rationale": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "returns": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "section_name": {"default": null, "description": "Simply the first section.", "field_type": "core", "type": ["string", "null"]}, "sections": {"default": [], "description": "Sections of the need.", "field_type": "core", "items": {"type": "string"}, "type": "array"}, "service": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "signature": {"default": null, "description": "Derived from a docutils desc_name node.", "field_type": "core", "type": ["string", "null"]}, "specific": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "status": {"default": null, "description": "Status of the need.", "field_type": "core", "type": ["string", "null"]}, "style": {"default": null, "description": "Comma-separated list of CSS classes (all appended by `needs_style_`).", "field_type": "core", "type": ["string", "null"]}, "tags": {"default": [], "description": "List of tags.", "field_type": "core", "items": {"type": "string"}, "type": "array"}, "template": {"default": null, "description": "The template key, if the content was created from a jinja template.", "field_type": "core", "type": ["string", "null"]}, "title": {"description": "Title of the need.", "field_type": "core", "type": "string"}, "type": {"default": "", "description": "Type of the need.", "field_type": "core", "type": "string"}, "type_name": {"default": "", "description": "Name of the type.", "field_type": "core", "type": "string"}, "updated_at": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "url": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "url_postfix": {"default": "", "description": "Added by service open-needs", "field_type": "extra", "type": "string"}, "user": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}}, "type": "object"}}}}