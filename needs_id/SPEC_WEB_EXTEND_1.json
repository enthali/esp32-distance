{"created": "2025-11-12T11:00:58.943211", "current_version": "", "project": "ESP32 Distance Sensor", "versions": {"": {"created": "2025-11-12T11:00:58.943191", "creator": {"program": "sphinx_needs", "version": "6.1.0"}, "needs": {"SPEC_WEB_EXTEND_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Adding a New Static HTML Page:**\n\n1. **Create HTML File:**\n\n   Create ``main/components/web_server/www/my-page.html``\n\n2. **Update CMakeLists.txt:**\n\n   .. code-block:: cmake\n\n      EMBED_FILES\n          \"www/index.html\"\n          \"www/wifi-setup.html\"\n          \"www/settings.html\"\n          \"www/my-page.html\"   # ADD THIS LINE\n\n3. **Add Binary Symbol Declarations:**\n\n   In ``web_server.c``:\n\n   .. code-block:: c\n\n      extern const uint8_t my_page_html_start[] asm(\"_binary_my_page_html_start\");\n      extern const uint8_t my_page_html_end[] asm(\"_binary_my_page_html_end\");\n\n4. **Update ``get_embedded_file()``:**\n\n   .. code-block:: c\n\n      else if (strcmp(clean_filename, \"/my-page.html\") == 0)\n      {\n          *data = my_page_html_start;\n          *size = my_page_html_end - my_page_html_start;\n      }\n\n5. **Register URI Handler:**\n\n   .. code-block:: c\n\n      httpd_uri_t my_page_uri = {\n          .uri = \"/my-page.html\",\n          .method = HTTP_GET,\n          .handler = static_file_handler,\n          .user_ctx = NULL\n      };\n      httpd_register_uri_handler(server, &my_page_uri);\n\n6. **Add Navigation Link:**\n\n   Update navbar in all HTML files:\n\n   .. code-block:: html\n\n      <a href=\"/my-page.html\" class=\"nav-btn\">My Page</a>\n\n**Adding a New REST API Endpoint:**\n\n1. **Implement Handler Function:**\n\n   .. code-block:: c\n\n      static esp_err_t my_api_handler(httpd_req_t *req)\n      {\n          httpd_resp_set_type(req, \"application/json\");\n          httpd_resp_set_hdr(req, \"Access-Control-Allow-Origin\", \"*\");\n\n          // Your API logic here\n\n          const char *response = \"{\\\"status\\\":\\\"success\\\"}\";\n          return httpd_resp_send(req, response, HTTPD_RESP_USE_STRLEN);\n      }\n\n2. **Register URI Handler:**\n\n   .. code-block:: c\n\n      httpd_uri_t my_api_uri = {\n          .uri = \"/api/my-endpoint\",\n          .method = HTTP_GET,  // or HTTP_POST\n          .handler = my_api_handler,\n          .user_ctx = NULL\n      };\n      httpd_register_uri_handler(server, &my_api_uri);\n\n3. **Update JavaScript:**\n\n   Add API call in ``www/js/app.js``:\n\n   .. code-block:: javascript\n\n      async function fetchMyData() {\n          const response = await fetch('/api/my-endpoint');\n          const data = await response.json();\n          // Handle data\n      }", "created_at": "", "docname": "12_design/spec_web_server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_WEB_EXTEND_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 998, "links": ["REQ_WEB_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Adding New Pages and Endpoints", "sections": ["Adding New Pages and Endpoints", "Web Server Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "extensibility", "guide"], "template": null, "title": "Extension Guide for Web Pages", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}}, "needs_amount": 1}}}