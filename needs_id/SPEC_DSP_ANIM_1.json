{"created": "2025-11-12T08:43:41.276168", "current_version": "", "project": "ESP32 Distance Sensor", "versions": {"": {"created": "2025-11-12T08:43:41.276152", "creator": {"program": "sphinx_needs", "version": "6.1.0"}, "needs": {"SPEC_DSP_ANIM_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Design:** Running LED animation for directional guidance.\n\n**Animation State Machine:**\n\n.. code-block:: c\n\n   typedef struct {\n       uint8_t current_position;    // Current animation LED position\n       bool animation_active;       // Is animation running?\n       bool animation_direction;    // true = forward, false = backward\n       uint8_t animation_start;     // Start position\n       uint8_t animation_end;       // End position\n   } animation_state_t;\n\n**Animation Behaviors:**\n\n- **Too Far Zone** (position > ideal_end):\n  - Start: ``led_count - 1`` (far end), End: ``ideal_end``\n  - Direction: Backward (toward ideal zone)\n  - Color: White at 2% brightness (~5, ~5, ~5)\n  - Loop: When reaching ideal_end, restart from led_count-1\n\n- **Too Close Zone** (position < ideal_start):\n  - Start: 0 (near end), End: ``ideal_start``\n  - Direction: Forward (toward ideal zone)\n  - Color: Red at 100% brightness (255, 0, 0)\n  - Loop: When reaching ideal_start, restart from 0\n\n- **Animation Update** (100ms timer):\n  - Increment/decrement position based on direction\n  - Wrap around when reaching end position\n  - Independent of distance measurement updates\n\n**Validation:** Animation smooth, loops correctly, stops when zone changes, color brightness\ncorrect.", "created_at": "", "docname": "12_design/spec_display", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_DSP_ANIM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 170, "links": ["REQ_DSP_7", "REQ_DSP_8", "REQ_DSP_10"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Animation Specifications", "sections": ["Animation Specifications", "Display System Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["display", "animation", "guidance"], "template": null, "title": "Directional Animation Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}}, "needs_amount": 1}}}