{"created": "2025-11-12T08:52:39.088286", "current_version": "", "project": "ESP32 Distance Sensor", "versions": {"": {"created": "2025-11-12T08:52:39.088269", "creator": {"program": "sphinx_needs", "version": "6.1.0"}, "needs": {"SPEC_CFG_JSON_SCHEMA_1": {"acceptance_criteria": "", "api_signature": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "component": "", "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** JSON schema defines all configuration fields with metadata for type-safety and UI generation.\n\n**Schema File Location:** `main/components/config_manager/config_schema.json`\n\n**Schema Structure:**\n\n.. code-block:: json\n\n   {\n     \"schema_version\": \"1.0\",\n     \"config_namespace\": \"esp32_app\",\n     \"groups\": [\n       {\n         \"id\": \"wifi\",\n         \"label\": \"\ud83d\udcf6 WiFi Settings\",\n         \"description\": \"Network configuration\",\n         \"order\": 1\n       }\n     ],\n     \"fields\": [\n       {\n         \"key\": \"wifi_ssid\",\n         \"type\": \"string\",\n         \"label\": \"WiFi SSID\",\n         \"default\": \"\",\n         \"required\": true,\n         \"maxLength\": 32,\n         \"pattern\": \"^[^\\\\x00]{1,32}$\",\n         \"group\": \"wifi\",\n         \"order\": 1\n       }\n     ]\n   }\n\n**Schema Elements:**\n\n- **schema_version**: Version for future compatibility\n- **config_namespace**: NVS namespace name\n- **groups**: UI section grouping (order matters)\n- **fields**: Individual configuration parameters\n\n**Field Properties:**\n\n============================== ======== =========================================================================\nProperty                       Type     Purpose\n============================== ======== =========================================================================\n`key`                          string   NVS key name (\u226415 chars), used directly: config_get(\"key\")\n`type`                         enum     One of: \"string\", \"password\", \"integer\", \"boolean\", \"hidden\"\n`label`                        string   Human-readable label for UI\n`default`                      mixed    Default value if NVS not initialized\n`required`                     bool     If true, must have a value\n`group`                        string   Associates field with a group (from groups.id)\n`order`                        int      Display order (within group, lower = first)\n`minLength` / `maxLength`      int      (string/password) Length constraints\n`min` / `max`                  int      (integer) Range constraints\n`step`                         int      (integer) UI increment step\n`pattern`                      regex    (string/password) Validation regex (browser-only)\n============================== ======== =========================================================================\n\n**Type Mapping to C API:**\n\n.. code-block:: c\n\n   // Browser forms generated based on type\n   \"string\"   \u2192 <input type=\"text\">\n   \"password\" \u2192 <input type=\"password\">\n   \"integer\"  \u2192 <input type=\"number\">\n   \"boolean\"  \u2192 <input type=\"checkbox\">\n   \"hidden\"   \u2192 <input type=\"hidden\">\n\n   // C code uses matching getters\n   \"string\" / \"password\"  \u2192 config_get_string(key, buf, len)\n   \"integer\"             \u2192 config_get_int32(key, &value) or config_get_int16(key, &value)\n   \"boolean\"             \u2192 config_get_bool(key, &value)\n   \"hidden\"              \u2192 config_get_string(key, buf, len)  (internal config)\n\n**Design Rationale:**\n\n- **Direct Key Usage**: Using key directly as NVS key eliminates separate UUIDs (saves flash)\n- **Flat Attributes**: No nested validation objects (simpler JSON, smaller file)\n- **Type Defines Input**: Single type field eliminates redundant inputType property\n- **Groups for Organization**: Sections on settings page without separate metadata structure\n- **Order Field**: Ensures predictable UI layout (JSON object order not guaranteed)", "created_at": "", "docname": "12_design/spec_config_manager_json", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "header_file": "", "id": "SPEC_CFG_JSON_SCHEMA_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 98, "links": ["REQ_CFG_JSON_1", "REQ_CFG_JSON_2", "REQ_CFG_JSON_3"], "links_back": ["SPEC_CFG_WEB_FORM_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "parameters": "", "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "returns": "", "section_name": "Data Structure Design", "sections": ["Data Structure Design", "JSON-Based Configuration Manager Design"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["data-structure", "schema"], "template": null, "title": "Configuration Schema Structure", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}}, "needs_amount": 1}}}